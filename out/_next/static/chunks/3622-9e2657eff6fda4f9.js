(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3622],{7519:(e,t,a)=>{Promise.resolve().then(a.bind(a,71578)),Promise.resolve().then(a.bind(a,53031)),Promise.resolve().then(a.bind(a,70472))},31847:(e,t,a)=>{"use strict";a.d(t,{I4:()=>C,JT:()=>w,KI:()=>k,Li:()=>A,ND:()=>f,Nz:()=>p,Oe:()=>j,Pu:()=>d,T7:()=>m,Xk:()=>r,c5:()=>y,dk:()=>g,eD:()=>v,eX:()=>S,en:()=>o,h0:()=>l,ie:()=>x,mA:()=>c,nz:()=>n,o4:()=>Y,oU:()=>h,rl:()=>s,z4:()=>b,zR:()=>i,zf:()=>u});let l=[{value:"single",label:"Single Floor"},{value:"multiple",label:"Multiple Floor"}],i=[{value:"residential",label:"Residential"},{value:"commercial",label:"Commercial"},{value:"mixed",label:"Mixed Use"}],r=[{value:"available",label:"Available"},{value:"sold",label:"Sold"},{value:"reserved",label:"Reserved"},{value:"blocked",label:"Blocked"}],s=[{value:"north",label:"North"},{value:"south",label:"South"},{value:"east",label:"East"},{value:"west",label:"West"},{value:"northeast",label:"North East"},{value:"northwest",label:"North West"},{value:"southeast",label:"South East"},{value:"southwest",label:"South West"}],n=[{value:"garden",label:"Garden View"},{value:"city",label:"City View"},{value:"sea",label:"Sea View"},{value:"mountain",label:"Mountain View"},{value:"pool",label:"Pool View"},{value:"road",label:"Road View"}],o=[{label:"1 BHK",value:"1 BHK"},{label:"2 BHK",value:"2 BHK"},{label:"3 BHK",value:"3 BHK"},{label:"4 BHK",value:"4 BHK"},{label:"Studio Apartment",value:"Studio Apartment"},{label:"Penthouse",value:"Penthouse"},{label:"Duplex",value:"Duplex"},{label:"Triplex",value:"Triplex"},{label:"Office Space",value:"Office Space"},{label:"Retail Shop",value:"Retail Shop"},{label:"Coworking Space",value:"Coworking Space"},{label:"Showroom",value:"Showroom"},{label:"Row House",value:"Row House"},{label:"Bungalow",value:"Bungalow"},{label:"Farmhouse",value:"Farmhouse"},{label:"Factory Unit",value:"Factory Unit"},{label:"Warehouse/Storage",value:"Warehouse/Storage"},{label:"None/Unknown",value:null}],d=["North","South","East","West","Northeast","Northwest","Southeast","Southwest"],c=[{label:"Available",value:"Available"},{label:"Booked",value:"Booked"},{label:"Purchased",value:"Purchased"},{label:"Sold",value:"Sold"},{label:"None/Unknown",value:null}],u=["Garden View","City View","Sea View","Lake View","Mountain View","Pool View","Street View","Main Road View","Open Land View","Forest View","Industrial Area View","Highway View"],h={available:"success",booked:"warning",purchased:"info",sold:"error"},m=[{label:"New",value:"New"},{label:"Completed",value:"Completed"}],x=[{label:"Today",value:"today"},{label:"This week",value:"this_week"},{label:"Overdue",value:"overdue"}],f={New:{color:"secondary",label:"New"},Completed:{color:"success",label:"Completed"}},p=[{value:"Call",label:"Call"},{value:"Text/SMS",label:"Text/SMS"},{value:"Email",label:"Email"},{value:"Meeting",label:"Meeting"},{value:"Other",label:"Other"}],g=[{value:"Pending",label:"Pending"},{value:"Completed",label:"Completed"},{value:"Cancelled",label:"Cancelled"},{value:"Rescheduled",label:"Rescheduled"},{value:"No Response",label:"No Response"}],b=[{group:"",classify:["New","Win","Lost","Visit","Stale","Qualify"]}],v=[{label:"New",value:"New"},{label:"Win",value:"Win"},{label:"Lost",value:"Lost"},{label:"Visit",value:"Visit"},{label:"Stale",value:"Stale"},{label:"Qualify",value:"Qualify"}],j=[{group:"Social Media(Specific)",classify:["Facebook","Instagram","Twitter/X","YouTube","WhatsApp","Reddit"]},{group:"Offline",classify:["Broker","Walk-in","Event/Expo","Networking","Print Advertisement"]},{group:"Online",classify:["Housing.com","Website","Email Campaign","Online Ads","Webinar","Social Media"]},{group:"Referral & Partner",classify:["Referral","Partner","Existing Customer","Employee Referral"]},{group:"Direct Outreach",classify:["Cold Call","Direct Mail","Door-to-Door Sales","Sales Team Outreach"]},{group:"Other",classify:["Other"]}],y=[{label:"Scheduled",value:"Scheduled"},{label:"Rescheduled",value:"Rescheduled"},{label:"Completed",value:"Completed"},{label:"Cancelled",value:"Cancelled"}],D=e=>({label:e,value:e}),w=["Property Viewing","Property Valuation","Market Analysis","Listing Consultation","Buyer Consultation","Property Inspection","Comparative Market Analysis","Investment Analysis","Rental Assessment","Final Walkthrough","Key Handover","Document Signing","Site Measurement","Photography/Marketing","Open House Preparation","Neighborhood Tour","Follow-up Visit","Client Meeting","Other"].map(D),k=["Positive","Neutral","Negative"].map(D),S={OVERDUE:"overdue",TODAY:"today",THIS_WEEK:"this_week",SCHEDULED:"scheduled",NONE:"none"},A={[S.OVERDUE]:"Overdue",[S.TODAY]:"Today",[S.THIS_WEEK]:"This Week",[S.SCHEDULED]:"Scheduled",[S.NONE]:"None"},C=e=>{if(!e)return S.NONE;let t=e.toLowerCase().trim().replace(/\s+/g,"_");return Object.values(S).includes(t)?t:S.NONE},Y=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;switch(C(e)){case S.OVERDUE:return{label:"⚠️ ".concat(t||1,"d overdue"),emoji:"⚠️",text:"".concat(t||1,"d overdue"),color:"error"};case S.TODAY:return{label:"\uD83D\uDCC5 Due Today",emoji:"\uD83D\uDCC5",text:"Due Today",color:"warning"};case S.THIS_WEEK:return{label:"\uD83D\uDDD3️ This Week",emoji:"\uD83D\uDDD3️",text:"This Week",color:"warning"};case S.SCHEDULED:if(a){let e=new Date,t=Math.ceil((new Date(a)-e)/864e5);if(t>0&&t<=7)return{label:"✅ In ".concat(t,"d"),emoji:"✅",text:"In ".concat(t,"d"),color:"info"};return{label:"✅ Scheduled",emoji:"✅",text:"Scheduled",color:"info",date:a}}return{label:"✅ Scheduled",emoji:"✅",text:"Scheduled",color:"info"};case S.NONE:default:return{label:"—",emoji:"",text:"—",color:"default"}}}},34641:(e,t,a)=>{"use strict";a.d(t,{A:()=>c});var l=a(95155),i=a(30832),r=a.n(i),s=a(32987),n=a(9952),o=a(34640),d=a(77952);function c(e){let{value:t,onChange:a,label:i,...c}=e;return(0,l.jsx)(d.$,{dateAdapter:n.R,children:(0,l.jsx)(o.j,{components:["DatePicker"],sx:{width:"100%"},children:(0,l.jsx)(s.l,{label:i||"Select Date",value:t,onChange:e=>a(e),defaultValue:r()(),sx:{width:"100%"},...c})})})}},37890:(e,t,a)=>{"use strict";a.d(t,{$h:()=>n,My:()=>o,_r:()=>r,dF:()=>d,mv:()=>i,rN:()=>s});let l=(e,t)=>e.label.localeCompare(t.label),i=(e,t,a)=>{var i;return(null==e||null==(i=e.map(e=>({label:e[t],value:e[a]})))?void 0:i.sort(l))||[]},r=(e,t,a)=>{let i=new Map;return null==e||e.forEach(e=>{let l=e[a];i.has(l)||i.set(l,{label:e[t],value:l})}),Array.from(i.values()).sort(l)},s=(e,t,a)=>{if(!Array.isArray(e)||"function"!=typeof a)return;let l=e;Array.isArray(null==t?void 0:t.infra)&&t.infra.length>0&&(l=e.filter(e=>t.infra.includes(e.InfraId))),a(l.reduce((e,t)=>{let a=Number(t.InfraFloorCount)||0;return a>e?a:e},0))};function n(e){let{inputData:t,filters:a}=e;if(!(null==t?void 0:t.length))return[];let{site:l,infra:i,bedroom:r,view:s,direction:n,searchQuery:o,minSize:d,maxSize:c,status:u,floor:h}=a;if(null===l)return[];if(!i.length&&!r.length&&!s.length&&!n.length&&!u.length&&-1===h&&""===o&&""===d&&""===c)return t;let m=i.length>0,x=r.length>0,f=s.length>0,p=n.length>0,g=u.length>0,b=h>=0,v=o.length>0,j=""!==d&&""===c,y=""!==c&&""===d,D=""!==d&&""!==c;console.log("hasMinSizeFilter",j),console.log("hasMaxSizeFilter",y);let w=m?new Set(i):null,k=x?new Set(r):null,S=f?new Set(s):null,A=p?new Set(n):null,C=g?new Set(u):null,Y=Number(d),M=Number(c);return t.filter(e=>(!m||!!w.has(e.InfraId))&&(!x||!!k.has(e.UnitType))&&(!f||!!S.has(e.View))&&(!p||!!A.has(e.Direction))&&(!g||!!C.has(e.AvailabilityStatus))&&(!b||h===e.FloorNumber)&&(!v||!!e.UnitNumber.toString().includes(o))&&(!j||e.UnitSize>Y)&&(!y||e.UnitSize<M)&&(!D||!!(e.UnitSize>Y&&e.UnitSize<M))&&!0)}let o=e=>{if("number"!=typeof e||e<0)return[];let t=[];for(let a=e-1;a>=1;a--)t.push({label:String(a),value:a});return t.push({label:"Ground",value:0}),t},d=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},53031:(e,t,a)=>{"use strict";a.r(t),a.d(t,{ConversionReport:()=>I});var l=a(95155),i=a(30832),r=a.n(i),s=a(12115),n=a(80918),o=a(2360),d=a(77498),c=a(78880),u=a(26403),h=a(89547),m=a(59886),x=a(49742),f=a(74234),p=a(71984),g=a(35046),b=a(38867),v=a(83469),j=a(34641),y=a(27068),D=a(95124);let w=function(e){let{filters:t}=e,[a,i]=(0,s.useState)([]),n=(0,s.useCallback)(async()=>{let e={startDate:r()(t.startDate).format("YYYY-MM-DD"),endDate:r()(t.endDate).format("YYYY-MM-DD"),site_id:t.siteId,Broker_id:t.brokerId,contact_id:t.customerId};i((Object.entries(await (0,y.v4)(e)).map(e=>{let[t,a]=e;return{label:t,value:a}})||[]).map(e=>{let{label:t,value:a}=e;return{x:t,y:a,fillColor:"TotalLeads"===t?"#61D386":"QualifiedLeads"===t?"#006C9C":"SiteVisits"===t?"#4A90E2":"Bookings"===t?"#FF5731":"#CCCCCC"}}))},[t]);return(0,s.useEffect)(()=>{n()},[n]),(0,l.jsx)(D.c,{title:"Sales Funnel",subheader:"",type:"bar",sx:{width:"100%"},plotOptions:{bar:{horizontal:!0}},chart:{categories:[],series:[{data:a}]}})},k=["Dec","Jan","Feb","Mar","Apr","May","Jun"],S=e=>{let t=Array(7).fill(0);return e.forEach(e=>{let[a,l]=e.quarter.split("-"),i=e.total_leads;"Q1"===a?(t[1]=i,t[2]=i,t[3]=i):"Q2"===a?(t[4]=i,t[5]=i,t[6]=i):"Q4"===a&&(t[0]=i)}),t},A=function(e){let{filters:t}=e,[a,i]=(0,s.useState)([]),n=(0,s.useCallback)(async()=>{let e={startDate:r()(t.startDate).format("YYYY-MM-DD"),endDate:r()(t.endDate).format("YYYY-MM-DD"),site_id:t.siteId,Broker_id:t.brokerId,contact_id:t.customerId};i(S(await (0,y.t0)(e)))},[t]);return(0,s.useEffect)(()=>{n()},[n]),(0,l.jsx)(D.c,{title:"Conversion Trends",subheader:"",type:"line",sx:{width:"100%",height:"100%"},stroke:{colors:["darkgreen"]},chart:{categories:k,yaxis:{show:!1},series:[{data:a}]}})};var C=a(37890),Y=a(9670),M=a(15876),E=a(25949),B=a(72137),V=a(60032),_=a(72330),N=a(57236);let W=[{field:"Site Name",headerName:"Site Name",minWidth:140},{field:"Visits",headerName:"Visits",minWidth:160,groupable:!1},{field:"Conversion",headerName:"Conversion",minWidth:160,groupable:!1},{field:"Bookings",headerName:"Bookings",minWidth:120}],T=e=>{let{filters:t}=e,[a,i]=(0,s.useState)([]),n=(0,s.useCallback)(async()=>{let e={startDate:r()(t.startDate).format("YYYY-MM-DD"),endDate:r()(t.endDate).format("YYYY-MM-DD"),site_id:t.siteId,Broker_id:t.brokerId,contact_id:t.customerId};i(await (0,y.i$)(e))},[t]);return(0,s.useEffect)(()=>{n()},[n]),(0,l.jsxs)("div",{children:[(0,l.jsx)(Y.default,{variant:"h4",component:"h1",gutterBottom:!0,children:"Sales Team Performance"}),0===a.length?(0,l.jsx)(Y.default,{children:"No Sales Team Performance Data Available"}):(0,l.jsx)(M.A,{sx:{maxHeight:"100%",width:"100%",height:"100%"},children:(0,l.jsxs)(E.A,{size:"small","aria-label":"salesTeamPerformance",sx:{maxHeight:"100%",width:"100%",height:"100%"},children:[(0,l.jsx)(B.A,{children:(0,l.jsx)(V.default,{children:W.map(e=>(0,l.jsx)(_.default,{align:e.align,style:{minWidth:e.minWidth},children:e.headerName},e.field))})}),(0,l.jsx)(N.A,{children:a.map((e,t)=>(0,l.jsxs)(V.default,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[(0,l.jsx)(_.default,{component:"th",scope:"row",children:e["Site Name"]}),(0,l.jsx)(_.default,{align:"right",children:e.Visits}),(0,l.jsx)(_.default,{align:"right",children:e.Conversion}),(0,l.jsx)(_.default,{align:"right",children:e.Bookings})]},e["Site Name"]+t))})]})})]})},L=function(e){let[t,a]=(0,s.useState)([]);return(0,s.useEffect)(()=>{(async()=>{a(Object.entries((await (0,y.ER)(e)).reduce((e,t)=>{let a=t.LeadSource||"Unknown";return e[a]=(e[a]||0)+t.TotalLeads,e},{})).map(e=>{let[t,a]=e;return{x:t,y:a}}).map(e=>({...e,fillColor:"Facebook"===e.x?"#006C9C":"Website"===e.x?"#61D386":"#FF5731"})))})()},[e]),(0,l.jsx)(D.c,{title:"Weekly Lead Overview by Source",subheader:"",type:"bar",sx:{width:"100%"},plotOptions:{bar:{horizontal:!1}},chart:{categories:[],series:[{data:t}]}})};var z=a(32591),F=a(11571);function I(){let[e,t]=(0,s.useState)({totalVisit:0,directVisit:0,brokerVisit:0,newBrokerVisit:0}),[a,i]=(0,s.useState)({startDate:r()(),endDate:r()().add(1,"week"),siteId:[],brokerId:0,customerId:0}),y=(0,s.useRef)(null),[D,k]=(0,s.useState)([]),{sitesData:S,sitesLoading:Y,sitesError:M}=(0,p.MZ)(),E=(0,s.useMemo)(()=>Y||M||!Array.isArray(S)?[]:(0,C.mv)(S,"SiteName","SiteId"),[S,Y,M]),B=(0,s.useCallback)(()=>{i(e=>({...e,siteId:D}))},[D]),V=(0,s.useCallback)(e=>{let{target:{value:t}}=e;k(("string"==typeof t?t.split(","):t).filter(e=>"__apply__"!==e))},[]),_=(e,t)=>{let a=E.find(e=>e.value===t);return a?a.label:String(t)},N=(0,s.useCallback)(async()=>{try{let{startDate:e,endDate:l,siteId:i,brokerId:s,customerId:n}=a,o={startDate:r()(e).format("YYYY-MM-DD"),endDate:r()(l).format("YYYY-MM-DD"),site_id:i,Broker_id:s,contact_id:n},d=await (0,f.LA)(o);t(d)}catch(e){console.error("Error fetching weekly site visit counts:",e)}},[a]);return(0,s.useEffect)(()=>{N()},[N]),(0,l.jsxs)(g.KG,{maxWidth:"xl",children:[(0,l.jsx)(v.g,{links:[{name:"Home",href:x.f.dashboard.root},{name:"Conversion Report"}],sx:{mb:{xs:1,md:1},width:"100%"}}),(0,l.jsxs)(n.A,{container:!0,mb:2,spacing:2,children:[(0,l.jsx)(n.A,{size:{xs:12,sm:6,md:3},children:(0,l.jsx)(j.A,{value:a.startDate,onChange:e=>{let t=r()(e);i(e=>({...e,startDate:t}))},label:"Start Date"})}),(0,l.jsx)(n.A,{size:{xs:12,sm:6,md:3},children:(0,l.jsx)(j.A,{value:a.endDate,onChange:e=>{let t=r()(e);i(e=>({...e,endDate:t}))},label:"End Date"})}),(0,l.jsx)(n.A,{size:{xs:12,sm:6,md:2},children:(0,l.jsxs)(d.A,{sx:{flexShrink:0,width:{width:"100%"},marginTop:"8px"},size:"large",children:[(0,l.jsx)(c.default,{htmlFor:"filter-site-select",children:"Sites"}),(0,l.jsxs)(u.A,{ref:y,multiple:!0,value:D,onChange:V,onClose:B,input:(0,l.jsx)(h.default,{label:"Sites"}),renderValue:e=>e.map(e=>_("site",e)).join(", "),inputProps:{id:"filter-site-select"},sx:{textTransform:"capitalize"},MenuProps:{PaperProps:{sx:{maxHeight:300}}},children:[E.map(e=>(0,l.jsxs)(o.default,{value:e.value,children:[(0,l.jsx)(m.default,{disableRipple:!0,size:"small",checked:D.includes(e.value)}),e.label]},e.value)),(0,l.jsx)(R,{onApply:B,selectRef:y})]})]})}),(0,l.jsx)(n.A,{size:{xs:12,sm:6,md:2},children:(0,l.jsx)(z.up,{handleFilterContact:e=>{let{value:t}=e||{};i(e=>({...e,brokerId:t}))},contactType:"Broker",value:a.brokerId,size:"large",width:"100%",marginTop:"8px"})}),(0,l.jsx)(n.A,{size:{xs:12,sm:6,md:2},children:(0,l.jsx)(z.up,{handleFilterContact:e=>{let{value:t}=e||{};i(e=>({...e,customerId:t}))},contactType:"Customer",value:a.customerId,size:"large",width:"100%",marginTop:"8px"})})]}),(0,l.jsxs)(n.A,{container:!0,spacing:2,mb:2,children:[(0,l.jsx)(n.A,{size:{xs:12,sm:6,md:2},children:(0,l.jsx)(F.f,{title:"Total Lead Count",total:e.convMonthlyLeads||0,color:"primary",icon:(0,l.jsx)(b.W,{icon:"fluent:form-new-28-filled",width:"28",height:"28"})})}),(0,l.jsx)(n.A,{size:{xs:12,sm:6,md:2},children:(0,l.jsx)(F.f,{title:"Lead Won Count",total:e.convMonthlyWinLeads||0,color:"secondary",icon:(0,l.jsx)(b.W,{icon:"fluent:form-new-28-filled",width:"28",height:"28"})})}),(0,l.jsx)(n.A,{size:{xs:12,sm:6,md:2},children:(0,l.jsx)(F.f,{title:"Direct Conversion Rate",total:e.convDirectVisitConversionRate||0,color:"warning",icon:(0,l.jsx)(b.W,{icon:"mdi:leads",width:"28",height:"28"})})}),(0,l.jsx)(n.A,{size:{xs:12,sm:6,md:2},children:(0,l.jsx)(F.f,{title:"Conversion Rate Social Media",total:e.convRateSocialMedia,color:"info",icon:(0,l.jsx)(b.W,{icon:"material-symbols:no-accounts",width:"28",height:"28"})})}),(0,l.jsx)(n.A,{size:{xs:12,sm:6,md:2},children:(0,l.jsx)(F.f,{title:"Broker Conversion Rate",total:e.convBrokerConversionRate||0,color:"error",icon:(0,l.jsx)(b.W,{icon:"subway:call-3",width:"28",height:"28"})})}),(0,l.jsx)(n.A,{size:{xs:12,sm:6,md:2},children:(0,l.jsx)(F.f,{title:"Conversion Rate",total:0,color:"success",icon:(0,l.jsx)(b.W,{icon:"subway:call-3",width:"28",height:"28"})})})]}),(0,l.jsxs)(n.A,{container:!0,spacing:2,mb:2,children:[(0,l.jsx)(n.A,{size:{xs:12,sm:6,md:6},children:(0,l.jsx)(w,{filters:a})}),(0,l.jsx)(n.A,{size:{xs:12,sm:6,md:6},children:(0,l.jsx)(A,{filters:a})})]}),(0,l.jsxs)(n.A,{container:!0,spacing:2,mb:2,children:[(0,l.jsx)(n.A,{size:{xs:12,sm:6,md:6},children:(0,l.jsx)(L,{filters:a})}),(0,l.jsx)(n.A,{size:{xs:12,sm:6,md:6},children:(0,l.jsx)(T,{filters:a})})]})]})}let R=e=>{let{onApply:t,selectRef:a,label:i="Apply"}=e,r=(0,s.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),(null==a?void 0:a.current)&&a.current.blur(),t(),setTimeout(()=>{let e=document.querySelector(".MuiModal-backdrop");e&&e.click()},0)},[t,a]);return(0,l.jsx)(o.default,{onClick:r,sx:e=>({position:"sticky",bottom:0,zIndex:1,justifyContent:"center",fontWeight:e.typography.button,bgcolor:e.palette.background.paper,border:"2px solid ".concat(e.palette.divider),"&:hover":{bgcolor:e.palette.background.paper}}),children:i})}},69004:(e,t,a)=>{"use strict";a.d(t,{H:()=>d});var l=a(95155),i=a(11654),r=a(96801),s=a(35881),n=a(9670),o=a(27740);function d(e){var t,a,i,s,d,u,h,m,x,f,p,g;let{sx:b,imgUrl:v,action:j,filled:y,slotProps:D,description:w,title:k="No data",...S}=e;return(0,l.jsxs)(c,{filled:y,sx:b,...S,children:[(0,l.jsx)(r.A,{component:"img",alt:"Empty content",src:null!=v?v:"".concat(o.P.assetsDir,"/assets/icons/empty/ic-content.svg"),...null==D?void 0:D.img,sx:[{width:1,maxWidth:160},...Array.isArray(null==D||null==(t=D.img)?void 0:t.sx)?null!=(f=null==D||null==(a=D.img)?void 0:a.sx)?f:[]:[null==D||null==(i=D.img)?void 0:i.sx]]}),k&&(0,l.jsx)(n.default,{variant:"h6",...null==D?void 0:D.title,sx:[{mt:1,textAlign:"center",color:"text.disabled"},...Array.isArray(null==D||null==(s=D.title)?void 0:s.sx)?null!=(p=null==D||null==(d=D.title)?void 0:d.sx)?p:[]:[null==D||null==(u=D.title)?void 0:u.sx]],children:k}),w&&(0,l.jsx)(n.default,{variant:"body2",...null==D?void 0:D.description,sx:[{mt:1,textAlign:"center",color:"text.disabled"},...Array.isArray(null==D||null==(h=D.description)?void 0:h.sx)?null!=(g=null==D||null==(m=D.description)?void 0:m.sx)?g:[]:[null==D||null==(x=D.description)?void 0:x.sx]],children:w}),j&&j]})}let c=(0,s.default)("div",{shouldForwardProp:e=>!["filled","sx"].includes(e)})(e=>{let{filled:t,theme:a}=e;return{flexGrow:1,height:"100%",display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center",padding:a.spacing(0,3),...t&&{borderRadius:2*a.shape.borderRadius,backgroundColor:(0,i.IG)(a.vars.palette.grey["500Channel"],.04),border:"dashed 1px ".concat((0,i.IG)(a.vars.palette.grey["500Channel"],.08))}}})},70472:(e,t,a)=>{"use strict";a.r(t),a.d(t,{WeeklySiteVisitReport:()=>O});var l=a(95155),i=a(30832),r=a.n(i),s=a(12115),n=a(80918),o=a(2360),d=a(77498),c=a(78880),u=a(26403),h=a(89547),m=a(59886),x=a(49742),f=a(71984),p=a(74234),g=a(35046),b=a(38867),v=a(83469),j=a(34641),y=a(75967),D=a(3959);let w=function(e){let{filters:t}=e,[a,i]=(0,s.useState)([]),n=(0,s.useCallback)(async()=>{let e={startDate:r()(t.startDate).format("YYYY-MM-DD"),endDate:r()(t.endDate).format("YYYY-MM-DD"),site_id:t.site_id,Broker_id:t.Broker_id,contact_id:t.contact_id};try{let t=(await (0,y.qQ)(e)||[]).map(e=>{let t="";return t="Very High"===e.Category?"#FF5630":"High"===e.Category?"#D34A32":"Medium"===e.Category?"#FEAB03":"#01A76F",{label:e.Category,value:e.Total,strokeColor:t}});i(t)}catch(e){console.error("Error fetching chart data:",e)}},[t]);return(0,s.useEffect)(()=>{n()},[n]),(0,l.jsx)(D.q,{title:"Buying Intent",chart:{colors:a.map(e=>e.strokeColor),series:a}})};var k=a(95124);let S=e=>{let t=["#FF5731","#00AB55","#2065D1","#FF9800","#9C27B0","#00BCD4","#795548","#E91E63","#607D8B","#4CAF50","#FF6F00","#3F51B5"],a=[];for(let l=0;l<e;l++)if(l<t.length)a.push(t[l]);else{let e=137.5*l%360,t=65+l%3*10,i=45+l%2*10;a.push("hsl(".concat(e,", ").concat(t,"%, ").concat(i,"%)"))}return a},A=function(e){let{filters:t}=e,[a,i]=(0,s.useState)([]),n=new Set,o=(0,s.useCallback)(async()=>{let e={startDate:r()(t.startDate).format("YYYY-MM-DD"),endDate:r()(t.endDate).format("YYYY-MM-DD"),site_id:t.site_id,Broker_id:t.Broker_id,contact_id:t.contact_id};try{let t=(await (0,y.sA)(e)||[]).map(e=>({label:e.WeekNumber,value:e.TotalVisits}));i(t)}catch(e){console.error("Error fetching chart data:",e)}},[t]);(0,s.useEffect)(()=>{o()},[o]);let d=Object.keys(a),c=d.map(e=>"Week "+e);d.forEach(e=>{Object.keys(a[e]).forEach(e=>{n.add(e)})}),d.forEach(e=>{n.forEach(t=>{a[e][t]||(a[e][t]=0)})});let u=(a||[]).map(e=>({x:"Week "+e.label,y:e.value})),h=S(u.length),m=u.map((e,t)=>({...e,fillColor:h[t]}));return(0,l.jsx)(k.c,{title:"Visit Trends (last 4 weeks)",subheader:"",type:"bar",sx:{width:"100%",height:"100%"},chart:{categories:c,colors:m.map(e=>e.fillColor),series:[{data:m}]}})},C=function(e){let{filters:t}=e,[a,i]=(0,s.useState)([]),n=(0,s.useCallback)(async()=>{try{let e={startDate:r()(t.startDate).format("YYYY-MM-DD"),endDate:r()(t.endDate).format("YYYY-MM-DD"),site_id:t.site_id,Broker_id:t.Broker_id,contact_id:t.contact_id},a=(await (0,y.WC)(e)||[]).reduce((e,t)=>(e.cancelled+=t.CancelledCount,e.completed+=t.CompletedCount,e.rescheduled+=t.RescheduledCount,e),{cancelled:0,completed:0,rescheduled:0}),l=Object.entries(a).map(e=>{let[t,a]=e;return{label:t.charAt(0).toUpperCase()+t.slice(1),value:a,strokeColor:"cancelled"===t?"#FF5731":"completed"===t?"#61D386":"#006C9C"}});i(l)}catch(e){console.error("Error fetching chart data:",e)}},[t]);return(0,s.useEffect)(()=>{n()},[n]),(0,l.jsx)(D.q,{title:"Visit Status",stroke:{width:0},chart:{colors:a.map(e=>e.strokeColor),series:a}})};var Y=a(52209);let M={Callista:"#61D386","Test Site":"#006C9C","Testing Site 3":"#FF5731","Testing Site 2":"#8D33FF"},E=e=>{let{filters:t}=e,[a,i]=(0,s.useState)([]),n=(0,s.useCallback)(async()=>{try{var e;let a={startDate:r()(t.startDate).format("YYYY-MM-DD"),endDate:r()(t.endDate).format("YYYY-MM-DD"),site_id:t.site_id,Broker_id:t.Broker_id,contact_id:t.contact_id},l=await (0,y.ui)(a),s=(e=await (0,Y.ZA)(),l.map(t=>{let a=e.find(e=>e.SiteId===t.SiteId);return{SiteId:t.SiteId,SiteName:(null==a?void 0:a.SiteName)||"Unknown Site",TotalVisits:t.TotalVisits||0}})).map(e=>({x:e.SiteName,y:e.TotalVisits,fillColor:M[e.SiteName]}));i(s)}catch(e){console.error("Error fetching visit status:",e)}},[t]);return(0,s.useEffect)(()=>{n()},[n]),(0,l.jsx)(k.c,{title:"Visit By Site",subheader:"",type:"bar",stroke:{width:0},sx:{width:"100%"},plotOptions:{bar:{horizontal:!0}},chart:{categories:[],colors:a.map(e=>e.strokeColor),series:[{data:a}]}})};var B=a(37890),V=a(9670),_=a(15876),N=a(25949),W=a(72137),T=a(60032),L=a(72330),z=a(57236);let F=function(e){let{filters:t}=e,[a,i]=(0,s.useState)([]),n=(0,s.useCallback)(async()=>{try{let e={startDate:r()(t.startDate).format("YYYY-MM-DD"),endDate:r()(t.endDate).format("YYYY-MM-DD"),site_id:t.site_id,Broker_id:t.Broker_id,contact_id:t.contact_id},a=await (0,y.LV)(e);i(a)}catch(e){console.error("Error fetching sales team performance:",e)}},[t]);return(0,s.useEffect)(()=>{n()},[n]),(0,l.jsxs)("div",{children:[(0,l.jsx)(V.default,{variant:"h4",component:"h1",gutterBottom:!0,children:"Sales Team Performance"}),0===a.length?(0,l.jsx)(V.default,{children:"No Sales Team Performance Data Available"}):(0,l.jsx)(_.A,{sx:{maxHeight:"100%",width:"100%",height:"100%"},children:(0,l.jsxs)(N.A,{size:"small","aria-label":"salesTeamPerformance",sx:{maxHeight:"100%",width:"100%",height:"100%"},children:[(0,l.jsx)(W.A,{children:(0,l.jsx)(T.default,{children:[{field:"fullName",headerName:"Name",minWidth:140},{field:"TotalVisits",headerName:"Total Visits",minWidth:120},{field:"TotalCompleted",headerName:"Total Completed",minWidth:160,groupable:!1}].map(e=>(0,l.jsx)(L.default,{align:e.align,style:{minWidth:e.minWidth},children:e.headerName},e.field))})}),(0,l.jsx)(z.A,{children:a.map((e,t)=>(0,l.jsxs)(T.default,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[(0,l.jsxs)(L.default,{component:"th",scope:"row",children:[e.FirstName," ",e.LastName]}),(0,l.jsx)(L.default,{align:"right",children:e.TotalVisits}),(0,l.jsx)(L.default,{align:"right",children:e.TotalCompleted}),(0,l.jsx)(L.default,{align:"right",children:e.TotalFollowUp})]},e.FirstName+t))})]})})]})};var I=a(32591),R=a(11571);function O(){let[e,t]=(0,s.useState)({totalVisit:0,directVisit:0,brokerVisit:0,newBrokerVisit:0}),[a,i]=(0,s.useState)(""),[y,D]=(0,s.useState)(""),k=(0,s.useRef)(null),[S,Y]=(0,s.useState)([]),[M,V]=(0,s.useState)({startDate:r()(),endDate:r()().add(1,"week"),site_id:[]}),{sitesData:_,sitesLoading:N,sitesError:W}=(0,f.MZ)(),T=(0,s.useMemo)(()=>N||W||!Array.isArray(_)?[]:(0,B.mv)(_,"SiteName","SiteId"),[_,N,W]),L=(0,s.useCallback)(e=>{let{target:{value:t}}=e;Y(("string"==typeof t?t.split(","):t).filter(e=>"__apply__"!==e))},[]),z=(0,s.useCallback)(()=>{V({...M,site_id:S})},[M,S]),O=(e,t)=>{let a=T.find(e=>e.value===t);return a?a.label:String(t)},P=(0,s.useCallback)(async()=>{try{let{startDate:e,endDate:a,site_id:l,Broker_id:i,contact_id:s}=M,n={startDate:r()(e).format("YYYY-MM-DD"),endDate:r()(a).format("YYYY-MM-DD"),site_id:l,Broker_id:i,contact_id:s},o=await (0,p.y3)(n);t(o)}catch(e){console.error("Error fetching weekly site visit counts:",e)}},[M]);return(0,s.useEffect)(()=>{P()},[P]),(0,l.jsxs)(g.KG,{maxWidth:"xl",children:[(0,l.jsx)(v.g,{links:[{name:"Home",href:x.f.dashboard.root},{name:"Weekly Site Visit Report"}],sx:{mb:{xs:1,md:1},width:"100%"}}),(0,l.jsxs)(n.A,{container:!0,mb:2,spacing:2,children:[(0,l.jsx)(n.A,{size:{xs:12,sm:6,md:3},children:(0,l.jsx)(j.A,{value:M.startDate,onChange:e=>{let t=r()(e);V({...M,startDate:t,site_id:S})},label:"Start Date"})}),(0,l.jsx)(n.A,{size:{xs:12,sm:6,md:3},children:(0,l.jsx)(j.A,{value:M.endDate,onChange:e=>{let t=r()(e);V({...M,endDate:t,site_id:S})},label:"End Date"})}),(0,l.jsx)(n.A,{size:{xs:12,sm:6,md:2},children:(0,l.jsxs)(d.A,{sx:{flexShrink:0,width:{width:"100%"},marginTop:"8px"},size:"large",children:[(0,l.jsx)(c.default,{htmlFor:"filter-site-select",children:"Sites"}),(0,l.jsx)(u.A,{ref:k,multiple:!0,value:S,onChange:L,onClose:z,input:(0,l.jsx)(h.default,{label:"Sites"}),renderValue:e=>e.map(e=>O("site",e)).join(", "),inputProps:{id:"filter-site-select"},sx:{textTransform:"capitalize"},MenuProps:{PaperProps:{sx:{maxHeight:300}}},children:T.map(e=>(0,l.jsxs)(o.default,{value:e.value,children:[(0,l.jsx)(m.default,{disableRipple:!0,size:"small",checked:S.includes(e.value)}),e.label]},e.value))})]})}),(0,l.jsx)(n.A,{size:{xs:12,sm:6,md:2},children:(0,l.jsx)(I.up,{handleFilterContact:e=>{let{value:t}=e||{};i(t),V({...M,Broker_id:t,site_id:S})},contactType:"Broker",value:a,size:"large",width:"100%",marginTop:"8px"})}),(0,l.jsx)(n.A,{size:{xs:12,sm:6,md:2},children:(0,l.jsx)(I.up,{handleFilterContact:e=>{let{value:t}=e||{};D(t),V({...M,contact_id:t,site_id:S})},contactType:"Customer",value:y,size:"large",width:"100%",marginTop:"8px"})})]}),(0,l.jsxs)(n.A,{container:!0,spacing:2,mb:2,children:[(0,l.jsx)(n.A,{size:{xs:12,sm:6,md:3},children:(0,l.jsx)(R.f,{title:"Total Visits",total:e.totalVisit,color:"secondary",icon:(0,l.jsx)(b.W,{icon:"fluent:form-new-28-filled",width:"28",height:"28"})})}),(0,l.jsx)(n.A,{size:{xs:12,sm:6,md:3},children:(0,l.jsx)(R.f,{title:"Direct Visits",total:e.directVisit,icon:(0,l.jsx)(b.W,{icon:"mdi:leads",width:"28",height:"28"})})}),(0,l.jsx)(n.A,{size:{xs:12,sm:6,md:3},children:(0,l.jsx)(R.f,{title:"Broker Visits",total:e.brokerVisit,color:"error",icon:(0,l.jsx)(b.W,{icon:"material-symbols:no-accounts",width:"28",height:"28"})})}),(0,l.jsx)(n.A,{size:{xs:12,sm:6,md:3},children:(0,l.jsx)(R.f,{title:"New Broker Visits",total:e.newBrokerVisit,color:"warning",icon:(0,l.jsx)(b.W,{icon:"subway:call-3",width:"28",height:"28"})})})]}),(0,l.jsxs)(n.A,{container:!0,spacing:2,mb:2,children:[(0,l.jsx)(n.A,{size:{xs:12,sm:6,md:6},children:(0,l.jsx)(A,{filters:M})}),(0,l.jsx)(n.A,{size:{xs:12,sm:6,md:3},children:(0,l.jsx)(C,{filters:M})}),(0,l.jsx)(n.A,{size:{xs:12,sm:6,md:3},children:(0,l.jsx)(w,{filters:M})})]}),(0,l.jsxs)(n.A,{container:!0,spacing:2,mb:2,sx:{height:"100%"},children:[(0,l.jsx)(n.A,{size:{xs:12,sm:6,md:6},children:(0,l.jsx)(E,{filters:M})}),(0,l.jsx)(n.A,{size:{xs:12,sm:6,md:6},children:(0,l.jsx)(F,{filters:M})})]})]})}},71578:(e,t,a)=>{"use strict";a.r(t),a.d(t,{BrokerReport:()=>I});var l=a(95155),i=a(30832),r=a.n(i),s=a(12115),n=a(80918),o=a(2360),d=a(77498),c=a(78880),u=a(26403),h=a(89547),m=a(59886),x=a(49742),f=a(74234),p=a(71984),g=a(35046),b=a(38867),v=a(83469),j=a(34641),y=a(37890),D=a(95124);let w=e=>{let{filter:t}=e,[a,i]=(0,s.useState)([]),[n,o]=(0,s.useState)([]),d=(0,s.useCallback)(async()=>{try{let e={startDate:r()(t.startDate).format("YYYY-MM-DD"),endDate:r()(t.endDate).format("YYYY-MM-DD"),site_id:t.siteId,Broker_id:t.brokerId,noParams:!0},a=await (0,f.m1)(e),l=a.map(e=>{let t=r()(e.Month).month();return y.dF[t]});o(l);let s=a.map(e=>e.BrokerVisitorCount);i(s)}catch(e){console.error("Error fetching weekly site visit counts:",e)}},[t]);return(0,s.useEffect)(()=>{d()},[d]),(0,l.jsx)(D.c,{title:"Broker Visitors (6 month)",subheader:"",type:"line",sx:{width:"100%",height:"100%"},stroke:{colors:["#60D07F"]},chart:{categories:n,yaxis:{show:!1},series:[{data:a}]}})},k=e=>{let{filter:t}=e,[a,i]=(0,s.useState)({categories:[],seriesData:[]}),n=(0,s.useCallback)(async()=>{try{let e={startDate:r()(t.startDate).format("YYYY-MM-DD"),endDate:r()(t.endDate).format("YYYY-MM-DD"),site_id:t.siteId,Broker_id:t.brokerId},a=await (0,f.hX)(e),l=function(e){let t=new Date(e.start_date),a=new Date(e.end_date),l=e.TotalBrokerLeadCount,i=[],r=new Date(t.getFullYear(),t.getMonth(),1);for(;r<=a;)i.push(r.toLocaleDateString("en-US",{month:"short"})),r.setMonth(r.getMonth()+1);let s=i.length,n=Math.floor(l/s),o=l%s,d=[];for(let e=0;e<s;e++)d.push(n+ +(e<o));return{categories:i,seriesData:d}}(a);i(l)}catch(e){console.error("Error fetching weekly site visit counts:",e)}},[t]);return(0,s.useEffect)(()=>{n()},[n]),(0,l.jsx)(D.c,{title:"Broker Lead Count (6 month)",subheader:"",type:"line",sx:{width:"100%",height:"100%"},stroke:{colors:["#60D07F"]},chart:{categories:a.categories||[],yaxis:{show:!1},series:[{data:a.seriesData||[]}]}})};var S=a(43173);let A=e=>{let{filter:t}=e,[a,i]=(0,s.useState)([]),n=(0,s.useCallback)(async()=>{try{let{startDate:e,endDate:a,siteId:l,brokerId:s}=t,n={startDate:r()(e).format("YYYY-MM-DD"),endDate:r()(a).format("YYYY-MM-DD"),site_id:l,Broker_id:s},o=await (0,S.bE)(n),d=function(e){let t={Win:"Win",Qualified:"Qualified Leads","Site Visit":"Site Visit",Booking:"Booking"},a={Win:"#4CAF50","Qualified Leads":"#33B5E5","Site Visit":"#9C27B0",Booking:"#4CAF50"};return e.map(e=>({x:t[e.LeadStatus]||e.LeadStatus,y:e.CustomerCount,fillColor:a[t[e.LeadStatus]]}))}(o);i(d)}catch(e){console.error("Error fetching weekly site visit counts:",e)}},[t]);return(0,s.useEffect)(()=>{n()},[n]),(0,l.jsx)(D.c,{title:"Broker Wise Customer",subheader:"",type:"bar",sx:{width:"100%",height:"100%"},plotOptions:{bar:{horizontal:!0}},chart:{categories:[],series:[{data:a}]}})};var C=a(9670),Y=a(15876),M=a(25949),E=a(72137),B=a(60032),V=a(72330),_=a(57236);let N=e=>{let{filter:t}=e,[a,i]=(0,s.useState)([]),n=(0,s.useCallback)(async()=>{try{let e={startDate:r()(t.startDate).format("YYYY-MM-DD"),endDate:r()(t.endDate).format("YYYY-MM-DD"),site_id:t.siteId,Broker_id:t.brokerId,noParams:!0},a=await (0,f.yS)(e);i(a)}catch(e){console.error("Error fetching weekly site visit counts:",e)}},[t]);return(0,s.useEffect)(()=>{n()},[n]),(0,l.jsxs)("div",{children:[(0,l.jsx)(C.default,{variant:"h4",component:"h1",gutterBottom:!0,children:"Sales Team Performance"}),0===a.length?(0,l.jsx)(C.default,{children:"No Sales Team Performance Data Available"}):(0,l.jsx)(Y.A,{sx:{maxHeight:"100%",width:"100%",height:"100%"},children:(0,l.jsxs)(M.A,{size:"small","aria-label":"salesTeamPerformance",sx:{maxHeight:"100%",width:"100%",height:"100%"},children:[(0,l.jsx)(E.A,{children:(0,l.jsx)(B.default,{children:[{field:"BrokerName",headerName:"Broker Name",minWidth:140},{field:"ConversionRate",headerName:"Conversion Rate",minWidth:160,groupable:!1},{field:"Losts",headerName:"Losts",minWidth:160,groupable:!1},{field:"SiteVisits",headerName:"Site Visits",minWidth:160,groupable:!1},{field:"TotalLeads",headerName:"Total Leads",minWidth:120},{field:"Wins",headerName:"Wins",minWidth:160,groupable:!1}].map(e=>(0,l.jsx)(V.default,{align:e.align,style:{minWidth:e.minWidth},children:e.headerName},e.field))})}),(0,l.jsx)(_.A,{children:a.map((e,t)=>(0,l.jsxs)(B.default,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[(0,l.jsx)(V.default,{component:"th",scope:"row",children:e.BrokerName}),(0,l.jsx)(V.default,{align:"right",children:e.ConversionRate}),(0,l.jsx)(V.default,{align:"right",children:e.Losts}),(0,l.jsx)(V.default,{align:"right",children:e.SiteVisits}),(0,l.jsx)(V.default,{align:"right",children:e.TotalLeads}),(0,l.jsx)(V.default,{align:"right",children:e.Wins})]},e.BrokerName+t))})]})})]})},W=e=>{let{filter:t}=e,[a,i]=(0,s.useState)([]),n=(0,s.useCallback)(async()=>{try{let e={startDate:r()(t.startDate).format("YYYY-MM-DD"),endDate:r()(t.endDate).format("YYYY-MM-DD"),site_id:t.siteId,Broker_id:t.brokerId,contact_id:t.customerId,noParams:!0},a=await (0,f.F8)(e),l=function(e){let t={New:"Leads",Qualified:"Qualified Leads","Site Visit":"Site Visit",Booking:"Booking"},a={Leads:"#008FFB","Qualified Leads":"#33B5E5","Site Visit":"#9C27B0",Booking:"#4CAF50"};return e.map(e=>({x:t[e.x]||e.LeadStatus,y:e.LeadCount,fillColor:a[t[e.LeadStatus]]}))}(a);i(l)}catch(e){console.error("Error fetching weekly site visit counts:",e)}},[t]);return(0,s.useEffect)(()=>{n()},[n]),(0,l.jsx)(D.c,{title:"Site Broker Performance",subheader:"",type:"bar",sx:{width:"100%",height:"100%"},plotOptions:{bar:{horizontal:!0}},chart:{categories:[],series:[{data:a}]}})};var T=a(32591);let L=["#FF5733","#33B5E5","#9C27B0","#4CAF50"],z=e=>{let{filter:t}=e,[a,i]=(0,s.useState)([]);return(0,s.useEffect)(()=>{(async()=>{try{let e={startDate:r()(t.startDate).format("YYYY-MM-DD"),endDate:r()(t.endDate).format("YYYY-MM-DD"),site_id:t.siteId,Broker_id:t.brokerId,noParams:!0},a=(await (0,S.Lm)(e)||[]).map(e=>{let t=new Date(e.VisitYear,e.VisitMonth-1).toLocaleString("default",{month:"short"});return{x:"(".concat(t,", W").concat(e.WeekOfMonth,")"),y:e.TotalSiteVisits}}).map((e,t)=>({...e,fillColor:L[t%L.length]}));i(a)}catch(e){console.error("Error fetching chart data:",e)}})()},[t]),(0,l.jsx)(D.c,{title:"Broker Visit Distribution",subheader:"",type:"bar",plotOptions:{bar:{distributed:!0}},sx:{width:"100%",height:"100%"},chart:{categories:[],series:[{data:a}]}})};var F=a(11571);function I(){let[e,t]=(0,s.useState)({totalVisit:0,directVisit:0,brokerVisit:0,newBrokerVisit:0}),[a,i]=(0,s.useState)({startDate:r()(),endDate:r()().add(1,"week"),siteId:[],brokerId:0}),D=(0,s.useRef)(null),[S,C]=(0,s.useState)([]),{sitesData:Y,sitesLoading:M,sitesError:E}=(0,p.MZ)(),B=(0,s.useMemo)(()=>M||E||!Array.isArray(Y)?[]:(0,y.mv)(Y,"SiteName","SiteId"),[Y,M,E]),V=(0,s.useCallback)(e=>{let{target:{value:t}}=e;C(("string"==typeof t?t.split(","):t).filter(e=>"__apply__"!==e))},[]),_=(0,s.useCallback)(()=>{i(e=>({...e,siteId:S}))},[S]),L=(e,t)=>{let a=B.find(e=>e.value===t);return a?a.label:String(t)},I=(0,s.useCallback)(async()=>{try{let{startDate:e,endDate:l,siteId:i,brokerId:s}=a,n={startDate:r()(e).format("YYYY-MM-DD"),endDate:r()(l).format("YYYY-MM-DD"),site_id:i,Broker_id:s},o=await (0,f.uM)(n);t(o)}catch(e){console.error("Error fetching weekly site visit counts:",e)}},[a]);return(0,s.useEffect)(()=>{I()},[I]),(0,l.jsxs)(g.KG,{maxWidth:"xl",children:[(0,l.jsx)(v.g,{links:[{name:"Home",href:x.f.dashboard.root},{name:"Broker Report"}],sx:{mb:{xs:1,md:1},width:"100%"}}),(0,l.jsxs)(n.A,{container:!0,mb:2,spacing:2,children:[(0,l.jsx)(n.A,{size:{xs:12,sm:6,md:3},children:(0,l.jsx)(j.A,{value:a.startDate,onChange:e=>{let t=r()(e);i({...a,startDate:t})},label:"Start Date"})}),(0,l.jsx)(n.A,{size:{xs:12,sm:6,md:3},children:(0,l.jsx)(j.A,{value:a.endDate,onChange:e=>{let t=r()(e);i({...a,endDate:t})},label:"End Date"})}),(0,l.jsx)(n.A,{size:{xs:12,sm:6,md:2},children:(0,l.jsxs)(d.A,{sx:{flexShrink:0,width:{width:"100%"},marginTop:"8px"},size:"large",children:[(0,l.jsx)(c.default,{htmlFor:"filter-site-select",children:"Sites"}),(0,l.jsxs)(u.A,{ref:D,multiple:!0,value:S,onChange:V,onClose:_,input:(0,l.jsx)(h.default,{label:"Sites"}),renderValue:e=>e.map(e=>L("site",e)).join(", "),inputProps:{id:"filter-site-select"},sx:{textTransform:"capitalize"},MenuProps:{PaperProps:{sx:{maxHeight:300}}},children:[B.map(e=>(0,l.jsxs)(o.default,{value:e.value,children:[(0,l.jsx)(m.default,{disableRipple:!0,size:"small",checked:S.includes(e.value)}),e.label]},e.value)),(0,l.jsx)(R,{onApply:_,selectRef:D})]})]})}),(0,l.jsx)(n.A,{size:{xs:12,sm:6,md:2},children:(0,l.jsx)(T.up,{handleFilterContact:e=>{let{value:t}=e||{};i({...a,brokerId:t})},contactType:"Broker",value:a.brokerId,size:"large",width:"100%",marginTop:"8px"})})]}),(0,l.jsxs)(n.A,{container:!0,spacing:2,mb:2,children:[(0,l.jsx)(n.A,{size:{xs:12,sm:6,md:4},children:(0,l.jsx)(F.f,{title:"Total broker Leads",total:e.monthlyBrokerTotalLeads,color:"primary",icon:(0,l.jsx)(b.W,{icon:"fluent:form-new-28-filled",width:"28",height:"28"})})}),(0,l.jsx)(n.A,{size:{xs:12,sm:6,md:4},children:(0,l.jsx)(F.f,{title:"Broker Site Visit",total:e.monthlyBrokerSiteVisits,color:"secondary",icon:(0,l.jsx)(b.W,{icon:"fluent:form-new-28-filled",width:"28",height:"28"})})}),(0,l.jsx)(n.A,{size:{xs:12,sm:6,md:4},children:(0,l.jsx)(F.f,{title:"New Broker",total:e.monthlyNewBrokers,color:"warning",icon:(0,l.jsx)(b.W,{icon:"mdi:leads",width:"28",height:"28"})})})]}),(0,l.jsxs)(n.A,{container:!0,mb:2,spacing:2,children:[(0,l.jsx)(n.A,{size:{xs:12,sm:12,md:6},children:(0,l.jsx)(w,{filter:a})}),(0,l.jsx)(n.A,{size:{xs:12,sm:12,md:6},children:(0,l.jsx)(k,{filter:a})})]}),(0,l.jsxs)(n.A,{container:!0,mb:2,spacing:2,children:[(0,l.jsx)(n.A,{size:{xs:12,sm:6,md:6},children:(0,l.jsx)(z,{filter:a})}),(0,l.jsx)(n.A,{size:{xs:12,sm:6,md:6},children:(0,l.jsx)(W,{filter:a})})]}),(0,l.jsx)(n.A,{container:!0,mb:2,spacing:2,children:(0,l.jsx)(n.A,{size:{xs:12,sm:12,md:12},children:(0,l.jsx)(A,{filter:a})})}),(0,l.jsx)(n.A,{container:!0,mb:2,spacing:2,children:(0,l.jsx)(n.A,{size:{xs:12,sm:6,md:10},children:(0,l.jsx)(N,{filter:a})})})]})}let R=e=>{let{onApply:t,selectRef:a,label:i="Apply"}=e,r=(0,s.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),(null==a?void 0:a.current)&&a.current.blur(),t(),setTimeout(()=>{let e=document.querySelector(".MuiModal-backdrop");e&&e.click()},0)},[t,a]);return(0,l.jsx)(o.default,{onClick:r,sx:e=>({position:"sticky",bottom:0,zIndex:1,justifyContent:"center",fontWeight:e.typography.button,bgcolor:e.palette.background.paper,border:"2px solid ".concat(e.palette.divider),"&:hover":{bgcolor:e.palette.background.paper}}),children:i})}},83469:(e,t,a)=>{"use strict";a.d(t,{g:()=>j});var l=a(95155),i=a(35206),r=a(17764),s=a(72635),n=a(38867);function o(e){let{sx:t,label:a,...i}=e;return(0,l.jsxs)(r.A,{component:s.W,color:"inherit",underline:"none",sx:[e=>({verticalAlign:"middle",["& .".concat(n.M.root)]:{verticalAlign:"inherit",transform:"translateY(-2px)",ml:{xs:"-14px",md:"-18px"},transition:e.transitions.create(["opacity"],{duration:e.transitions.duration.shorter,easing:e.transitions.easing.sharp})},"&:hover":{["& .".concat(n.M.root)]:{opacity:.48}}}),...Array.isArray(t)?t:[t]],...i,children:[(0,l.jsx)(n.W,{width:18,icon:"eva:arrow-ios-back-fill"}),a]})}var d=a(35881);function c(e){let{links:t,sx:a,...i}=e;return(0,l.jsx)(u,{sx:a,...i,children:null==t?void 0:t.map(e=>(0,l.jsx)("li",{children:(0,l.jsx)(r.A,{href:e,variant:"body2",target:"_blank",rel:"noopener",children:e})},e))})}let u=(0,d.default)("ul")(()=>({display:"flex",flexDirection:"column","& > li":{display:"flex"}}));function h(e){let{href:t,icon:a,name:i,disabled:n,...o}=e,d=()=>(0,l.jsxs)(m,{disabled:n,...o,children:[a&&(0,l.jsx)(x,{children:a}),i]});return t?(0,l.jsx)(r.A,{component:s.W,href:t,color:"inherit",sx:{display:"inline-flex",...n&&{pointerEvents:"none"}},children:d()}):d()}let m=(0,d.default)("div",{shouldForwardProp:e=>!["disabled","sx"].includes(e)})(e=>{let{disabled:t,theme:a}=e;return{...a.typography.body2,alignItems:"center",gap:a.spacing(1),display:"inline-flex",color:a.vars.palette.text.primary,...t&&{cursor:"default",pointerEvents:"none",color:a.vars.palette.text.disabled}}}),x=(0,d.default)("span")(()=>({display:"inherit","& > :first-of-type:not(style):not(:first-of-type ~ *), & > style + *":{width:20,height:20}})),f=(0,d.default)("div")(e=>{let{theme:t}=e;return{display:"flex",flexDirection:"column",gap:t.spacing(2)}}),p=(0,d.default)("h6")(e=>{let{theme:t}=e;return{...t.typography.h4,margin:0,padding:0,display:"inline-flex"}}),g=(0,d.default)("div")(e=>{let{theme:t}=e;return{display:"flex",flexWrap:"wrap",gap:t.spacing(2),alignItems:"flex-start",justifyContent:"flex-end"}}),b=(0,d.default)("div")(e=>{let{theme:t}=e;return{display:"flex",flex:"1 1 auto",gap:t.spacing(2),flexDirection:"column"}}),v=(0,d.default)("span")(e=>{let{theme:t}=e;return{width:4,height:4,borderRadius:"50%",backgroundColor:t.vars.palette.text.disabled}});function j(e){var t,a;let{sx:r,action:s,backHref:n,heading:d,slots:u={},links:m=[],moreLinks:x=[],slotProps:j={},activeLast:y=!1,...D}=e,w=null==(t=m[m.length-1])?void 0:t.name;return(0,l.jsxs)(f,{sx:r,...D,children:[(0,l.jsxs)(g,{...null==j?void 0:j.container,children:[(0,l.jsxs)(b,{...null==j?void 0:j.content,children:[(d||n)&&(0,l.jsx)(p,{...null==j?void 0:j.heading,children:n?(0,l.jsx)(o,{href:n,label:d}):d}),(!!m.length||(null==u?void 0:u.breadcrumbs))&&(null!=(a=null==u?void 0:u.breadcrumbs)?a:(0,l.jsx)(i.A,{separator:(0,l.jsx)(v,{}),...null==j?void 0:j.breadcrumbs,children:m.map((e,t)=>{var a;return(0,l.jsx)(h,{icon:e.icon,href:e.href,name:e.name,disabled:e.name===w&&!y||!e.href},null!=(a=e.name)?a:t)})}))]}),s]}),!!(null==x?void 0:x.length)&&(0,l.jsx)(c,{links:x,...null==j?void 0:j.moreLinks})]})}},88165:(e,t,a)=>{"use strict";a.d(t,{Ey:()=>u,Me:()=>x,OB:()=>o,Q6:()=>h,aA:()=>c,cF:()=>m,eL:()=>d,tR:()=>n});var l=a(19169),i=a(12115),r=a(18835);let s={revalidateIfStale:!1,revalidateOnFocus:!1,revalidateOnReconnect:!1},n=async e=>{let t=r.vZ.leads.create;return(await (0,r.$P)([t,e])).data};function o(e){let t=e?[r.vZ.leads.readSingleInDetail(e)]:"",{data:a,isLoading:n,error:o,isValidating:d,mutate:c}=(0,l.Ay)(t,r.GO,s);return(0,i.useMemo)(()=>({detailedLeadData:null!=a?a:[],detailedLeadLoading:n,detailedLeadError:o?(null==o?void 0:o.message)||"Error fetching (useGetDetailedLead)":null,detailedLeadValidating:d,detailedLeadEmpty:!n&&!d&&(!Array.isArray(a)||0===a.length),refetch:()=>c()}),[a,o,n,d,c])}function d(e,t){let a=r.vZ.leads.paginationBuyerWiseLeads(e,t),{data:n,isLoading:o,error:d,isValidating:c,mutate:u}=(0,l.Ay)(a,r.GO,s);return(0,i.useMemo)(()=>({bwLeadsData:null!=n?n:[],bwLeadsLoading:o,bwLeadsError:d?(null==d?void 0:d.message)||"Error fetching data":null,bwLeadsValidating:c,bwLeadsEmpty:!o&&!c&&(!Array.isArray(n)||0===n.length)}),[n,d,o,c,u])}let c=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.vZ.leads.readAllInDetail(e,t,a),{data:o,isLoading:d,error:c,isValidating:u,mutate:h}=(0,l.Ay)(n,async a=>{try{return await (0,r.GO)(a)}catch(a){if("No records found for the given filter(s)."===a)return{data:[],total_records:0,sIndex:e,limit:t};throw a}},s);return(0,i.useMemo)(()=>({detailedLeadsData:null!=o?o:[],detailedLeadsLoading:d,detailedLeadsError:c?(null==c?void 0:c.message)||"Error fetching data":null,detailedLeadsIsValidating:u,detailedLeadsEmpty:!d&&!u&&(!o||!o.data||0===o.data.length),refetch:()=>h()}),[o,d,c,u,h])};function u(){let e=r.vZ.leads.aggregates,{data:t,isLoading:a,error:s,mutate:n}=(0,l.Ay)(e,r.ev,{revalidateIfStale:!0,revalidateOnFocus:!0,revalidateOnReconnect:!0,dedupingInterval:3e4,shouldRetryOnError:e=>{var t;let a=null==e||null==(t=e.response)?void 0:t.status;return!(a>=400)||!(a<500)},errorRetryCount:2,errorRetryInterval:5e3,onError:(e,t)=>{var a;console.error("[Aggregates Error]",{endpoint:t,status:null==e||null==(a=e.response)?void 0:a.status,message:e.message,timestamp:new Date().toISOString()})}});return(0,i.useMemo)(()=>{var e;return{aggregatesData:null!=(e=null==t?void 0:t.aggregates)?e:{},aggregatesLoading:a,aggregatesError:s,refetchAggregates:n}},[t,a,s,n])}async function h(e,t){let a=r.vZ.leads.update(e);await (0,r.mu)([a,t])}async function m(e,t){let a=r.vZ.leads.update(e);return await (0,r.tD)([a,t])}let x=(e,t,a)=>{let n=e=>null!=e&&""!==e,o=n(e)||n(t)||n(a),d=o?r.vZ.leads.search(e,t,a):null,{data:c,isLoading:u,error:h,isValidating:m,mutate:x}=(0,l.Ay)(d,r.GO,s);return(0,i.useMemo)(()=>({searchedLeadsData:o&&null!=c?c:[],searchedLeadsLoading:!!o&&u,searchedLeadsError:o&&h?(null==h?void 0:h.message)||"Error fetching data":null,searchedLeadsIsValidating:!!o&&m,searchedLeadsEmpty:!u&&!m&&(!Array.isArray(c)||0===c.length),refetchSearchedLeads:()=>x(),hasParams:o}),[c,u,h,m,x,o])}}}]);