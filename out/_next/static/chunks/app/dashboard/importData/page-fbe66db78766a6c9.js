(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8135],{6297:(e,t,a)=>{"use strict";a.r(t),a.d(t,{ImportData:()=>tl});var r=a(95155),l=a(38543),n=a(12115),i=a(21030),s=a(84256),o=a(96801),d=a(67172),c=a(85463),u=a(84350),p=a(49742);let h="true"===a(49509).env.NEXT_PUBLIC_DEBUG;class m{log(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];this.isEnabled&&console.log("[".concat(this.namespace,"]"),...t)}warn(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];this.isEnabled&&console.warn("[".concat(this.namespace,"]"),...t)}error(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];if(this.isEnabled)console.error("[".concat(this.namespace,"]"),...t);else{let e=t.filter(e=>e instanceof Error||"string"==typeof e&&e.includes("Error"));e.length>0&&console.error("[".concat(this.namespace,"]"),...e)}}info(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];this.isEnabled&&console.info("[".concat(this.namespace,"]"),...t)}debug(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a]}group(e){this.isEnabled&&console.group("[".concat(this.namespace,"] ").concat(e))}groupCollapsed(e){this.isEnabled&&console.groupCollapsed("[".concat(this.namespace,"] ").concat(e))}groupEnd(){this.isEnabled&&console.groupEnd()}table(e,t){this.isEnabled&&console.table(e,t)}time(e){this.isEnabled&&console.time("[".concat(this.namespace,"] ").concat(e))}timeEnd(e){this.isEnabled&&console.timeEnd("[".concat(this.namespace,"] ").concat(e))}assert(e){for(var t=arguments.length,a=Array(t>1?t-1:0),r=1;r<t;r++)a[r-1]=arguments[r];this.isEnabled&&console.assert(e,"[".concat(this.namespace,"]"),...a)}count(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";this.isEnabled&&console.count("[".concat(this.namespace,"] ").concat(e))}createChild(e){return new m("".concat(this.namespace,":").concat(e))}constructor(e="App"){this.namespace=e,this.isEnabled=h}}new m("CRM");let f=new m("Import");new m("API"),new m("UI");var x=a(35046),g=a(23464),v=a(3925),y=a(18835),j=a(27740);class b{set(e,t){this.cache.set(e,{data:t,timestamp:Date.now()}),this.cleanupInterval||this.startCleanup()}get(e){let t=this.cache.get(e);return t?Date.now()-t.timestamp>this.maxAge?(this.cache.delete(e),null):t.data:null}delete(e){this.cache.delete(e),0===this.cache.size&&this.cleanupInterval&&(clearInterval(this.cleanupInterval),this.cleanupInterval=null)}clear(){this.cache.clear(),this.cleanupInterval&&(clearInterval(this.cleanupInterval),this.cleanupInterval=null)}startCleanup(){this.cleanupInterval=setInterval(()=>{let e=Date.now();for(let[t,a]of this.cache.entries())e-a.timestamp>this.maxAge&&this.cache.delete(t);0===this.cache.size&&(clearInterval(this.cleanupInterval),this.cleanupInterval=null)},3e5)}getSize(){return this.cache.size}constructor(){this.cache=new Map,this.maxAge=18e5,this.cleanupInterval=null}}let S=new b,w={leads:{"First Name":"ContactFName","Last Name":"ContactLName","Contact Number":"ContactNo","Broker First Name":"BrokerFName","Broker Last Name":"BrokerLName","Broker Number":"BrokerNo","Site Name":"SiteName","Site City":"SiteCity","Site Address":"SiteAddress","Site Type":"SiteType",Locality:"Locality","Site Status":"SiteStatus","Site Description":"SiteDescription","Is Operational":"IsOperational","Lead Name":"LeadName","Created Date":"CreatedDate","Lead Closed Date":"LeadClosedDate","Lead Status":"LeadStatus","Lead Source":"LeadSource","Lead Notes":"LeadNotes","Lost Reasons":"LostReasons",Bedrooms:"Bedrooms","Size (Sq Ft)":"SizeSqFt","View Type":"ViewType","Floor Preference":"FloorPreference","Buying Intent":"BuyingIntent",Direction:"Direction"},infrastructure:{UnitNumber:"UnitNumber",FloorNumber:"FloorNumber",InfraName:"InfraName",InfraCategory:"InfraCategory",SiteName:"SiteName",SiteType:"SiteType",UnitSize:"UnitSize",UnitType:"UnitType",Bedrooms:"Bedrooms",Direction:"Direction",View:"View",AvailabilityStatus:"AvailabilityStatus",BasePrice:"BasePrice",TotalUnits:"TotalUnits",AvailableUnits:"AvailableUnits",SoldUnits:"SoldUnits",BookedUnits:"BookedUnits"}};function C(e){return Object.keys(w[e]||{})}async function A(e){let t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{maxRetries:r=3,initialDelay:l=1e3,maxDelay:n=1e4,backoffFactor:i=2,shouldRetry:s=e=>!0,onRetry:o=()=>{}}=a;for(let a=0;a<r;a++)try{return await e()}catch(d){if(t=d,!s(d)||a===r-1)throw d;let e=Math.min(l*Math.pow(i,a),n);o({attempt:a+1,maxRetries:r,delay:e,error:d}),await new Promise(t=>setTimeout(t,e))}throw t}function I(e){var t,a,r,l;return!e.response||(null==(t=e.response)?void 0:t.status)>=500||(null==(a=e.response)?void 0:a.status)===429||"ECONNABORTED"===e.code||"ETIMEDOUT"===e.code||((null==(r=e.response)?void 0:r.status)>=400&&(null==(l=e.response)||l.status),!1)}Object.fromEntries(Object.entries(w.leads).map(e=>{let[t,a]=e;return[a,t]})),Object.fromEntries(Object.entries(w.infrastructure).map(e=>{let[t,a]=e;return[a,t]}));let N=j.P.serverUrl;async function R(e){try{if(N&&!N.includes("localhost")){let t=await g.A.get("".concat(N,"/import/template/").concat(e),{responseType:"blob",timeout:5e3,headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken"))}}),a=window.URL.createObjectURL(new Blob([t.data])),r=document.createElement("a");return r.href=a,r.setAttribute("download","".concat(e,"_import_template.xlsx")),document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(a),{success:!0}}}catch(e){}let t="leads"===e?{headers:C("leads"),sampleData:[["Rajesh","Kumar","9876543210","","","","Skyline Heights","Mumbai","Plot No. 45, Andheri West","RESIDENTIAL","Andheri West","Active","Luxury residential project with modern amenities","Yes","Rajesh Kumar - 3BHK Inquiry","2024-12-01","","NEW","Website","Interested in 3BHK flat, budget 1.5Cr","","3","1500","City View","12","8","East"],["Priya","Sharma","9988776655","","","","Green Valley Residency","Pune","Baner Road, Near IT Park","RESIDENTIAL","Baner","Active","2 & 3 BHK apartments with garden view","Yes","Priya Sharma - Urgent Purchase","2024-11-28","","HOT","Broker Reference","Ready to book immediately, needs 2BHK with parking","","2","1200","Garden View","5","9","North"],["Amit","Patel","9123456789","Amit","Patel","9123456789","Ocean Pearl Complex","Goa","Calangute Beach Road","RESIDENTIAL","Calangute","Active","Beachfront luxury villas and apartments","Yes","Amit Patel - Multiple Clients","2024-11-25","","WARM","Partner Broker","Has 5 clients interested in 1 & 2 BHK units","","1-2","1000","Sea View","","7",""],["Sneha","Reddy","8899001122","","","","Tech Park Plaza","Hyderabad","HITEC City, Madhapur","COMMERCIAL","Madhapur","Under Construction","Commercial office spaces and retail shops","No","Sneha Reddy - Office Space","2024-12-02","","NEW","Walk-in","Looking for 2000 sqft office space for IT company","","","2000","","","6",""],["Vikram","Singh","7766554433","","","","Sunshine Gardens","Chennai","OMR Road, Sholinganallur","RESIDENTIAL","Sholinganallur","Active","Affordable housing project with club house","Yes","Vikram Singh - Investment","2024-11-30","","WARM","Facebook Ad","Investment purpose, interested in multiple units","","2","1100","","","7","South"],["Anita","Gupta","9876501234","","","","Royal Towers","Noida","Sector 62, Near Metro Station","RESIDENTIAL","Sector 62","Active","Premium high-rise apartments","Yes","Anita Gupta - Family Home","2024-11-29","","HOT","Customer Referral","Referred by Mr. Sharma, needs 4BHK penthouse","","4","3000","City View","20","9","North"],["Karthik","Nair","8765432109","","","","Lake View Villas","Kochi","Marine Drive, Ernakulam","RESIDENTIAL","Ernakulam","Active","Independent villas with lake view","Yes","Karthik Nair - Villa Inquiry","2024-12-03","","NEW","Property Expo","Met at property exhibition, interested in villa","","4","2500","Lake View","","8","West"],["Meera","Joshi","9998887776","","","","City Square Mall","Ahmedabad","S.G. Highway","COMMERCIAL","S.G. Highway","Active","Commercial complex with multiplex","Yes","Meera Joshi - Shop Purchase","2024-11-15","2024-11-27","WON","Website","Purchased 500 sqft retail shop, possession in March","","","500","","","10",""],["Rahul","Verma","7778889990","","","","Heritage Heights","Jaipur","Vaishali Nagar","RESIDENTIAL","Vaishali Nagar","Active","Traditional architecture apartments","Yes","Rahul Verma - Future Purchase","2024-10-20","","COLD","Email Campaign","Planning to buy after 6 months, just exploring","","3","1400","","8","3","East"],["Deepika","Shah","8887776665","","","","Metro Towers","Delhi","Dwarka Sector 21","RESIDENTIAL","Dwarka","Active","Affordable 1 & 2 BHK flats","Yes","Deepika Shah - Budget Constraint","2024-11-10","2024-11-26","LOST","Newspaper Ad","Budget constraints, looking for cheaper options","Price too high, competitor offered 20% less","2","900","","","4",""]],instructions:["# ==================== LEADS IMPORT TEMPLATE ====================","# ","# INSTRUCTIONS:","# 1. Keep the header row (first row with column names) as is","# 2. Start entering your data from row 2 onwards","# 3. Delete all instruction rows (starting with #) before importing","# 4. Delete the sample data rows if not needed","# ","# REQUIRED FIELDS (only 2 fields are mandatory):","#   • Contact Number - Contact number (supports all formats: 10-digit, landline, international - max 50 chars)","#   • Site Name - Must match existing site name exactly (case-sensitive) or will create new site","# ","# RECOMMENDED FIELDS (optional but encouraged for better data quality):","#   • First Name - Highly recommended (backend auto-fills if empty)","#   • Last Name - Highly recommended (backend auto-fills if empty)","# ","# BROKER FIELDS (optional):","#   • Fill if lead came through a broker","#   • Broker Number: Supports all number formats (max 20 chars)","# ","# SITE FIELDS (optional with smart defaults):",'#   • Site Type: Use "RESIDENTIAL", "COMMERCIAL", or "MIXED_USE" (defaults to RESIDENTIAL if empty)','#   • Locality: Area/neighborhood name (e.g., "Baner", "Andheri West")','#   • Site Status: Use "Active", "Under Construction", or "Inactive"','#   • Is Operational: Use "Yes" or "No"',"# ","# LEAD FIELDS (optional with smart defaults):","#   • Lead Name: Auto-generated from contact name + site name if not provided",'#   • Lead Status: Use "NEW", "HOT", "WARM", "COLD", "WON", or "LOST" (defaults to NEW if empty)',"#   • Lead Source: Examples - Website, Walk-in, Broker Reference, Facebook Ad,","#                  Customer Referral, Property Expo, Email Campaign, Newspaper Ad","#   • Date Format: Use YYYY-MM-DD (e.g., 2024-12-25)","#   • Created Date: Defaults to import date if not provided","#   • Lead Closed Date: Only fill for WON or LOST leads",'#   • Lost Reasons: REQUIRED when Lead Status is "LOST" - explain why lead was lost',"# ","# VISITOR REQUIREMENTS:",'#   • Bedrooms: Number of bedrooms (e.g., "2", "3", "4", "4+", "1-2") - leave empty for commercial',"#   • Size (Sq Ft): Area in square feet (numeric, e.g., 1200, 2500)",'#   • View Type: Preference (e.g., "Sea View", "Garden View", "City View", "Lake View")',"#   • Floor Preference: Preferred floor number (numeric, e.g., 5, 12, 20) - leave empty if no preference","#   • Buying Intent: Interest level from 0 (browsing) to 10 (ready to buy) - REQUIRED for active leads",'#   • Direction: Use "North", "South", "East", "West", "NE", "NW", "SE", "SW" or leave empty',"# ","# TIPS:",'#   • Lead Name should be descriptive (e.g., "Rajesh Kumar - 3BHK Inquiry")',"#   • Lead Notes should capture key requirements, preferences, and conversation highlights","#   • Site Description should briefly describe the property type and key features","#   • Leave cells empty if data is not available (except required fields)","#   • For broker-sourced leads, fill broker information fields","# ","# ================================================================",""]}:{headers:C("infrastructure"),sampleData:[["101","1","Tower A","Residential","Sunset Heights","RESIDENTIAL","1200","2BHK","2","North","Sea View","Available","5000000","100","40","50","10"],["201","2","Tower A","Residential","Sunset Heights","RESIDENTIAL","1500","3BHK","3","East","Garden View","Available","7000000","100","40","50","10"],["301","3","Tower B","Commercial","Ocean View","COMMERCIAL","2000","Office","","South","City View","Available","10000000","50","20","25","5"]],instructions:["# INSTRUCTIONS FOR INFRASTRUCTURE UNITS IMPORT","# 1. Fill in the data starting from row 2 (row 1 contains headers)","# 2. Required fields: UnitNumber, FloorNumber, InfraName, SiteName","# 3. SiteType options: RESIDENTIAL, COMMERCIAL, MIXED_USE","# 4. AvailabilityStatus options: Available, Sold, Booked, Hold","# 5. Direction options: North, South, East, West, NE, NW, SE, SW","# 6. All numeric fields should contain numbers only","# 7. Delete these instruction rows before importing",""]},a=new Blob([[...t.instructions,t.headers.join(","),...t.sampleData.map(e=>e.join(","))].join("\n")],{type:"text/csv;charset=utf-8;"}),r=window.URL.createObjectURL(a),l=document.createElement("a");return l.href=r,l.setAttribute("download","".concat(e,"_import_template.csv")),document.body.appendChild(l),l.click(),l.remove(),window.URL.revokeObjectURL(r),{success:!0}}async function E(e){return new Promise((t,a)=>{let r=new FileReader;r.onload=e=>{try{let a=new Uint8Array(e.target.result),r=v.LF(a,{type:"array"}),l=r.SheetNames[0],n=r.Sheets[l],i=v.Wp.sheet_to_json(n,{header:1,defval:""}),s=[];if(i[0]){s=i[0].map((e,t)=>null==e||""===e?"Column_".concat(t+1):String(e).trim());let e=-1;for(let t=s.length-1;t>=0;t--)if(!s[t].startsWith("Column_")){e=t;break}e>=0&&(s=s.slice(0,e+1))}let o=i.slice(1).filter(e=>e.some(e=>null!=e&&""!==e)).map(e=>e.slice(0,s.length));t({headers:s,rows:o})}catch(e){a(Error("Failed to parse Excel file: "+e.message))}},r.onerror=()=>a(Error("Failed to read file")),r.readAsArrayBuffer(e)})}async function k(e,t){try{if(!e)throw Error("No file provided");if(!t)throw Error("No import type selected");let{headers:a,rows:r}=await E(e),l="temp_".concat(Date.now());return S.set(l,{headers:a,rows:r,file:e}),{success:!0,fileId:l,columns:a,message:"File validated successfully"}}catch(e){return{success:!1,error:e.message}}}async function D(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=S.get(e);if(r){let{headers:t,rows:l}=r,n=t,i=l;if(a&&Object.keys(a).length>0){n=[];let e=[];Object.entries(a).forEach(a=>{let[r,l]=a,i=t.indexOf(r);-1!==i&&(n.push(l),e.push(i))}),i=l.map(t=>e.map(e=>void 0!==t[e]?t[e]:""))}return{fileId:e,headers:n,data:{headers:n,rows:i},totalRecords:i.length,errors:[],mappings:a}}try{if(N&&!N.includes("localhost"))return(await g.A.post("".concat(N,"/import/preview/").concat(e),{type:t,mappings:a},{timeout:5e3})).data}catch(e){f.warn("API preview not available, using cached data")}return{fileId:e,headers:[],data:{headers:[],rows:[]},totalRecords:0,errors:["No preview data available. Please re-upload the file."],mappings:a}}async function L(e,t,a,r,l){let n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,i=async()=>{let l=new FormData,i={mapping:a||{}},s={leads:"lead",infrastructure:"infrastructure_units"}[t]||t;f.group("API CALL DEBUG INFO"),f.log("1. Type ID:",t),f.log("2. Model Name:",s),f.log("3. Column Mappings from UI:",a),f.log("4. Final Mapping Payload:",JSON.stringify(i,null,2)),f.log("5. File Details:",{name:e.name,size:e.size,type:e.type}),f.log("6. FormData contents:"),f.log("   - model_name:",s),f.log("   - column_mapping:",JSON.stringify(i)),f.log("   - file:",e.name),f.log("7. API Endpoint:","/Employee/upload_excel2/"),f.log("8. Base URL:",j.P.serverUrl),f.groupEnd(),l.append("model_name",s),l.append("column_mapping",JSON.stringify(i)),l.append("file",e);let o={headers:{"Content-Type":"multipart/form-data"},timeout:6e4,onUploadProgress:e=>{let t=Math.round(100*e.loaded/e.total);f.debug("Upload progress:",t),r&&"function"==typeof r&&r(t)}};return n&&(o.signal=n.signal),await (0,y.D5)(["/Employee/upload_excel2/",l,o])};try{let e=await A(i,{maxRetries:3,initialDelay:2e3,maxDelay:1e4,shouldRetry:I,onRetry:e=>{r&&r(0),l&&l(e),f.warn("Retrying upload: Attempt ".concat(e.attempt,"/").concat(e.maxRetries))}});return f.group("API RESPONSE DEBUG"),f.log("Response status:",e.status),f.log("Response data:",e.data),f.groupEnd(),{success:!0,data:e.data,message:"File uploaded and processed successfully"}}catch(e){var s,o,d,c,u,p;if(f.group("API ERROR DEBUG"),f.error("Error type:",e.name),f.error("Error message:",e.message),f.error("Full error object:",e),e.response){f.error("Server Error Response:"),f.error("  Status:",e.response.status),f.error("  Status Text:",e.response.statusText),f.error("  Response Data:",e.response.data),f.error("  Response Headers:",e.response.headers);let t="Server error occurred";return 401===e.response.status?t="Authentication failed. Please log in again.":403===e.response.status?t="You do not have permission to perform this action.":400===e.response.status?t=(null==(d=e.response.data)?void 0:d.detail)||(null==(c=e.response.data)?void 0:c.message)||"Invalid data provided":500===e.response.status?t="Internal server error. Please try again later.":(null==(s=e.response.data)?void 0:s.detail)?t=e.response.data.detail:(null==(o=e.response.data)?void 0:o.message)&&(t=e.response.data.message),f.groupEnd(),{success:!1,error:t,details:e.response.data,statusCode:e.response.status}}if(e.request)return f.error("No Response - Request Details:"),f.error("  Request:",e.request),f.error("  Config URL:",null==(u=e.config)?void 0:u.url),f.error("  Config BaseURL:",null==(p=e.config)?void 0:p.baseURL),f.groupEnd(),{success:!1,error:"No response from server. Please check your connection and server status."};return f.error("Request Setup Error:",e),f.error("  Config:",e.config),f.groupEnd(),{success:!1,error:e.message||"Failed to upload file"}}}async function F(e,t,a,r,l,n){let i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;f.group("IMPORT DATA CALLED"),f.log("FileId:",e),f.log("TypeId:",t),f.log("Column Mappings:",a),f.log("File:",r?{name:r.name,size:r.size}:"No file"),f.groupEnd();let s=r;if(!s){let t=S.get(e);t&&(s=t.file,f.log("Retrieved file from cache:",s?s.name:"Not found"))}if(!s)return f.error("ERROR: File data lost!"),{success:!1,error:"File data lost. Please restart the import process."};try{let r=await L(s,t,a,l,n,i);if(r.success){var o,d,c,u,p,h,m,x,g,v,y,j,b,w,C,A,I;f.group("IMPORT SUCCESS"),f.log("Full Result data:",JSON.stringify(r.data,null,2)),f.log("Available keys:",Object.keys(r.data||{}));let t=(null==(o=r.data)?void 0:o.rows_inserted)||(null==(d=r.data)?void 0:d.processed)||(null==(c=r.data)?void 0:c.success_count)||(null==(u=r.data)?void 0:u.successCount)||(null==(p=r.data)?void 0:p.total_records)||(null==(h=r.data)?void 0:h.records_count)||(null==(m=r.data)?void 0:m.count)||(null==(x=r.data)?void 0:x.inserted)||(null==(g=r.data)?void 0:g.created)||0,a=(null==(v=r.data)?void 0:v.failed)||(null==(y=r.data)?void 0:y.failed_count)||(null==(j=r.data)?void 0:j.failedCount)||(null==(b=r.data)?void 0:b.errors_count)||(null==(w=r.data)?void 0:w.error_count)||0;return f.log("Success Count:",t),f.log("Failed Count:",a),f.groupEnd(),S.delete(e),f.log("Cleared cached data for fileId:",e),{success:!0,successCount:t,failedCount:a,summary:(null==(C=r.data)?void 0:C.summary)||(null==(A=r.data)?void 0:A.message)||"Import completed",errors:(null==(I=r.data)?void 0:I.errors)||[]}}return f.group("IMPORT FAILED"),f.error("Result:",r),f.groupEnd(),S.delete(e),r}catch(t){throw S.delete(e),f.group("IMPORT ERROR"),f.error("Error:",t),f.groupEnd(),t}}var T=a(82200),M=a(83469),O=a(69889),B=a(29620);let z=["Select Type","Upload File","Map Columns","Review Data","Complete"],U=[{id:"leads",title:"Leads Data",icon:O.A,color:"primary",description:"Import customer leads with contact information and site details",requiredFields:["ContactNo","SiteName"],optionalFields:["ContactFName","ContactLName","BrokerFName","BrokerLName","BrokerNo","SiteCity","SiteAddress","SiteType","Locality","SiteStatus","SiteDescription","IsOperational","LeadName","CreatedDate","LeadClosedDate","LeadStatus","LeadSource","LeadNotes","LostReasons","Bedrooms","SizeSqFt","ViewType","FloorPreference","BuyingIntent","Direction"],fieldGroups:{"Contact Fields":["ContactFName","ContactLName","ContactNo"],"Broker Fields":["BrokerFName","BrokerLName","BrokerNo"],"Site Fields":["SiteName","SiteCity","SiteAddress","SiteType","Locality","SiteStatus","SiteDescription","IsOperational"],"Lead Fields":["LeadName","CreatedDate","LeadClosedDate","LeadStatus","LeadSource","LeadNotes","LostReasons"],Requirements:["Bedrooms","SizeSqFt","ViewType","FloorPreference","Direction","BuyingIntent"]},note:"Only ContactNo and SiteName are required. ContactNo supports all formats (max 50 chars). SiteType defaults to RESIDENTIAL. BuyingIntent: 0-10 scale.",templateFileName:"leads_import_template.xlsx"},{id:"infrastructure",title:"Infrastructure Units",icon:B.A,color:"success",description:"Import infrastructure units with site and unit specifications",requiredFields:["UnitNumber","FloorNumber","InfraName","InfraCategory","TotalUnits","AvailableUnits","SoldUnits","BookedUnits","InfraFloorCount","SiteName","SiteType"],optionalFields:["UnitSize","AvailabilityStatus","Direction","UnitType","View","PurchaseReason","InfraDescription","InfraAmenities","SiteCity","SiteAddress","SiteStatus","SiteSizeSqFt","OperationalDate","IsOperational","SiteDescription","NearbyLandmarks"],fieldGroups:{"Unit Fields":["UnitSize","AvailabilityStatus","Direction","UnitType","View","PurchaseReason"],"Infrastructure Fields":["InfraDescription","InfraAmenities"],"Site Fields":["SiteCity","SiteAddress","SiteStatus","SiteSizeSqFt","OperationalDate","IsOperational","SiteDescription","NearbyLandmarks"]},note:"SiteType must be: RESIDENTIAL, COMMERCIAL, or MIXED_USE",templateFileName:"infrastructure_import_template.xlsx"}],W=["File format: .xlsx (Excel 2007+ format) only","File size limit: ".concat(10,"MB"),"Maximum ".concat(1e3," rows per import"),"First row should contain column headers","Date format: MM/DD/YYYY"],q=[...W,"Required fields: ContactNo (supports all formats, max 50 chars) and SiteName only","SiteName must match existing sites exactly or will create new site record","ContactFName/ContactLName: Recommended for better data quality (backend auto-fills if empty)","SiteType: RESIDENTIAL (default), COMMERCIAL, or MIXED_USE","BuyingIntent: Numeric value from 0 (no interest) to 10 (ready to buy)","Direction: North, South, East, West, NE, NW, SE, SW","LeadStatus: NEW (default), HOT, WARM, COLD, WON, LOST","LostReasons: Required when LeadStatus is LOST","LeadName: Auto-generated from name + site if not provided","All 27 backend fields are supported for import"],P=[...W,"For infrastructure: SiteType must be RESIDENTIAL, COMMERCIAL, or MIXED_USE","Unit specifications will be validated against site requirements"];class G{static async validateExcelFile(e){let t=[];if(!e)return t.push("No file provided"),{valid:!1,errors:t};0===e.size&&t.push("File is empty"),e.size>0xa00000&&t.push("File size exceeds ".concat(10,"MB limit")),e.name.toLowerCase().endsWith(".xlsx")||t.push("File must have .xlsx extension"),e.type&&""!==e.type&&!["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","application/octet-stream"].includes(e.type)&&t.push("Invalid MIME type: ".concat(e.type,". Expected Excel file format."));try{let a=await e.slice(0,4).arrayBuffer(),r=new Uint8Array(a),l=this.XLSX_SIGNATURE.every((e,t)=>r[t]===e),n=this.XLS_SIGNATURE.every((e,t)=>r[t]===e);l||n||t.push("File content does not match Excel format (invalid file signature)"),n&&t.push("Old Excel format (.xls) not supported. Please save as .xlsx format (Excel 2007+)")}catch(e){f.error("Magic bytes check failed:",e),t.push("Could not validate file content")}if(0===t.length)try{let a=await e.arrayBuffer(),r=v.LF(a,{type:"array"});if(r.SheetNames&&0!==r.SheetNames.length){let e=r.Sheets[r.SheetNames[0]],a=v.Wp.decode_range(e["!ref"]||"A1");0===a.e.r&&0===a.e.c&&t.push("Excel file appears to have no data");let l=a.e.r+1;l>1e4&&t.push("File contains ".concat(l," rows. Maximum 10000 rows allowed for performance reasons."));let n=a.e.c+1;n>100&&t.push("File contains ".concat(n," columns. Maximum 100 columns allowed."))}else t.push("Excel file contains no sheets")}catch(e){t.push("File is corrupted or not a valid Excel file: "+e.message)}return{valid:0===t.length,errors:t}}static async validateFileContent(e){try{let t=await e.arrayBuffer(),a=v.LF(t,{type:"array"});for(let e of a.SheetNames){let t=a.Sheets[e];for(let e of v.Wp.sheet_to_json(t,{header:1,raw:!1}))for(let t of e)if("string"==typeof t){if(/<script|javascript:|on\w+=/i.test(t))return{valid:!1,error:"File contains potentially malicious content"};if(/^[=+\-@]/.test(t.trim()))return{valid:!1,error:"File contains formulas that could be dangerous. Please remove all formulas."}}}return{valid:!0}}catch(e){return{valid:!1,error:"Could not validate file content: "+e.message}}}static async getFileMetadata(e){try{let t=await e.arrayBuffer(),a=v.LF(t,{type:"array"}),r={fileName:e.name,fileSize:e.size,fileSizeMB:(e.size/1048576).toFixed(2),lastModified:new Date(e.lastModified).toLocaleString(),sheets:a.SheetNames.length,sheetNames:a.SheetNames};if(a.SheetNames.length>0){let e=a.Sheets[a.SheetNames[0]],t=v.Wp.decode_range(e["!ref"]||"A1");r.rows=t.e.r+1,r.columns=t.e.c+1}return r}catch(e){return null}}}G.XLSX_SIGNATURE=[80,75,3,4],G.XLS_SIGNATURE=[208,207,17,224];var _=a(38637),H=a.n(_),V=a(11654),Y=a(61675),K=a(9670),X=a(66292),$=a(7433),Q=a(40001),J=a(40218),Z=a(38867);function ee(e){let{selectedType:t,uploadedFile:a,isProcessing:l,onFileSelect:n,onBack:d,importNotes:c}=e;return(0,r.jsxs)(i.A,{spacing:3,children:[(0,r.jsx)(s.A,{children:(0,r.jsxs)(o.A,{sx:{p:3},children:[(0,r.jsxs)(i.A,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{mb:3},children:[(0,r.jsxs)(K.default,{variant:"h6",children:["Upload ",null==t?void 0:t.title," File"]}),(0,r.jsx)(X.default,{variant:"outlined",onClick:d,startIcon:(0,r.jsx)(Z.W,{icon:"eva:arrow-back-fill"}),disabled:l,children:"Back"})]}),(0,r.jsx)(J._O,{accept:{"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"]},maxSize:0xa00000,onDrop:e=>{let t=null==e?void 0:e[0];t&&n(t)},helperText:(0,r.jsxs)(i.A,{spacing:1,sx:{mt:2},children:[(0,r.jsx)(K.default,{variant:"caption",sx:{color:"text.secondary"},children:"Allowed format: .xlsx (Excel 2007+ format)"}),(0,r.jsxs)(K.default,{variant:"caption",sx:{color:"text.secondary"},children:["Max size: ",10,"MB"]})]})}),a&&(0,r.jsxs)(o.A,{sx:{mt:3},children:[(0,r.jsxs)(i.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,r.jsx)(Z.W,{icon:"eva:file-text-fill",width:24}),(0,r.jsx)(K.default,{variant:"body2",children:a.name})]}),l&&(0,r.jsx)($.A,{sx:{mt:2}})]})]})}),(0,r.jsxs)(Q.default,{severity:"warning",icon:(0,r.jsx)(Y.A,{}),sx:e=>({border:"1px solid ".concat((0,V.IG)(e.vars.palette.warning.mainChannel,.24)),bgcolor:(0,V.IG)(e.vars.palette.warning.mainChannel,.08)}),children:[(0,r.jsx)(K.default,{variant:"subtitle2",fontWeight:600,gutterBottom:!0,children:"Important Notes:"}),(0,r.jsx)(o.A,{component:"ul",sx:{m:0,pl:2},children:c.map((e,t)=>(0,r.jsx)("li",{children:(0,r.jsx)(K.default,{variant:"caption",children:e})},t))})]})]})}ee.propTypes={selectedType:H().object,uploadedFile:H().object,isProcessing:H().bool,onFileSelect:H().func.isRequired,onBack:H().func.isRequired,importNotes:H().arrayOf(H().string).isRequired};var et=a(35695);function ea(e){let{importResult:t,onReset:a,onBack:l}=e,n=(0,et.useRouter)();return(0,r.jsx)(s.A,{children:(0,r.jsxs)(o.A,{sx:{p:6,textAlign:"center"},children:[(0,r.jsx)(o.A,{sx:e=>({width:80,height:80,margin:"0 auto",display:"flex",borderRadius:"50%",alignItems:"center",justifyContent:"center",bgcolor:(0,V.IG)(e.vars.palette.success.mainChannel,.08),mb:3}),children:(0,r.jsx)(Z.W,{icon:"eva:checkmark-circle-2-fill",width:48,sx:{color:"success.main"}})}),(0,r.jsx)(K.default,{variant:"h5",gutterBottom:!0,children:"Import Complete!"}),(0,r.jsxs)(K.default,{variant:"body2",color:"text.secondary",sx:{mb:4},children:["Successfully imported"," ",(0,r.jsx)(o.A,{component:"span",sx:{fontWeight:600},children:(null==t?void 0:t.successCount)||0})," ","records",(null==t?void 0:t.failedCount)>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("br",{}),(0,r.jsxs)(o.A,{component:"span",sx:{color:"error.main"},children:[t.failedCount," records failed to import"]})]})]}),(null==t?void 0:t.summary)&&(0,r.jsx)(o.A,{sx:e=>({mb:4,p:2,bgcolor:(0,V.IG)(e.vars.palette.grey["500Channel"],.04),border:"1px dashed ".concat((0,V.IG)(e.vars.palette.grey["500Channel"],.16)),borderRadius:1}),children:(0,r.jsx)(K.default,{variant:"caption",sx:{whiteSpace:"pre-line"},children:t.summary})}),(0,r.jsxs)(i.A,{direction:"row",spacing:2,justifyContent:"center",children:[(0,r.jsx)(X.default,{variant:"outlined",size:"small",onClick:l,startIcon:(0,r.jsx)(Z.W,{icon:"eva:arrow-back-fill"}),children:"Back"}),(0,r.jsx)(X.default,{variant:"outlined",size:"small",onClick:a,children:"Import More Data"}),(0,r.jsx)(X.default,{variant:"contained",size:"small",onClick:()=>{n.push(p.f.dashboard.importHistory)},children:"View Import History"})]})]})})}ea.propTypes={importResult:H().shape({type:H().string,successCount:H().number,failedCount:H().number,summary:H().string}),onReset:H().func.isRequired,onBack:H().func.isRequired};var er=a(83965),el=a(30821),en=a(8542),ei=a(28566),es=a(83339),eo=a(91580),ed=a(20837);let ec=n.memo(e=>{let{type:t,isSelected:a,onSelect:l,onDownloadTemplate:d}=e,c=t.icon,[u,p]=(0,n.useState)(!1);return(0,r.jsx)(s.A,{sx:e=>({cursor:"pointer",position:"relative",height:"100%",display:"flex",flexDirection:"column",transition:"all 0.2s ease",border:"1px solid ".concat(a?e.palette[t.color].main:(0,V.IG)(e.vars.palette.grey["500Channel"],.16)),"&:hover":{bgcolor:(0,V.IG)(e.vars.palette.grey["500Channel"],.04)},...a&&{bgcolor:(0,V.IG)(e.vars.palette[t.color].mainChannel,.08),boxShadow:"0 0 0 2px ".concat((0,V.IG)(e.vars.palette[t.color].mainChannel,.24))}}),onClick:()=>l(t),children:(0,r.jsxs)(es.A,{sx:{p:2.5,height:"100%",display:"flex",flexDirection:"column"},children:[(0,r.jsxs)(i.A,{direction:"row",spacing:2,alignItems:"flex-start",mb:1.5,children:[(0,r.jsx)(o.A,{sx:e=>({width:40,height:40,borderRadius:"50%",bgcolor:(0,V.IG)(e.vars.palette[t.color].mainChannel,.12),display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0}),children:(0,r.jsx)(c,{sx:{fontSize:24,color:"".concat(t.color,".main")}})}),(0,r.jsxs)(o.A,{sx:{minWidth:0},children:[(0,r.jsx)(K.default,{variant:"h6",component:"h3",fontWeight:600,sx:{fontSize:"1rem"},children:t.title}),(0,r.jsx)(K.default,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.75rem"},children:t.description})]})]}),(0,r.jsxs)(i.A,{spacing:1.5,sx:{flexGrow:1},children:[(0,r.jsxs)(o.A,{children:[(0,r.jsxs)(K.default,{variant:"subtitle2",fontWeight:600,sx:{fontSize:"0.8125rem",mb:.5},children:["Required fields (",t.requiredFields.length,"):"]}),(0,r.jsx)(o.A,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:t.requiredFields.map(e=>(0,r.jsx)(eo.default,{label:e,size:"small",sx:{height:20,fontSize:"0.65rem","& .MuiChip-label":{px:1}},color:"primary",variant:"outlined"},e))})]}),(0,r.jsxs)(o.A,{children:[(0,r.jsxs)(i.A,{direction:"row",alignItems:"center",spacing:1,sx:{mb:.5},children:[(0,r.jsxs)(K.default,{variant:"subtitle2",fontWeight:600,sx:{fontSize:"0.8125rem"},children:["Optional fields (",t.optionalFields.length,")"]}),(0,r.jsx)(X.default,{size:"small",onClick:e=>{e.stopPropagation(),p(!u)},endIcon:u?(0,r.jsx)(er.A,{}):(0,r.jsx)(el.A,{}),sx:{fontSize:"0.7rem",py:0,px:1,minHeight:20,textTransform:"none"},children:u?"Show less":"Show all"})]}),u?(0,r.jsx)(ed.A,{in:u,children:t.fieldGroups?(0,r.jsx)(i.A,{spacing:1,sx:{mt:1},children:Object.entries(t.fieldGroups).map(e=>{let[t,a]=e;return(0,r.jsxs)(o.A,{children:[(0,r.jsxs)(K.default,{variant:"caption",sx:{fontWeight:600,fontSize:"0.7rem",color:"text.secondary",display:"block",mb:.5},children:[t,":"]}),(0,r.jsx)(o.A,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:a.map(e=>(0,r.jsx)(eo.default,{label:e,size:"small",sx:{height:18,fontSize:"0.6rem","& .MuiChip-label":{px:.75}},variant:"outlined"},e))})]},t)})}):(0,r.jsx)(o.A,{sx:{display:"flex",flexWrap:"wrap",gap:.5,mt:1},children:t.optionalFields.map(e=>(0,r.jsx)(eo.default,{label:e,size:"small",sx:{height:18,fontSize:"0.6rem","& .MuiChip-label":{px:.75}},variant:"outlined"},e))})}):t.fieldGroups?(0,r.jsx)(i.A,{spacing:.25,children:Object.entries(t.fieldGroups).map(e=>{let[t,a]=e;return(0,r.jsxs)(K.default,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.7rem"},children:["• ",t," (",a.length," fields)"]},t)})}):(0,r.jsxs)(K.default,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.7rem"},children:[t.optionalFields.length," optional fields available"]})]})]}),(0,r.jsx)(Q.default,{severity:"info",icon:(0,r.jsx)(en.A,{sx:{fontSize:"1rem"}}),sx:e=>({mt:2,py:.5,px:1.5,"& .MuiAlert-icon":{color:e.palette[t.color].main,py:.5},"& .MuiAlert-message":{py:.5},bgcolor:(0,V.IG)(e.vars.palette[t.color].mainChannel,.08),border:"1px solid ".concat((0,V.IG)(e.vars.palette[t.color].mainChannel,.24))}),children:(0,r.jsxs)(K.default,{variant:"caption",sx:{fontSize:"0.7rem"},children:[(0,r.jsx)(o.A,{component:"span",sx:{fontWeight:600},children:"Note:"})," ",t.note]})}),(0,r.jsx)(X.default,{variant:"text",size:"small",startIcon:(0,r.jsx)(ei.A,{sx:{fontSize:"1rem"}}),onClick:e=>d(e,t.id),sx:{mt:1.5,textTransform:"none",fontSize:"0.8125rem",py:.5},children:"Download Template"})]})})});ec.displayName="ImportTypeCard",ec.propTypes={type:H().shape({id:H().string.isRequired,title:H().string.isRequired,icon:H().elementType.isRequired,color:H().string.isRequired,description:H().string.isRequired,requiredFields:H().arrayOf(H().string).isRequired,optionalFields:H().arrayOf(H().string).isRequired,fieldGroups:H().objectOf(H().arrayOf(H().string)),note:H().string.isRequired}).isRequired,isSelected:H().bool.isRequired,onSelect:H().func.isRequired,onDownloadTemplate:H().func.isRequired};var eu=a(3951);function ep(e){let{selectedType:t,onTypeSelect:a,onDownloadTemplate:l}=e,i=(0,et.useRouter)(),[s,d]=(0,n.useState)(!1),c=(0,n.useMemo)(()=>Math.floor(4*Math.random()),[]);return(0,r.jsxs)(r.Fragment,{children:[s&&(0,r.jsx)($.A,{sx:{position:"fixed",top:0,left:0,right:0,zIndex:9999}}),(0,r.jsxs)(o.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[(0,r.jsx)(K.default,{variant:"h5",sx:{fontWeight:600},children:"Select Data Type to Import"}),(0,r.jsxs)(X.default,{variant:"outlined",color:"inherit",startIcon:(0,r.jsx)(Z.W,{icon:"solar:history-bold"}),onClick:()=>{d(!0),i.push(p.f.dashboard.importHistory)},disabled:s,sx:{gap:.5},children:[s?"Loading...":"View Import History",!s&&c>0&&(0,r.jsx)(eo.default,{size:"small",label:c,color:"info",sx:{ml:1,height:20,minWidth:20}})]})]}),(0,r.jsx)(eu.Ay,{container:!0,spacing:3,children:U.map(e=>(0,r.jsx)(eu.Ay,{item:!0,xs:12,md:6,children:(0,r.jsx)(ec,{type:e,isSelected:(null==t?void 0:t.id)===e.id,onSelect:a,onDownloadTemplate:l})},e.id))})]})}ep.propTypes={selectedType:H().object,onTypeSelect:H().func.isRequired,onDownloadTemplate:H().func.isRequired};var eh=a(36812),em=a(68074),ef=a(66392),ex=a(26348),eg=a(99662),ev=a(99180),ey=a(50953),ej=a(1384),eb=a(15843),eS=a(18478),ew=a(59869),eC=a(92223),eA=a(13051),eI=a(35710),eN=a(51528),eR=a(53494),eE=a(12070),ek=a(78822),eD=a(15930),eL=a(80158),eF=a(66587),eT=a(2360),eM=a(55592),eO=a(34152),eB=a(29716),ez=a(62966),eU=a(12422),eW=a(95946),eq=a(77498),eP=a(78880),eG=a(26403),e_=a(54102),eH=a(59886),eV=a(96358),eY=a(69004),eK=a(10822);let eX={ALLOWED_TAGS:[],ALLOWED_ATTR:[],KEEP_CONTENT:!0};function e$(e){return null==e?"":"string"==typeof e?eK.A.sanitize(e,eX):e}function eQ(e){return e.map(e=>e.map(e=>e$(e)))}function eJ(e){let t={};return e.forEach(e=>{t[e]=(t[e]||0)+1}),Object.keys(t).reduce((e,a)=>t[e]>t[a]?e:a)}function eZ(e){return({high:"success",medium:"warning",low:"error"})[e]||"default"}function e0(e){var t,a,d,c;let{previewData:u,sampleData:p,columnMappings:h,isLoading:m,uploadProgress:x,retryStatus:g,onBack:v,onImport:y,onDataEdit:j}=e,[b,S]=(0,n.useState)(!1),[w,C]=(0,n.useState)({}),[A,I]=(0,n.useState)(!1),[N,R]=(0,n.useState)(null),[E,k]=(0,n.useState)(null),[D,L]=(0,n.useState)(!1),[F,T]=(0,n.useState)({page:0,pageSize:100}),[M,O]=(0,n.useState)([]),[B,z]=(0,n.useState)([]),[U,W]=(0,n.useState)(!1),[q,P]=(0,n.useState)(!1),[G,_]=(0,n.useState)(!1),[H,Y]=(0,n.useState)(""),[J,ee]=(0,n.useState)(""),[et,ea]=(0,n.useState)(!1),[er,el]=(0,n.useState)(!1),[en,ei]=(0,n.useState)("all"),[es,ec]=(0,n.useState)([]),[eu,ep]=(0,n.useState)(""),[eK,eX]=(0,n.useState)(""),[e0,e1]=(0,n.useState)("set"),[e2,e5]=(0,n.useState)([]),[e3,e4]=(0,n.useState)(null),[e6,e8]=(0,n.useState)(null);n.useEffect(()=>{var e,t;((null==u||null==(e=u.data)?void 0:e.rows)||(null==u?void 0:u.rows))&&R(eQ((null==u||null==(t=u.data)?void 0:t.rows)||(null==u?void 0:u.rows)).map(e=>[...e]))},[u]),n.useEffect(()=>{var e,t,a,r;((null==u||null==(e=u.data)?void 0:e.rows)||(null==u?void 0:u.rows))&&((null==u||null==(t=u.data)?void 0:t.headers)||(null==u?void 0:u.headers))&&k(function(e,t){if(!e||!t||0===e.length)return{overallQuality:"low",averageCompleteness:0,totalIssues:0,columnMetrics:{},recommendations:[]};let a={},r=0,l=0,n=[];t.forEach((t,i)=>{let s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(!e||0===e.length)return{completeness:0,uniqueness:0,validity:0,consistency:0,quality:"low",totalRows:0,emptyCount:0,duplicateCount:0,issues:[],dataType:"unknown"};let a=e.length,r=e.filter(e=>null!=e&&""!==String(e).trim()),l=a-r.length,n=new Set(r.map(e=>String(e).toLowerCase().trim())),i=r.length-n.size,s=function(e){if(0===e.length)return"unknown";let t=e.slice(0,10).map(e=>String(e)),a=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;if(t.every(e=>a.test(e)))return"email";let r=/^[\d\s\-+()]+$/;if(t.every(e=>r.test(e)&&e.replace(/\D/g,"").length>=10))return"phone";let l=/^\d{1,4}[-/]\d{1,2}[-/]\d{1,4}$/;if(t.some(e=>l.test(e)||!isNaN(Date.parse(e))))return"date";if(t.every(e=>!isNaN(e)&&!isNaN(parseFloat(e))))return"number";let n=/^[₹$€£¥]\s?[\d,]+\.?\d*$/;if(t.some(e=>n.test(e)))return"currency";let i=["true","false","yes","no","0","1","y","n"];return t.every(e=>i.includes(e.toLowerCase()))?"boolean":"text"}(r),o=function(e,t,a){if(0===e.length)return{validity:100,invalidCount:0};let r=0,l={email:e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e),phone:e=>{let t=e.replace(/\D/g,"");return t.length>=10&&t.length<=15},date:e=>!isNaN(Date.parse(e)),number:e=>!isNaN(e)&&!isNaN(parseFloat(e)),currency:e=>/^[₹$€£¥]?\s?[\d,]+\.?\d*$/.test(e),boolean:e=>["true","false","yes","no","0","1","y","n"].includes(e.toLowerCase()),text:()=>!0},n=l[t]||l.text;return e.forEach(e=>{n(String(e))&&r++}),{validity:r/e.length*100,invalidCount:e.length-r}}(r,s,0),d=function(e,t){if(e.length<=1)return 100;let a={phone:e=>{let t=e.map(e=>e.replace(/\d/g,"X")),a=eJ(t);return t.filter(e=>e===a).length/t.length*100},date:e=>{let t=e.map(e=>(function(e){let t=String(e);return/^\d{4}-\d{2}-\d{2}/.test(t)?"YYYY-MM-DD":/^\d{2}\/\d{2}\/\d{4}/.test(t)?"MM/DD/YYYY":/^\d{2}-\d{2}-\d{4}/.test(t)?"DD-MM-YYYY":"other"})(e)),a=eJ(t);return t.filter(e=>e===a).length/t.length*100},text:e=>{let t=e.map(e=>{let t=String(e);return t===t.toUpperCase()?"upper":t===t.toLowerCase()?"lower":t[0]===t[0].toUpperCase()?"title":"mixed"}),a=eJ(t);return t.filter(e=>e===a).length/t.length*100}}[t];return a?a(e.map(e=>String(e))):100}(r,s),c=(a-l)/a*100,u=r.length>0?n.size/r.length*100:100,p="high",h=[];return c<80&&(p=c<50?"low":"medium",h.push("".concat(l," empty cells (").concat((100-c).toFixed(1),"%)"))),i>.3*a&&!["status","type","category"].some(e=>t.toLowerCase().includes(e))&&(p=Math.min("high"===p?"medium":p,"medium"),h.push("".concat(i," duplicate values"))),o.invalidCount>0&&(p=o.invalidCount>.1*a?"low":"medium",h.push("".concat(o.invalidCount," invalid ").concat(s," values"))),{completeness:c.toFixed(1),uniqueness:u.toFixed(1),validity:o.validity.toFixed(1),consistency:d.toFixed(1),quality:p,totalRows:a,emptyCount:l,duplicateCount:i,invalidCount:o.invalidCount,issues:h,dataType:s,samples:r.slice(0,3).map(e=>String(e))}}(e.map(e=>e[i]),t);a[t]=s,r+=parseFloat(s.completeness),l+=s.issues.length,"low"===s.quality&&(s.emptyCount>.5*e.length?n.push('Column "'.concat(t,'" is mostly empty. Consider removing or filling required values.')):s.invalidCount>0&&n.push('Column "'.concat(t,'" has ').concat(s.invalidCount," invalid ").concat(s.dataType," values that need correction.")))});let i=r/t.length;return{overallQuality:i>=90?"high":i>=70?"medium":"low",averageCompleteness:i.toFixed(1),totalIssues:l,columnMetrics:a,recommendations:n}}((null==u||null==(a=u.data)?void 0:a.rows)||(null==u?void 0:u.rows),(null==u||null==(r=u.data)?void 0:r.headers)||(null==u?void 0:u.headers)))},[u]);let e7=(0,n.useCallback)(e=>{N&&(O(t=>[...t,{data:N.map(e=>[...e]),description:e,editedRows:{...w}}].slice(-50)),z([]))},[N,w]),e9=(0,n.useCallback)(()=>{if(M.length>0){let e=M[M.length-1];z(e=>[...e,{data:N.map(e=>[...e]),editedRows:{...w}}]),R(e.data),C(e.editedRows),O(e=>e.slice(0,-1)),I(!0),l.oR.info("Undone: ".concat(e.description))}},[M,N,w]),te=(0,n.useCallback)(()=>{if(B.length>0){let e=B[B.length-1];e7("Redo"),R(e.data),C(e.editedRows),z(e=>e.slice(0,-1)),I(!0),l.oR.info("Redo applied")}},[B,e7]),tt=(0,n.useCallback)((e,t)=>{e7("Cell edit");let a=e.id,r={};return Object.keys(e).forEach(a=>{"id"!==a&&e[a]!==t[a]&&(r[a]=!0)}),Object.keys(r).length>0&&(C(e=>({...e,[a]:{...e[a],...r}})),I(!0),R(t=>{var r;let l=[...t];return((null==u||null==(r=u.data)?void 0:r.headers)||(null==u?void 0:u.headers)).forEach((t,r)=>{void 0!==e["col_".concat(r)]&&(l[a][r]=e["col_".concat(r)])}),l})),e},[u,e7]),ta=(0,n.useCallback)(()=>{var e;let t=Array(((null==u||null==(e=u.data)?void 0:e.headers)||(null==u?void 0:u.headers)).length).fill("");e7("Add new row"),R(e=>[...e,t]),I(!0),_(!1),l.oR.success("New row added")},[u,e7]),tr=(0,n.useMemo)(()=>{var e;let t=(null==u||null==(e=u.data)?void 0:e.headers)||(null==u?void 0:u.headers);return t?t.map((e,t)=>({field:"col_".concat(t),headerName:e$(e),flex:1,minWidth:150,headerAlign:"center",align:"center",editable:b,renderHeader:e=>(0,r.jsxs)(i.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,r.jsx)(K.default,{variant:"body2",children:e$(e.colDef.headerName)}),b&&(0,r.jsx)(eR.default,{size:"small",onClick:t=>{e8(e.field),e4(t.currentTarget)},sx:{p:.5},children:(0,r.jsx)(ef.A,{fontSize:"small"})})]}),renderCell:e=>{var t;let a=null==(t=w[e.row.id])?void 0:t[e.field];return(0,r.jsxs)(o.A,{sx:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:[e$(e.value),a&&(0,r.jsx)(eo.default,{icon:(0,r.jsx)(ex.A,{}),size:"small",color:"success",sx:{position:"absolute",right:2,height:16,"& .MuiChip-icon":{fontSize:12}}})]})}})):[]},[null==u||null==(t=u.data)?void 0:t.headers,null==u?void 0:u.headers,b,w]);(0,n.useEffect)(()=>{var e;if(!H||!U)return void ec([]);let t=N||(null==u||null==(e=u.data)?void 0:e.rows)||(null==u?void 0:u.rows);if(!t)return;let a=[];t.forEach((e,t)=>{e.forEach((e,r)=>{let l="col_".concat(r);if("all"!==en&&en!==l)return;let n=String(e||""),i=!1;if(er?new RegExp("\\b".concat(H.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"\\b"),et?"":"i").test(n):et?n.includes(H):n.toLowerCase().includes(H.toLowerCase())){var s;a.push({row:t,col:r,value:n,columnName:(null==(s=tr[r])?void 0:s.headerName)||"Column ".concat(r+1)})}})}),ec(a)},[H,et,er,en,tr,N,u,U]),(0,n.useEffect)(()=>{var e;if(!eu||!q)return void e5([]);let t=N||(null==u||null==(e=u.data)?void 0:e.rows)||(null==u?void 0:u.rows);if(!t)return;let a=parseInt(eu.replace("col_","")),r=[];t.forEach((e,t)=>{if(r.length>=5)return;let l=e[a],n=l;switch(e0){case"set":n=eK;break;case"append":n=(l||"")+eK;break;case"prepend":n=eK+(l||"");break;case"clear":n="";break;case"uppercase":n=String(l||"").toUpperCase();break;case"lowercase":n=String(l||"").toLowerCase();break;case"trim":n=String(l||"").trim();break;case"capitalize":n=String(l||"").replace(/\b\w/g,e=>e.toUpperCase())}String(l)!==String(n)&&r.push({row:t,oldValue:String(l||""),newValue:String(n||"")})}),e5(r)},[eu,eK,e0,N,u,q]);let tl=(0,n.useCallback)(()=>{if(!H)return void l.oR.warning("Please enter a value to find");e7("Find and replace: ".concat(H," → ").concat(J));let e=0;R(t=>t.map((t,a)=>t.map((t,a)=>{if("all"!==en&&en!=="col_".concat(a))return t;let r=String(t||""),l=!1;if(er){let t=new RegExp("\\b".concat(H.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"\\b"),et?"g":"gi");if(t.test(r))return e++,r.replace(t,J)}else if(et){if(r.includes(H))return e++,r.replaceAll(H,J)}else{let t=RegExp(H.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi");if(t.test(r))return e++,r.replace(t,J)}return t}))),e>0?(I(!0),l.oR.success("Replaced ".concat(e," occurrences"))):l.oR.info("No matches found"),W(!1),ec([])},[H,J,et,er,en,e7]),tn=(0,n.useCallback)(()=>{if(!eu)return void l.oR.warning("Please select a column");e7("Bulk edit column: ".concat(eu));let e=parseInt(eu.replace("col_","")),t=0;R(a=>a.map((a,r)=>{let l=[...a];switch(e0){case"set":l[e]=eK,t++;break;case"append":l[e]=(l[e]||"")+eK,t++;break;case"prepend":l[e]=eK+(l[e]||""),t++;break;case"clear":l[e]="",t++;break;case"uppercase":l[e]=String(l[e]||"").toUpperCase(),t++;break;case"lowercase":l[e]=String(l[e]||"").toLowerCase(),t++;break;case"trim":l[e]=String(l[e]||"").trim(),t++;break;case"capitalize":l[e]=String(l[e]||"").replace(/\b\w/g,e=>e.toUpperCase()),t++}return l}));let a={...w};N.forEach((e,t)=>{a[t]||(a[t]={}),a[t][eu]=!0}),C(a),I(!0),P(!1),l.oR.success("Updated ".concat(t," cells"))},[eu,eK,e0,N,w,e7]),ti=(0,n.useCallback)(e=>{let t=parseInt(e.replace("col_",""));if(!N||0===N.length)return;let a=N[0][t];if(!a&&0!==a)return void l.oR.warning("First cell is empty");e7("Fill down column"),R(e=>e.map((e,r)=>{if(0===r)return e;let l=[...e];return l[t]=a,l}));let r={...w};for(let t=1;t<N.length;t++)r[t]||(r[t]={}),r[t][e]=!0;C(r),I(!0),l.oR.success("Column filled down")},[N,w,e7]),ts=(0,n.useCallback)(e=>{let t=parseInt(e.replace("col_",""));e7("Clear column"),R(e=>e.map(e=>{let a=[...e];return a[t]="",a}));let a={...w};N.forEach((t,r)=>{a[r]||(a[r]={}),a[r][e]=!0}),C(a),I(!0),l.oR.success("Column cleared")},[N,w,e7]),to=(0,n.useCallback)(()=>{j&&N&&j(N),S(!1),C({}),I(!1)},[N,j]),td=(0,n.useCallback)(()=>{var e;S(!1),C({}),I(!1),O([]),z([]);let t=(null==u||null==(e=u.data)?void 0:e.rows)||(null==u?void 0:u.rows);t&&R(eQ(t).map(e=>[...e]))},[u]),tc=(0,n.useMemo)(()=>{var e;let t=N||(null==u||null==(e=u.data)?void 0:e.rows)||(null==u?void 0:u.rows);return t?t.map((e,t)=>{let a={id:t};return e.forEach((e,t)=>{a["col_".concat(t)]=e||""}),a}):[]},[N,null==u||null==(a=u.data)?void 0:a.rows,null==u?void 0:u.rows]);return(0,r.jsxs)(s.A,{children:[(0,r.jsxs)(o.A,{sx:{p:3},children:[(0,r.jsxs)(i.A,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{mb:3},children:[(0,r.jsxs)(i.A,{direction:"row",alignItems:"center",spacing:2,children:[(0,r.jsx)(K.default,{variant:"h6",children:"Review Data"}),A&&(0,r.jsx)(eo.default,{label:"".concat(Object.keys(w).length," rows modified"),color:"warning",size:"small"}),E&&(0,r.jsx)(eo.default,{icon:(0,r.jsx)(Z.W,{icon:{high:"eva:checkmark-circle-2-fill",medium:"eva:alert-circle-fill",low:"eva:close-circle-fill"}[E.overallQuality]||"eva:question-mark-circle-fill"}),label:"Data Quality: ".concat(E.averageCompleteness,"%"),color:eZ(E.overallQuality),size:"small",onClick:()=>L(!D),sx:{cursor:"pointer"}})]}),(0,r.jsx)(i.A,{direction:"row",spacing:2,children:b?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(eE.default,{variant:"outlined",size:"small",children:[(0,r.jsx)(ek.default,{title:"Undo (Ctrl+Z)",children:(0,r.jsx)("span",{children:(0,r.jsx)(eR.default,{onClick:e9,disabled:0===M.length,size:"small",children:(0,r.jsx)(eD.default,{badgeContent:M.length,color:"primary",children:(0,r.jsx)(eg.A,{fontSize:"small"})})})})}),(0,r.jsx)(ek.default,{title:"Redo (Ctrl+Y)",children:(0,r.jsx)("span",{children:(0,r.jsx)(eR.default,{onClick:te,disabled:0===B.length,size:"small",children:(0,r.jsx)(eD.default,{badgeContent:B.length,color:"primary",children:(0,r.jsx)(ev.A,{fontSize:"small"})})})})})]}),(0,r.jsxs)(eE.default,{variant:"outlined",size:"small",children:[(0,r.jsx)(X.default,{onClick:()=>W(!0),startIcon:(0,r.jsx)(ey.A,{}),children:"Find & Replace"}),(0,r.jsx)(X.default,{onClick:()=>P(!0),startIcon:(0,r.jsx)(ej.A,{}),children:"Bulk Edit"})]}),(0,r.jsx)(eE.default,{variant:"outlined",size:"small",children:(0,r.jsx)(X.default,{onClick:()=>_(!0),startIcon:(0,r.jsx)(eb.A,{}),children:"Add Row"})}),(0,r.jsx)(eL.default,{orientation:"vertical",flexItem:!0}),(0,r.jsx)(X.default,{variant:"outlined",color:"error",onClick:td,startIcon:(0,r.jsx)(eS.A,{}),size:"small",children:"Cancel"}),(0,r.jsx)(X.default,{variant:"contained",color:"success",onClick:to,startIcon:(0,r.jsx)(ew.A,{}),size:"small",disabled:!A,children:"Save Changes"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ek.default,{title:"Edit data before importing",children:(0,r.jsx)(eR.default,{onClick:()=>{S(!0)},sx:e=>({border:"1px solid ".concat((0,V.IG)(e.vars.palette.grey["500Channel"],.24)),"&:hover":{bgcolor:(0,V.IG)(e.vars.palette.primary.mainChannel,.08)}}),children:(0,r.jsx)(ej.A,{fontSize:"small"})})}),(0,r.jsx)(X.default,{variant:"outlined",onClick:v,startIcon:(0,r.jsx)(Z.W,{icon:"eva:arrow-back-fill"}),disabled:m,children:"Back"})]})})]}),(0,r.jsx)(Q.default,{severity:b?"warning":"info",sx:e=>({mb:3,border:"1px solid ".concat((0,V.IG)(b?e.vars.palette.warning.mainChannel:e.vars.palette.info.mainChannel,.24)),bgcolor:(0,V.IG)(b?e.vars.palette.warning.mainChannel:e.vars.palette.info.mainChannel,.08)}),children:b?(0,r.jsxs)(i.A,{spacing:.5,children:[(0,r.jsxs)(K.default,{variant:"body2",children:[(0,r.jsx)("strong",{children:"Edit Mode Active:"})," Use the editing tools to modify your data"]}),(0,r.jsx)(K.default,{variant:"caption",color:"text.secondary",children:"• Double-click cells to edit individually | • Select rows with checkboxes | • Use column dropdown for column operations"})]}):u?(0,r.jsxs)(K.default,{variant:"body2",children:["Please review your data before importing. Total records found:"," ",(0,r.jsx)(o.A,{component:"span",sx:{fontWeight:600},children:(null==N?void 0:N.length)||u.totalRecords})," ","• Click the edit icon to make corrections if needed."]}):"Loading preview data..."}),(0,r.jsx)(ed.A,{in:D,children:E&&(0,r.jsx)(s.A,{sx:{mb:3,p:2,bgcolor:"background.neutral"},children:(0,r.jsxs)(i.A,{spacing:2,children:[(0,r.jsxs)(K.default,{variant:"subtitle2",sx:{display:"flex",alignItems:"center",gap:1},children:[(0,r.jsx)(eC.A,{})," Data Quality Analysis"]}),E.recommendations.length>0&&(0,r.jsxs)(Q.default,{severity:"info",icon:(0,r.jsx)(eA.A,{}),children:[(0,r.jsx)(K.default,{variant:"subtitle2",gutterBottom:!0,children:"Recommendations:"}),(0,r.jsx)(o.A,{component:"ul",sx:{m:0,pl:2},children:E.recommendations.map((e,t)=>(0,r.jsx)("li",{children:(0,r.jsx)(K.default,{variant:"caption",children:e})},t))})]}),(0,r.jsx)(o.A,{sx:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:2},children:Object.entries(E.columnMetrics||{}).slice(0,6).map(e=>{let[t,a]=e;return(0,r.jsxs)(o.A,{sx:{p:1.5,border:1,borderColor:"divider",borderRadius:1},children:[(0,r.jsx)(K.default,{variant:"caption",color:"text.secondary",noWrap:!0,children:t}),(0,r.jsxs)(i.A,{direction:"row",spacing:1,alignItems:"center",sx:{mt:.5},children:[(0,r.jsx)(eo.default,{size:"small",label:"".concat(a.completeness,"%"),color:eZ(a.quality)}),(0,r.jsx)(K.default,{variant:"caption",color:"text.secondary",children:a.dataType})]}),a.issues.length>0&&(0,r.jsx)(K.default,{variant:"caption",color:"error",sx:{display:"block",mt:.5},children:a.issues[0]})]},t)})})]})})}),(0,r.jsx)(o.A,{sx:e=>({height:400,width:"100%","& .MuiDataGrid-root":{border:"none"},"& .MuiDataGrid-cell":{borderBottom:"1px solid ".concat((0,V.IG)(e.vars.palette.grey["500Channel"],.08)),cursor:b?"text":"default"},"& .MuiDataGrid-cell--editable":{bgcolor:(0,V.IG)(e.vars.palette.primary.mainChannel,.02),"&:hover":{bgcolor:(0,V.IG)(e.vars.palette.primary.mainChannel,.08)}},"& .MuiDataGrid-columnHeaders":{bgcolor:(0,V.IG)(e.vars.palette.grey["500Channel"],.04),borderBottom:"1px solid ".concat((0,V.IG)(e.vars.palette.grey["500Channel"],.16))},"& .MuiDataGrid-footerContainer":{borderTop:"1px solid ".concat((0,V.IG)(e.vars.palette.grey["500Channel"],.16))}}),children:m?(0,r.jsx)($.A,{}):u&&((null==(d=u.data)?void 0:d.rows)||u.rows)?(0,r.jsx)(eh.z,{rows:tc,columns:tr,pagination:!0,paginationModel:F,onPaginationModelChange:T,pageSizeOptions:[50,100,200],rowHeight:52,columnBuffer:2,rowBuffer:10,disableVirtualization:!1,disableColumnFilter:tc.length>1e3,disableColumnSelector:tc.length>1e3,disableSelectionOnClick:!0,disableColumnMenu:!0,density:"compact",processRowUpdate:tt,onProcessRowUpdateError:e=>{f.error("Error updating row:",e)},components:{NoRowsOverlay:()=>(0,r.jsx)(eY.H,{title:"No data to preview"})},sx:{"& .MuiDataGrid-cell--editing":{bgcolor:e=>(0,V.IG)(e.vars.palette.warning.mainChannel,.15)},"& .MuiDataGrid-virtualScroller":{minHeight:400},"& .MuiDataGrid-virtualScrollerContent":{minHeight:tc.length>0?"".concat(Math.min(52*tc.length,2e3),"px"):400}}},b?"edit-mode":"view-mode"):(0,r.jsx)(eY.H,{title:"No data to preview",description:"Upload a file to see preview"})}),(null==u?void 0:u.errors)&&u.errors.length>0&&(0,r.jsxs)(Q.default,{severity:"error",sx:e=>({mt:3,border:"1px solid ".concat((0,V.IG)(e.vars.palette.error.mainChannel,.24)),bgcolor:(0,V.IG)(e.vars.palette.error.mainChannel,.08)}),children:[(0,r.jsx)(K.default,{variant:"subtitle2",fontWeight:600,gutterBottom:!0,children:"Validation Errors Found:"}),(0,r.jsxs)(o.A,{component:"ul",sx:{m:0,pl:2},children:[u.errors.slice(0,5).map((e,t)=>(0,r.jsx)("li",{children:(0,r.jsx)(K.default,{variant:"caption",children:e})},t)),u.errors.length>5&&(0,r.jsxs)(K.default,{variant:"caption",color:"text.secondary",children:["...and ",u.errors.length-5," more errors"]})]})]}),(0,r.jsxs)(i.A,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{mt:3},children:[(0,r.jsx)(K.default,{variant:"caption",color:"text.secondary",children:b?"Save your changes before importing":A?"You have unsaved changes. Save them before importing.":"Review the data and click Import when ready"}),(0,r.jsxs)(o.A,{sx:{position:"relative",display:"inline-flex"},children:[(0,r.jsx)(em.default,{variant:"contained",size:"large",onClick:y,loading:m,disabled:b||(null==u?void 0:u.errors)&&u.errors.length>0,children:"Import Data"}),m&&x>0&&x<100&&(0,r.jsx)(o.A,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none"},children:(0,r.jsx)(K.default,{variant:"caption",sx:{position:"absolute",bottom:-20,left:"50%",transform:"translateX(-50%)",whiteSpace:"nowrap"},children:g||"Uploading: ".concat(x,"%")})})]})]}),m&&x>0&&(0,r.jsx)($.A,{variant:"determinate",value:x,sx:{mt:1}})]}),(0,r.jsxs)(eF.A,{anchorEl:e3,open:!!e3,onClose:()=>e4(null),children:[(0,r.jsxs)(eT.default,{onClick:()=>{ti(e6),e4(null)},children:[(0,r.jsx)(eM.default,{children:(0,r.jsx)(eI.A,{fontSize:"small"})}),(0,r.jsx)(eO.A,{children:"Fill Down"})]}),(0,r.jsxs)(eT.default,{onClick:()=>{ts(e6),e4(null)},children:[(0,r.jsx)(eM.default,{children:(0,r.jsx)(eN.A,{fontSize:"small"})}),(0,r.jsx)(eO.A,{children:"Clear Column"})]}),(0,r.jsx)(eL.default,{}),(0,r.jsxs)(eT.default,{onClick:()=>{ei(e6),W(!0),e4(null)},children:[(0,r.jsx)(eM.default,{children:(0,r.jsx)(ey.A,{fontSize:"small"})}),(0,r.jsx)(eO.A,{children:"Find & Replace in Column"})]}),(0,r.jsxs)(eT.default,{onClick:()=>{ep(e6),P(!0),e4(null)},children:[(0,r.jsx)(eM.default,{children:(0,r.jsx)(ej.A,{fontSize:"small"})}),(0,r.jsx)(eO.A,{children:"Bulk Edit Column"})]})]}),(0,r.jsxs)(eB.A,{open:U,onClose:()=>{W(!1),ec([])},maxWidth:"md",fullWidth:!0,children:[(0,r.jsx)(ez.A,{children:"Find and Replace"}),(0,r.jsx)(eU.A,{children:(0,r.jsxs)(i.A,{spacing:3,sx:{mt:2},children:[(0,r.jsxs)(i.A,{direction:"row",spacing:2,children:[(0,r.jsx)(eW.default,{fullWidth:!0,label:"Find",value:H,onChange:e=>Y(e.target.value),autoFocus:!0,helperText:es.length>0?"Found ".concat(es.length," matches"):H?"No matches found":""}),(0,r.jsx)(eW.default,{fullWidth:!0,label:"Replace with",value:J,onChange:e=>ee(e.target.value)})]}),(0,r.jsxs)(i.A,{direction:"row",spacing:2,alignItems:"center",children:[(0,r.jsxs)(eq.A,{sx:{minWidth:200},children:[(0,r.jsx)(eP.default,{children:"Column"}),(0,r.jsxs)(eG.A,{value:en,onChange:e=>ei(e.target.value),label:"Column",children:[(0,r.jsx)(eT.default,{value:"all",children:"All Columns"}),tr.map(e=>(0,r.jsx)(eT.default,{value:e.field,children:e.headerName},e.field))]})]}),(0,r.jsx)(e_.default,{control:(0,r.jsx)(eH.default,{checked:et,onChange:e=>ea(e.target.checked)}),label:"Case sensitive"}),(0,r.jsx)(e_.default,{control:(0,r.jsx)(eH.default,{checked:er,onChange:e=>el(e.target.checked)}),label:"Whole word"})]}),es.length>0&&(0,r.jsxs)(o.A,{children:[(0,r.jsx)(K.default,{variant:"subtitle2",gutterBottom:!0,children:"Preview of matches (showing first 10):"}),(0,r.jsxs)(o.A,{sx:{maxHeight:200,overflow:"auto",border:1,borderColor:"divider",borderRadius:1,p:1},children:[es.slice(0,10).map((e,t)=>(0,r.jsxs)(K.default,{variant:"body2",sx:{mb:.5},children:["Row ",e.row+1,", ",e.columnName,': "',e.value.substring(0,100),e.value.length>100?"...":"",'"']},t)),es.length>10&&(0,r.jsxs)(K.default,{variant:"caption",color:"text.secondary",children:["... and ",es.length-10," more matches"]})]})]})]})}),(0,r.jsxs)(eV.default,{children:[(0,r.jsx)(X.default,{onClick:()=>{W(!1),Y(""),ee(""),ec([])},children:"Cancel"}),(0,r.jsxs)(X.default,{onClick:tl,variant:"contained",disabled:!H||0===es.length,children:["Replace All (",es.length," matches)"]})]})]}),(0,r.jsxs)(eB.A,{open:q,onClose:()=>{P(!1),e5([])},maxWidth:"md",fullWidth:!0,children:[(0,r.jsx)(ez.A,{children:"Bulk Edit"}),(0,r.jsx)(eU.A,{children:(0,r.jsxs)(i.A,{spacing:3,sx:{mt:2},children:[(0,r.jsxs)(i.A,{direction:"row",spacing:2,children:[(0,r.jsxs)(eq.A,{fullWidth:!0,children:[(0,r.jsx)(eP.default,{children:"Column"}),(0,r.jsxs)(eG.A,{value:eu,onChange:e=>ep(e.target.value),label:"Column",children:[(0,r.jsx)(eT.default,{value:"",children:"Select a column"}),tr.map(e=>(0,r.jsx)(eT.default,{value:e.field,children:e.headerName},e.field))]})]}),(0,r.jsxs)(eq.A,{fullWidth:!0,children:[(0,r.jsx)(eP.default,{children:"Operation"}),(0,r.jsxs)(eG.A,{value:e0,onChange:e=>e1(e.target.value),label:"Operation",children:[(0,r.jsx)(eT.default,{value:"set",children:"Set value"}),(0,r.jsx)(eT.default,{value:"append",children:"Append to existing"}),(0,r.jsx)(eT.default,{value:"prepend",children:"Prepend to existing"}),(0,r.jsx)(eT.default,{value:"clear",children:"Clear all"}),(0,r.jsx)(eT.default,{value:"uppercase",children:"Convert to uppercase"}),(0,r.jsx)(eT.default,{value:"lowercase",children:"Convert to lowercase"}),(0,r.jsx)(eT.default,{value:"trim",children:"Trim whitespace"}),(0,r.jsx)(eT.default,{value:"capitalize",children:"Capitalize first letter"})]})]})]}),["set","append","prepend"].includes(e0)&&(0,r.jsx)(eW.default,{fullWidth:!0,label:"Value",value:eK,onChange:e=>eX(e.target.value),helperText:"append"===e0?"This text will be added to the end of existing values":"prepend"===e0?"This text will be added to the beginning of existing values":"This will replace all values in the selected column"}),eu&&(0,r.jsxs)(Q.default,{severity:"info",children:["This will edit all ",(null==N?void 0:N.length)||(null==u||null==(c=u.rows)?void 0:c.length)||0," rows in the selected column"]}),e2.length>0&&(0,r.jsxs)(o.A,{children:[(0,r.jsx)(K.default,{variant:"subtitle2",gutterBottom:!0,children:"Preview of changes (showing first 5):"}),(0,r.jsxs)(o.A,{sx:{maxHeight:200,overflow:"auto",border:1,borderColor:"divider",borderRadius:1,p:1},children:[e2.map((e,t)=>(0,r.jsxs)(o.A,{sx:{mb:1},children:[(0,r.jsxs)(K.default,{variant:"body2",children:["Row ",e.row+1,":"]}),(0,r.jsxs)(K.default,{variant:"caption",color:"text.secondary",children:['Current: "',e.oldValue.substring(0,50),e.oldValue.length>50?"...":"",'"']}),(0,r.jsx)("br",{}),(0,r.jsxs)(K.default,{variant:"caption",color:"primary",children:['New: "',e.newValue.substring(0,50),e.newValue.length>50?"...":"",'"']})]},t)),5===e2.length&&(0,r.jsx)(K.default,{variant:"caption",color:"text.secondary",children:"... and more rows will be affected"})]})]})]})}),(0,r.jsxs)(eV.default,{children:[(0,r.jsx)(X.default,{onClick:()=>{P(!1),ep(""),eX(""),e5([])},children:"Cancel"}),(0,r.jsx)(X.default,{onClick:tn,variant:"contained",disabled:!eu,children:"Apply to All Rows"})]})]}),(0,r.jsxs)(eB.A,{open:G,onClose:()=>_(!1),maxWidth:"xs",fullWidth:!0,children:[(0,r.jsx)(ez.A,{children:"Add New Row"}),(0,r.jsx)(eU.A,{children:(0,r.jsx)(Q.default,{severity:"info",sx:{mt:2},children:"A new empty row will be added to the end of your data. You can then edit the cells individually."})}),(0,r.jsxs)(eV.default,{children:[(0,r.jsx)(X.default,{onClick:()=>_(!1),children:"Cancel"}),(0,r.jsx)(X.default,{onClick:ta,variant:"contained",children:"Add Row"})]})]})]})}e0.propTypes={previewData:H().shape({headers:H().arrayOf(H().string),data:H().shape({headers:H().arrayOf(H().string),rows:H().arrayOf(H().array)}),rows:H().arrayOf(H().array),totalRecords:H().number,errors:H().arrayOf(H().string)}),sampleData:H().arrayOf(H().array),columnMappings:H().object,isLoading:H().bool.isRequired,uploadProgress:H().number,retryStatus:H().string,onBack:H().func.isRequired,onImport:H().func.isRequired,onDataEdit:H().func};var e1=a(15788),e2=a(76936),e5=a(15876),e3=a(84762),e4=a(25949),e6=a(72137),e8=a(60032),e7=a(72330),e9=a(57236);function te(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r={};return e.forEach(e=>{if(a){var l;let n=(null==(l=w[a])?void 0:l[e])||e;if(t.includes(n)){r[e]=n;return}}let n=e.toLowerCase().replace(/[_\s-]/g,""),i=t.find(e=>e.toLowerCase().replace(/[_\s-]/g,"")===n);i||(i=t.find(e=>{let t=e.toLowerCase().replace(/[_\s-]/g,"");return n.includes(t)||t.includes(n)})),i||(i=({firstname:"ContactFName",first:"ContactFName",fname:"ContactFName",customerfname:"ContactFName",contactfirstname:"ContactFName",lastname:"ContactLName",last:"ContactLName",lname:"ContactLName",customerlname:"ContactLName",contactlastname:"ContactLName",phone:"ContactNo",phonenumber:"ContactNo",mobile:"ContactNo",cellphone:"ContactNo",contact:"ContactNo",contactnumber:"ContactNo",contactno:"ContactNo",mobilenumber:"ContactNo",contactphone:"ContactNo",type:"ContactType",contacttype:"ContactType",customertype:"ContactType",contactcategory:"ContactType",site:"SiteName",sitename:"SiteName",projectname:"SiteName",project:"SiteName",property:"SiteName",sitecity:"SiteCity",projectcity:"SiteCity",propertycity:"SiteCity",city:"SiteCity",siteaddress:"SiteAddress",projectaddress:"SiteAddress",sitelocation:"SiteAddress",propertyaddress:"SiteAddress",address:"SiteAddress",sitestatus:"SiteStatus",projectstatus:"SiteStatus",sitedescription:"SiteDescription",description:"SiteDescription",projectdescription:"SiteDescription",operational:"IsOperational",isoperational:"IsOperational",active:"IsOperational",isactive:"IsOperational",lead:"LeadName",leadname:"LeadName",opportunityname:"LeadName",opportunity:"LeadName",createddate:"CreatedDate",created:"CreatedDate",createdon:"CreatedDate",dateofcreation:"CreatedDate",closeddate:"LeadClosedDate",leadcloseddate:"LeadClosedDate",closedate:"LeadClosedDate",dateclosed:"LeadClosedDate",status:"LeadStatus",leadstatus:"LeadStatus",leadstate:"LeadStatus",source:"LeadSource",leadsource:"LeadSource",origin:"LeadSource",leadorigin:"LeadSource",notes:"LeadNotes",leadnotes:"LeadNotes",comments:"LeadNotes",remarks:"LeadNotes",leadcomments:"LeadNotes",unit:"UnitNumber",unitno:"UnitNumber",unitnumber:"UnitNumber",flatno:"UnitNumber",floor:"FloorNumber",floorno:"FloorNumber",floornumber:"FloorNumber",level:"FloorNumber",size:"SizeSqFt",sizesqft:"SizeSqFt",area:"SizeSqFt",sqft:"SizeSqFt",unitsize:"UnitSize",infra:"InfraName",infrastructure:"InfraName",building:"InfraName",tower:"InfraName",block:"InfraName",infracategory:"InfraCategory",buildingtype:"InfraCategory",bedrooms:"Bedrooms",bedroom:"Bedrooms",bed:"Bedrooms",bhk:"Bedrooms",view:"ViewType",viewtype:"ViewType",facing:"Direction",direction:"Direction",floorpreference:"FloorPreference",preferredfloor:"FloorPreference",buyingintent:"BuyingIntent",intent:"BuyingIntent",interest:"BuyingIntent",amount:"RequestAmount",requestamount:"RequestAmount",budget:"RequestAmount",quotedamount:"QuotedAmount",quote:"QuotedAmount",closedamount:"ClosedAmount",finalamount:"ClosedAmount",soldamount:"ClosedAmount"})[n.toLowerCase()]||null),i&&t.includes(i)&&(r[e]=i)}),r}function tt(e,t){let a=Object.keys(t).length;return{total:e.length,mapped:a,unmapped:e.length-a,percentage:e.length>0?Math.round(a/e.length*100):0}}function ta(e){var t,a;let{fileColumns:l=[],selectedType:d,columnMappings:c,onMappingChange:u,onNext:p,onBack:h}=e,[m,f]=(0,n.useState)({}),[x,g]=(0,n.useState)([]),[v,y]=(0,n.useState)(!1),[j,b]=(0,n.useState)({total:0,mapped:0,unmapped:0});(0,n.useEffect)(()=>{if(!(l.length>0)||c||v)c&&(f(c),b(tt(l,c)));else{let e=te(l,[...(null==d?void 0:d.requiredFields)||[],...(null==d?void 0:d.optionalFields)||[]],null==d?void 0:d.id);f(e),y(!0),b(tt(l,e))}},[l,d,c,v]),(0,n.useEffect)(()=>{g(function(e,t){let a=[],r=Object.values(e);t.forEach(e=>{r.includes(e)||a.push('Required field "'.concat(e,'" is not mapped'))});let l=r.filter((e,t)=>r.indexOf(e)!==t);if(l.length>0){let e=[...new Set(l)];a.push("Duplicate mapping found for: ".concat(e.join(", ")))}return a}(m,(null==d?void 0:d.requiredFields)||[])),b(tt(l,m))},[m,d,l]);let S=(e,t)=>{f(a=>{let r={...a};return""===t?delete r[e]:r[e]=t,r})},w=e=>{let t=[...(null==d?void 0:d.requiredFields)||[],...(null==d?void 0:d.optionalFields)||[]],a=m[e],r=Object.entries(m).filter(t=>{let[a]=t;return a!==e}).map(e=>{let[,t]=e;return t});return t.filter(e=>e===a||!r.includes(e))},C=e=>((null==d?void 0:d.requiredFields)||[]).includes(e);return(0,r.jsxs)(i.A,{spacing:3,children:[(0,r.jsx)(s.A,{children:(0,r.jsxs)(o.A,{sx:{p:3},children:[(0,r.jsxs)(i.A,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{mb:3},children:[(0,r.jsxs)(i.A,{direction:"row",alignItems:"center",spacing:2,children:[(0,r.jsx)(K.default,{variant:"h6",children:"Column Mapping"}),v&&(0,r.jsx)(eo.default,{icon:(0,r.jsx)(ex.A,{}),label:"Auto-mapped ".concat(j.mapped," of ").concat(j.total," columns"),color:0===j.unmapped?"success":"warning",size:"small",variant:"outlined"})]}),(0,r.jsxs)(i.A,{direction:"row",spacing:2,children:[(0,r.jsx)(X.default,{variant:"outlined",onClick:()=>{f(te(l,[...(null==d?void 0:d.requiredFields)||[],...(null==d?void 0:d.optionalFields)||[]],null==d?void 0:d.id)),y(!0)},startIcon:(0,r.jsx)(Z.W,{icon:"eva:refresh-fill"}),size:"small",children:v?"Re-map":"Auto Map"}),(0,r.jsx)(X.default,{variant:"outlined",color:"error",onClick:()=>{f({})},startIcon:(0,r.jsx)(Z.W,{icon:"eva:trash-2-outline"}),size:"small",children:"Clear All"})]})]}),(0,r.jsx)(Q.default,{severity:v?0===j.unmapped?"success":"warning":"info",icon:v?(0,r.jsx)(ex.A,{}):(0,r.jsx)(e1.A,{}),sx:{mb:3},children:v?0===j.unmapped?(0,r.jsxs)(K.default,{variant:"body2",children:[(0,r.jsx)("strong",{children:"Perfect!"})," All columns have been automatically mapped. Please review and confirm the mappings below."]}):(0,r.jsxs)(K.default,{variant:"body2",children:[(0,r.jsx)("strong",{children:"Auto-mapping complete!"})," ",j.mapped," columns were automatically mapped. Please manually map the remaining ",j.unmapped," ","column",j.unmapped>1?"s":"",' marked as "Not Mapped".']}):(0,r.jsxs)(K.default,{variant:"body2",children:["Analyzing your file columns and mapping them to ",null==d?void 0:d.title," fields..."]})}),(0,r.jsx)(e5.A,{component:e3.default,variant:"outlined",children:(0,r.jsxs)(e4.A,{children:[(0,r.jsx)(e6.A,{children:(0,r.jsxs)(e8.default,{children:[(0,r.jsx)(e7.default,{children:"File Column"}),(0,r.jsx)(e7.default,{children:"Sample Data"}),(0,r.jsx)(e7.default,{children:"Map to Field"}),(0,r.jsx)(e7.default,{align:"center",children:"Status"})]})}),(0,r.jsx)(e9.A,{children:l.map((e,t)=>(0,r.jsx)(n.Fragment,{children:(0,r.jsxs)(e8.default,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[(0,r.jsx)(e7.default,{children:(0,r.jsx)(K.default,{variant:"body2",fontWeight:600,children:e})}),(0,r.jsx)(e7.default,{children:(0,r.jsx)(K.default,{variant:"caption",color:"text.secondary",children:"Sample data preview"})}),(0,r.jsx)(e7.default,{children:(0,r.jsx)(eq.A,{fullWidth:!0,size:"small",children:(0,r.jsxs)(eG.A,{value:m[e]||"",onChange:t=>S(e,t.target.value),displayEmpty:!0,children:[(0,r.jsx)(eT.default,{value:"",children:(0,r.jsx)("em",{children:"-- Not Mapped --"})}),w(e).map(e=>(0,r.jsxs)(eT.default,{value:e,children:[e," ",C(e)&&"*"]},e))]})})}),(0,r.jsx)(e7.default,{align:"center",children:m[e]?(0,r.jsx)(eo.default,{icon:(0,r.jsx)(ex.A,{}),label:"Mapped",color:"success",size:"small",variant:"outlined"}):(0,r.jsx)(eo.default,{label:"Not Mapped",size:"small",variant:"outlined"})})]})},"column-".concat(t,"-").concat(e)))})]})}),x.length>0&&(0,r.jsxs)(Q.default,{severity:"warning",icon:(0,r.jsx)(e2.A,{}),sx:{mt:3},children:[(0,r.jsx)(K.default,{variant:"subtitle2",fontWeight:600,gutterBottom:!0,children:"Mapping Issues:"}),(0,r.jsx)(o.A,{component:"ul",sx:{m:0,pl:2},children:x.map((e,t)=>(0,r.jsx)("li",{children:(0,r.jsx)(K.default,{variant:"caption",children:e})},t))})]}),(0,r.jsxs)(i.A,{direction:"row",spacing:2,justifyContent:"space-between",sx:{mt:3},children:[(0,r.jsx)(X.default,{variant:"outlined",onClick:h,startIcon:(0,r.jsx)(Z.W,{icon:"eva:arrow-back-fill"}),children:"Back"}),(0,r.jsx)(X.default,{variant:"contained",onClick:()=>{0===x.length&&(u(m),p())},disabled:x.length>0,endIcon:(0,r.jsx)(Z.W,{icon:"eva:arrow-forward-fill"}),children:"Continue"})]})]})}),(0,r.jsx)(s.A,{children:(0,r.jsxs)(o.A,{sx:{p:3},children:[(0,r.jsx)(K.default,{variant:"h6",gutterBottom:!0,children:"Field Requirements"}),(0,r.jsxs)(i.A,{spacing:2,children:[(0,r.jsxs)(o.A,{children:[(0,r.jsx)(K.default,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Required Fields"}),(0,r.jsx)(i.A,{direction:"row",spacing:1,flexWrap:"wrap",useFlexGap:!0,children:null==d||null==(t=d.requiredFields)?void 0:t.map(e=>{let t=Object.values(m).includes(e);return(0,r.jsx)(eo.default,{label:e,size:"small",color:t?"success":"default",variant:t?"filled":"outlined",icon:t?(0,r.jsx)(ex.A,{}):void 0},e)})})]}),(0,r.jsxs)(o.A,{children:[(0,r.jsx)(K.default,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Optional Fields"}),(0,r.jsx)(i.A,{direction:"row",spacing:1,flexWrap:"wrap",useFlexGap:!0,children:null==d||null==(a=d.optionalFields)?void 0:a.map(e=>{let t=Object.values(m).includes(e);return(0,r.jsx)(eo.default,{label:e,size:"small",color:t?"info":"default",variant:"outlined",icon:t?(0,r.jsx)(ex.A,{}):void 0},e)})})]})]})]})})]})}ta.propTypes={fileColumns:H().arrayOf(H().string),selectedType:H().object,columnMappings:H().object,onMappingChange:H().func.isRequired,onNext:H().func.isRequired,onBack:H().func.isRequired};class tr extends n.Component{static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){f.error("Import wizard error:",e,t),this.setState({error:e,errorInfo:t}),window.Sentry&&window.Sentry.captureException(e,{contexts:{react:{componentStack:t.componentStack}}})}render(){return this.state.hasError?(0,r.jsx)(s.A,{sx:{p:4,textAlign:"center",maxWidth:600,mx:"auto",mt:4},children:(0,r.jsxs)(i.A,{spacing:3,alignItems:"center",children:[(0,r.jsx)(Z.W,{icon:"solar:danger-triangle-bold",width:64,color:"error.main"}),(0,r.jsx)(K.default,{variant:"h5",children:"Something went wrong with the import"}),(0,r.jsx)(K.default,{variant:"body2",color:"text.secondary",children:"The import wizard encountered an unexpected error. You can try again or return to the dashboard."}),!1,(0,r.jsxs)(i.A,{direction:"row",spacing:2,children:[(0,r.jsx)(X.default,{variant:"contained",onClick:this.handleReset,startIcon:(0,r.jsx)(Z.W,{icon:"solar:refresh-bold"}),children:"Try Again"}),(0,r.jsx)(X.default,{variant:"outlined",onClick:this.handleReturnToDashboard,children:"Go to Dashboard"})]}),(0,r.jsx)(K.default,{variant:"caption",color:"text.secondary",children:"If this problem persists, please contact support."})]})}):this.props.children}constructor(e){super(e),this.handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null}),this.props.onReset&&this.props.onReset()},this.handleReturnToDashboard=()=>{window.location.href="/dashboard"},this.state={hasError:!1,error:null,errorInfo:null}}}function tl(){let[e,t]=(0,n.useState)(0),[a,h]=(0,n.useState)(null),[m,g]=(0,n.useState)(null),[v,y]=(0,n.useState)(null),[j,b]=(0,n.useState)([]),[w,C]=(0,n.useState)(null),[A,I]=(0,n.useState)(null),[N,E]=(0,n.useState)(null),[L,O]=(0,n.useState)(!1),[B,U]=(0,n.useState)(!1),[_,H]=(0,n.useState)(null),[V,Y]=(0,n.useState)(0),[K,X]=(0,n.useState)(null),$=n.useRef(null),Q=n.useRef(null),J=(0,n.useCallback)(e=>{h(e),t(1)},[]),Z=(0,n.useCallback)(async(e,t)=>{e.stopPropagation();try{await R(t),l.oR.success("Template for ".concat(t," downloaded successfully"))}catch(e){f.error("Template download error:",e),l.oR.error("Failed to download template")}},[]),et=(0,n.useMemo)(()=>(null==a?void 0:a.id)==="leads"?q:(null==a?void 0:a.id)==="infrastructure"?P:W,[null==a?void 0:a.id]),er=(0,n.useCallback)(async e=>{let r=await G.validateExcelFile(e);if(!r.valid)return void r.errors.forEach(e=>{l.oR.error(e)});let n=await G.validateFileContent(e);if(!n.valid)return void l.oR.error(n.error);g(e),y(e),U(!0);try{let r=await k(e,a.id);if(r.success){b(r.columns),I({fileId:r.fileId});let a=await G.getFileMetadata(e);a&&f.debug("File metadata:",a),$.current=setTimeout(()=>{t(2),U(!1)},1500)}else throw Error(r.error||"Upload failed")}catch(e){f.error("File upload error:",e),l.oR.error(e.message||"Failed to upload file"),g(null),y(null),U(!1)}},[a]),el=(0,n.useCallback)(async()=>{O(!0);try{var e,r;let l=await D(A.fileId,a.id,w);I({...A,...l,mappings:w}),((null==(e=l.data)?void 0:e.rows)||l.rows)&&E((null==(r=l.data)?void 0:r.rows)||l.rows),t(3)}catch(e){f.error("Preview error:",e),l.oR.error(e.message||"Failed to get preview")}finally{O(!1)}},[A,a,w]),en=(0,n.useCallback)(e=>{I(t=>({...t,data:{...t.data,rows:e}})),l.oR.success("Changes saved successfully")},[]),ei=(0,n.useCallback)(async()=>{if(!v)return void l.oR.error("File data lost. Please restart the import process.");O(!0),Y(0),X(null),Q.current=new AbortController;try{let e=await F(A.fileId,a.id,w,v,e=>Y(e),e=>{let{attempt:t,maxRetries:a,delay:r}=e,n="Upload failed. Retrying... (Attempt ".concat(t,"/").concat(a,")");X(n),l.oR.warning(n,{autoClose:r})},Q.current);if(e.success)H({...e,type:a.id}),t(4),l.oR.success("Data imported successfully!");else throw Error(e.error||"Import failed")}catch(e){"CanceledError"===e.name||"ERR_CANCELED"===e.code?(f.info("Import was cancelled"),l.oR.info("Import cancelled")):(f.error("Import error:",e),l.oR.error(e.message||"Failed to import data"))}finally{O(!1),Y(0),X(null),Q.current=null}},[A,a,w,v]),es=(0,n.useCallback)(()=>{t(e=>e-1)},[]),eo=(0,n.useCallback)(()=>{t(0),h(null),g(null),y(null),b([]),C(null),(null==A?void 0:A.fileId)&&S.delete(A.fileId),I(null),H(null),O(!1),Y(0),X(null)},[A]);return(0,n.useEffect)(()=>()=>{$.current&&clearTimeout($.current),Q.current&&Q.current.abort(),S.clear()},[]),(0,r.jsx)(tr,{onReset:eo,children:(0,r.jsxs)(x.KG,{maxWidth:"lg",sx:{flexGrow:1,display:"flex",flexDirection:"column"},children:[(0,r.jsx)(M.g,{links:[{name:"Home",href:p.f.dashboard.root},{name:"Import Data"}],sx:{mb:{xs:3,md:5}}}),(0,r.jsxs)(i.A,{spacing:3,children:[(0,r.jsx)(s.A,{children:(0,r.jsx)(o.A,{sx:{p:3},children:(0,r.jsx)(d.A,{activeStep:e,alternativeLabel:!0,children:z.map(e=>(0,r.jsx)(c.A,{children:(0,r.jsx)(u.A,{children:e})},e))})})}),L&&1!==e?(0,r.jsx)(s.A,{sx:{minHeight:400},children:(0,r.jsx)(T.x,{})}):(0,r.jsxs)(r.Fragment,{children:[0===e&&(0,r.jsx)(ep,{selectedType:a,onTypeSelect:J,onDownloadTemplate:Z}),1===e&&(0,r.jsx)(ee,{selectedType:a,uploadedFile:m,isProcessing:B,onFileSelect:er,onBack:es,importNotes:et}),2===e&&(0,r.jsx)(ta,{fileColumns:j,selectedType:a,columnMappings:w,onMappingChange:C,onNext:el,onBack:es}),3===e&&(0,r.jsx)(e0,{previewData:A,sampleData:N,columnMappings:w,isLoading:L,uploadProgress:V,retryStatus:K,onBack:es,onImport:ei,onDataEdit:en}),4===e&&(0,r.jsx)(ea,{importResult:_,onReset:eo,onBack:es})]})]})]})})}tr.propTypes={children:H().node.isRequired,onReset:H().func}},9449:(e,t,a)=>{Promise.resolve().then(a.bind(a,6297))},32383:()=>{},34300:(e,t,a)=>{"use strict";a.r(t),a.d(t,{SplashScreen:()=>s});var r=a(95155),l=a(34732),n=a(35881),i=a(6414);function s(e){let{portal:t=!0,sx:a,...n}=e,s=(0,r.jsx)("div",{style:{overflow:"hidden"},children:(0,r.jsx)(o,{sx:a,...n,children:(0,r.jsx)(i.AL,{})})});return t?(0,r.jsx)(l.A,{children:s}):s}let o=(0,n.default)("div")(e=>{let{theme:t}=e;return{right:0,bottom:0,zIndex:9998,width:"100%",height:"100%",display:"flex",position:"fixed",alignItems:"center",justifyContent:"center",backgroundColor:t.vars.palette.background.default}})},35046:(e,t,a)=>{"use strict";a.d(t,{KG:()=>r.DashboardContent}),a(57452);var r=a(39303)},67451:(e,t,a)=>{"use strict";a.r(t),a.d(t,{LoadingScreen:()=>s});var r=a(95155),l=a(34732),n=a(35881),i=a(7433);function s(e){let{portal:t,sx:a,...n}=e,s=(0,r.jsx)(o,{sx:a,...n,children:(0,r.jsx)(i.A,{color:"inherit",sx:{width:1,maxWidth:360}})});return t?(0,r.jsx)(l.A,{children:s}):s}let o=(0,n.default)("div")(e=>{let{theme:t}=e;return{flexGrow:1,width:"100%",display:"flex",minHeight:"100%",alignItems:"center",justifyContent:"center",paddingLeft:t.spacing(5),paddingRight:t.spacing(5)}})},69004:(e,t,a)=>{"use strict";a.d(t,{H:()=>d});var r=a(95155),l=a(11654),n=a(96801),i=a(35881),s=a(9670),o=a(27740);function d(e){var t,a,l,i,d,u,p,h,m,f,x,g;let{sx:v,imgUrl:y,action:j,filled:b,slotProps:S,description:w,title:C="No data",...A}=e;return(0,r.jsxs)(c,{filled:b,sx:v,...A,children:[(0,r.jsx)(n.A,{component:"img",alt:"Empty content",src:null!=y?y:"".concat(o.P.assetsDir,"/assets/icons/empty/ic-content.svg"),...null==S?void 0:S.img,sx:[{width:1,maxWidth:160},...Array.isArray(null==S||null==(t=S.img)?void 0:t.sx)?null!=(f=null==S||null==(a=S.img)?void 0:a.sx)?f:[]:[null==S||null==(l=S.img)?void 0:l.sx]]}),C&&(0,r.jsx)(s.default,{variant:"h6",...null==S?void 0:S.title,sx:[{mt:1,textAlign:"center",color:"text.disabled"},...Array.isArray(null==S||null==(i=S.title)?void 0:i.sx)?null!=(x=null==S||null==(d=S.title)?void 0:d.sx)?x:[]:[null==S||null==(u=S.title)?void 0:u.sx]],children:C}),w&&(0,r.jsx)(s.default,{variant:"body2",...null==S?void 0:S.description,sx:[{mt:1,textAlign:"center",color:"text.disabled"},...Array.isArray(null==S||null==(p=S.description)?void 0:p.sx)?null!=(g=null==S||null==(h=S.description)?void 0:h.sx)?g:[]:[null==S||null==(m=S.description)?void 0:m.sx]],children:w}),j&&j]})}let c=(0,i.default)("div",{shouldForwardProp:e=>!["filled","sx"].includes(e)})(e=>{let{filled:t,theme:a}=e;return{flexGrow:1,height:"100%",display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center",padding:a.spacing(0,3),...t&&{borderRadius:2*a.shape.borderRadius,backgroundColor:(0,l.IG)(a.vars.palette.grey["500Channel"],.04),border:"dashed 1px ".concat((0,l.IG)(a.vars.palette.grey["500Channel"],.08))}}})},82200:(e,t,a)=>{"use strict";a.d(t,{S:()=>r.SplashScreen,x:()=>l.LoadingScreen});var r=a(34300),l=a(67451)},83469:(e,t,a)=>{"use strict";a.d(t,{g:()=>j});var r=a(95155),l=a(35206),n=a(17764),i=a(72635),s=a(38867);function o(e){let{sx:t,label:a,...l}=e;return(0,r.jsxs)(n.A,{component:i.W,color:"inherit",underline:"none",sx:[e=>({verticalAlign:"middle",["& .".concat(s.M.root)]:{verticalAlign:"inherit",transform:"translateY(-2px)",ml:{xs:"-14px",md:"-18px"},transition:e.transitions.create(["opacity"],{duration:e.transitions.duration.shorter,easing:e.transitions.easing.sharp})},"&:hover":{["& .".concat(s.M.root)]:{opacity:.48}}}),...Array.isArray(t)?t:[t]],...l,children:[(0,r.jsx)(s.W,{width:18,icon:"eva:arrow-ios-back-fill"}),a]})}var d=a(35881);function c(e){let{links:t,sx:a,...l}=e;return(0,r.jsx)(u,{sx:a,...l,children:null==t?void 0:t.map(e=>(0,r.jsx)("li",{children:(0,r.jsx)(n.A,{href:e,variant:"body2",target:"_blank",rel:"noopener",children:e})},e))})}let u=(0,d.default)("ul")(()=>({display:"flex",flexDirection:"column","& > li":{display:"flex"}}));function p(e){let{href:t,icon:a,name:l,disabled:s,...o}=e,d=()=>(0,r.jsxs)(h,{disabled:s,...o,children:[a&&(0,r.jsx)(m,{children:a}),l]});return t?(0,r.jsx)(n.A,{component:i.W,href:t,color:"inherit",sx:{display:"inline-flex",...s&&{pointerEvents:"none"}},children:d()}):d()}let h=(0,d.default)("div",{shouldForwardProp:e=>!["disabled","sx"].includes(e)})(e=>{let{disabled:t,theme:a}=e;return{...a.typography.body2,alignItems:"center",gap:a.spacing(1),display:"inline-flex",color:a.vars.palette.text.primary,...t&&{cursor:"default",pointerEvents:"none",color:a.vars.palette.text.disabled}}}),m=(0,d.default)("span")(()=>({display:"inherit","& > :first-of-type:not(style):not(:first-of-type ~ *), & > style + *":{width:20,height:20}})),f=(0,d.default)("div")(e=>{let{theme:t}=e;return{display:"flex",flexDirection:"column",gap:t.spacing(2)}}),x=(0,d.default)("h6")(e=>{let{theme:t}=e;return{...t.typography.h4,margin:0,padding:0,display:"inline-flex"}}),g=(0,d.default)("div")(e=>{let{theme:t}=e;return{display:"flex",flexWrap:"wrap",gap:t.spacing(2),alignItems:"flex-start",justifyContent:"flex-end"}}),v=(0,d.default)("div")(e=>{let{theme:t}=e;return{display:"flex",flex:"1 1 auto",gap:t.spacing(2),flexDirection:"column"}}),y=(0,d.default)("span")(e=>{let{theme:t}=e;return{width:4,height:4,borderRadius:"50%",backgroundColor:t.vars.palette.text.disabled}});function j(e){var t,a;let{sx:n,action:i,backHref:s,heading:d,slots:u={},links:h=[],moreLinks:m=[],slotProps:j={},activeLast:b=!1,...S}=e,w=null==(t=h[h.length-1])?void 0:t.name;return(0,r.jsxs)(f,{sx:n,...S,children:[(0,r.jsxs)(g,{...null==j?void 0:j.container,children:[(0,r.jsxs)(v,{...null==j?void 0:j.content,children:[(d||s)&&(0,r.jsx)(x,{...null==j?void 0:j.heading,children:s?(0,r.jsx)(o,{href:s,label:d}):d}),(!!h.length||(null==u?void 0:u.breadcrumbs))&&(null!=(a=null==u?void 0:u.breadcrumbs)?a:(0,r.jsx)(l.A,{separator:(0,r.jsx)(y,{}),...null==j?void 0:j.breadcrumbs,children:h.map((e,t)=>{var a;return(0,r.jsx)(p,{icon:e.icon,href:e.href,name:e.name,disabled:e.name===w&&!b||!e.href},null!=(a=e.name)?a:t)})}))]}),i]}),!!(null==m?void 0:m.length)&&(0,r.jsx)(c,{links:m,...null==j?void 0:j.moreLinks})]})}},83686:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[3524,2051,2156,6635,3003,7433,8500,3683,1256,6292,7950,4515,1695,117,1641,2230,3807,4281,1457,204,779,3296,7587,6852,6244,6414,7594,6494,567,7452,5510,218,8441,1684,7358],()=>t(9449)),_N_E=e.O()}]);