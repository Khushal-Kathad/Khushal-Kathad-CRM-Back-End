(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7218],{17358:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>q});var l=a(95155),r=a(12115),n=a(35046),i=a(38543),s=a(66292),o=a(49742),d=a(32027),u=a(38867),c=a(83469),v=a(30832),p=a.n(v),x=a(11743),h=a(9670),f=a(78822),m=a(96801),g=a(53494),y=a(84256),D=a(7433),b=a(48731),j=a(69004);let w={approved:"success",pending:"warning",rejected:"error"},C=e=>{let{leavesData:t=[],leavesLoading:a,leavesError:n,onOpenDrawerHandler:i}=e,s=[{field:"LeaveType",headerName:"Leave Type",flex:1,minWidth:150,hideable:!1,renderCell:e=>{var t;return(0,l.jsx)(h.default,{variant:"inherit",className:"uppercase",children:null==e||null==(t=e.row)?void 0:t.LeaveType})}},{field:"StartDate",headerName:"Start Date",flex:1,minWidth:150,hideable:!1},{field:"EndDate",headerName:"End Date",flex:1,minWidth:150},{field:"Notes",headerName:"Notes",flex:1.5,minWidth:200,renderCell:e=>{var t,a;return(0,l.jsx)(f.default,{title:(null==e||null==(t=e.row)?void 0:t.Notes)||"No notes",arrow:!0,children:(0,l.jsx)(h.default,{variant:"inherit",sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",width:"100%"},children:(null==e||null==(a=e.row)?void 0:a.Notes)||"-"})})}},{field:"TotalDays",headerName:"Total Days",flex:1,minWidth:150,renderCell:e=>{var t,a;return(0,l.jsx)(h.default,{variant:"inherit",className:"uppercase",children:p()(null==e||null==(t=e.row)?void 0:t.EndDate).diff(p()(null==e||null==(a=e.row)?void 0:a.StartDate),"day")+1})}},{field:"Status",headerName:"Status",width:120,align:"center",headerAlign:"center",renderCell:e=>{var t;return(0,l.jsx)(b.JU,{variant:"soft",color:w[null==(t=e.row.Status)?void 0:t.toLowerCase()]||"default",children:e.row.Status})}},{field:"actions",headerName:"Actions",width:120,sortable:!1,filterable:!1,disableColumnMenu:!0,hideable:!1,align:"center",headerAlign:"center",renderCell:e=>{var t;let a=(null==(t=e.row.Status)?void 0:t.toLowerCase())==="pending";return(0,l.jsx)(m.A,{sx:{display:"flex",gap:2,justifyContent:"center"},children:(0,l.jsx)(f.default,{title:a?"Edit":"Only pending leaves can be edited",children:(0,l.jsx)("span",{children:(0,l.jsx)(g.default,{size:"small",onClick:()=>i(e.row.LeaveApplicationId),sx:{color:"primary.main"},disabled:!a,children:(0,l.jsx)(u.W,{icon:"solar:pen-bold",width:18})})})})})}}],[o,d]=(0,r.useState)({page:0,pageSize:8}),c=(0,r.useCallback)(e=>{d(e)},[]);return(0,l.jsx)(y.A,{sx:{minHeight:600,flexGrow:{md:1},display:{md:"flex"},height:{xs:800,md:"1px"},flexDirection:{md:"column"},overflow:"hidden"},children:(0,l.jsx)(x._,{rows:t,columns:s,getRowId:e=>e.LeaveApplicationId,loading:a,pagination:!0,paginationModel:o,onPaginationModelChange:c,pageSizeOptions:[5,8,10,25,50,100],disableVirtualization:!0,slots:{loadingOverlay:D.A,noRowsOverlay:()=>(0,l.jsx)(j.H,{}),noResultsOverlay:()=>(0,l.jsx)(j.H,{title:"No results found"})},showToolbar:!0,disableRowSelectionOnClick:!0,disablePivoting:!0,disableAggregation:!0,scrollbarSize:30,error:n,rowHeight:52,sx:{"& .MuiDataGrid-virtualScroller":{overflow:"auto"},"& .MuiDataGrid-pinnedColumnHeaders, & .MuiDataGrid-pinnedColumns":{backgroundColor:"background.paper",zIndex:1},"& .MuiDataGrid-pinnedColumnHeaders":{zIndex:2},"& .MuiDataGrid-columnHeaders":{display:"flex",alignItems:"center",borderTop:"2px solid",borderColor:"divider"},"& .MuiDataGrid-columnHeaderGroup":{display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"rgba(0, 0, 0, 0.04)",fontWeight:"bold"},"& .MuiDataGrid-groupHeaderCell":{justifyContent:"center",fontSize:"0.875rem",fontWeight:700,color:"primary.main"},"& .MuiDataGrid-columnHeaderTitle":{textAlign:"center",width:"100%"},"& .MuiDataGrid-cell":{borderRight:"1px solid",borderColor:"divider",display:"flex",alignItems:"center",justifyContent:"center"},"& .MuiDataGrid-row":{borderColor:"divider"},"& .MuiDataGrid-columnHeader":{borderColor:"divider"}}})})};var E=a(55594),A=a(40178),M=a.n(A),S=a(62177),L=a(90221),Y=a(68074),k=a(80158),N=a(2360),T=a(5551),H=a(74234),G=a(77308),I=a(54961);p().extend(M());let O=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return E.z.object({leaveType:E.z.string().min(1,{message:"Leave type is required"}),startDate:E.z.date({required_error:"Start date is required"}).refine(t=>e||p()(t).isSameOrAfter(p()(),"day"),{message:"Start date cannot be in the past"}),endDate:E.z.date({required_error:"End date is required"}),notes:E.z.string().optional()}).refine(e=>e.endDate>=e.startDate,{message:"End date cannot be before start date",path:["endDate"]})};O(!1);let W=e=>{let{open:t,onClose:a,getLeaveMutation:n,leaveId:o}=e,{userData:c}=(0,G._)(),{leaveData:v,leaveLoading:x,getLeaveMutation:y}=(0,d.$u)(t&&o?o:null);(0,r.useEffect)(()=>{t&&o&&y()},[t,o,y]);let b=(0,r.useMemo)(()=>({leaveType:(null==v?void 0:v.LeaveType)||"",startDate:(null==v?void 0:v.StartDate)?p()(v.StartDate).toDate():null,endDate:(null==v?void 0:v.EndDate)?p()(v.EndDate).toDate():null,notes:(null==v?void 0:v.Notes)||"",...v}),[v]),j=(0,S.mN)({mode:"all",resolver:(0,L.u)(O(!!o)),defaultValues:b}),{reset:w,watch:C,handleSubmit:E,formState:{isSubmitting:A}}=j,M=C("startDate"),W=C("endDate"),R=(0,r.useMemo)(()=>M&&W&&p()(M).isValid()&&p()(W).isValid()&&p()(W).isSameOrAfter(p()(M))?p()(W).diff(p()(M),"day")+1:0,[M,W]),q=(0,r.useRef)(b);(0,r.useEffect)(()=>{q.current=b},[b]);let z=(0,r.useCallback)(()=>{w(q.current)},[w]);(0,r.useEffect)(()=>{t&&o&&v?w(b):t&&!o&&w({leaveType:"",startDate:null,endDate:null,notes:""})},[t,o,v,w,b]);let P=E(async e=>{try{let t={EmployeeId:null==c?void 0:c.id,LeaveType:e.leaveType,StartDate:p()(M).format("YYYY-MM-DDTHH:mm:ss.SSS[Z]"),EndDate:p()(W).format("YYYY-MM-DDTHH:mm:ss.SSS[Z]"),Status:"Pending"};e.notes&&e.notes.trim()&&(t.Notes=e.notes);let{LeaveApplicationId:l}=await (0,H.hy)(t);n(),i.oR.success("Leave request ".concat(l," created successfully!")),a()}catch(e){console.error("Error creating leave request:",e),i.oR.error("Error creating leave request!")}}),Z=E(async e=>{try{let t={LeaveType:e.leaveType,StartDate:p()(e.startDate).format("YYYY-MM-DDTHH:mm:ss.SSS[Z]"),EndDate:p()(e.endDate).format("YYYY-MM-DDTHH:mm:ss.SSS[Z]"),EmployeeId:v.EmployeeId,BackupEmployeeId:v.BackupEmployeeId,AutoReassign:v.AutoReassign,Notes:e.notes&&e.notes.trim()?e.notes:v.Notes||"",Status:v.Status},{LeaveApplicationId:l}=await (0,H.MH)({leaveData:t,id:o});n(),i.oR.success("Leave request ".concat(l," created successfully!")),a()}catch(e){console.error("Error creating leave request:",e),i.oR.error("Error creating leave request!")}}),_=async e=>{o?await Z(e):await P(e)};return(0,l.jsxs)(T.Ay,{anchor:"right",open:t,onClose:a,slotProps:{backdrop:{invisible:!0}},PaperProps:{sx:{width:500,maxWidth:"vw",display:"flex",flexDirection:"column",height:"100%"}},transitionDuration:300,children:[(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(m.A,{sx:{py:2,pr:1,pl:2.5,display:"flex",alignItems:"center"},children:[(0,l.jsxs)(h.default,{variant:"h6",sx:{flexGrow:1},children:[o?"Edit":"Create New","  Leave Request"]}),(0,l.jsx)(f.default,{title:"Reset Form",arrow:!0,children:(0,l.jsx)(g.default,{onClick:z,children:(0,l.jsx)(u.W,{icon:"solar:restart-bold",width:24,height:24})})}),(0,l.jsx)(g.default,{onClick:a,children:(0,l.jsx)(u.W,{icon:"mingcute:close-line",width:24,height:24})})]}),(0,l.jsx)(k.default,{sx:{borderStyle:"dashed"}})]}),x?(0,l.jsx)(D.A,{}):(0,l.jsxs)(I.lV,{methods:j,onSubmit:_,children:[(0,l.jsxs)(m.A,{sx:{display:"flex",flexDirection:"column",gap:2,flexGrow:1,height:"100%",p:2},children:[(0,l.jsx)(I.D0.Select,{name:"leaveType",label:"Leave Type",required:!0,children:["Annual Leave","Sick Leave","Maternity Leave","Unpaid Leave"].map(e=>(0,l.jsx)(N.default,{value:e,children:e},e))}),(0,l.jsxs)(m.A,{sx:{display:"flex",gap:2},children:[(0,l.jsx)(I.D0.DatePicker2,{name:"startDate",label:"Start Date"}),(0,l.jsx)(I.D0.DatePicker2,{name:"endDate",label:"End Date"})]}),(0,l.jsxs)(h.default,{variant:"body2",children:["Total Days: ",R]}),(0,l.jsx)(I.D0.Text,{name:"notes",label:"Notes",placeholder:"Add any notes here...",multiline:!0,rows:4})]}),(0,l.jsxs)(m.A,{sx:{p:2,display:"flex",justifyContent:"flex-end",gap:2},children:[(0,l.jsx)(s.default,{onClick:a,color:"inherit",variant:"outlined",children:"Cancel"}),(0,l.jsx)(Y.default,{type:"submit",variant:"contained",loading:A,children:A?o?"Editing...":"Creating...":o?"Edit":"Create"})]})]}),(0,l.jsx)(i.N9,{position:"top-right",autoClose:2e3})]})},R=()=>{let[e,t]=(0,r.useState)(!1),[a,v]=(0,r.useState)(),{leavesData:p,leavesError:x,leavesLoading:h,getLeaveMutation:f}=(0,d.HY)(),m=(0,r.useCallback)(e=>{v(e),t(!0)},[]);return(0,l.jsxs)(n.KG,{maxWidth:"xl",children:[(0,l.jsx)(c.g,{links:[{name:"Home",href:o.f.dashboard.employee.leave},{name:"Employee Leave"}],action:(0,l.jsx)(s.default,{variant:"contained",color:"inherit",size:"small",onClick:()=>m(),startIcon:(0,l.jsx)(u.W,{icon:"ph:plus-bold"}),children:"New Leave Request"}),sx:{mb:{xs:2,md:2}}}),(0,l.jsx)(W,{open:e,onClose:()=>{t(!1)},getLeaveMutation:f,leaveId:a}),(0,l.jsx)(C,{leavesData:p||[],leavesLoading:h,leavesError:x,onOpenDrawerHandler:m}),(0,l.jsx)(i.N9,{position:"top-right",autoClose:3e3})]})},q=function(){return(0,l.jsx)(n.KG,{maxWidth:"xl",children:(0,l.jsx)(R,{})})}},32027:(e,t,a)=>{"use strict";a.d(t,{$u:()=>v,HY:()=>d,TU:()=>c,Xl:()=>u});var l=a(19169),r=a(30832),n=a.n(r),i=a(12115),s=a(18835);let o={revalidateIfStale:!1,revalidateOnFocus:!1,revalidateOnReconnect:!1};function d(){let e=s.vZ.leaveManagement.leaveApplication,{data:t,isLoading:a,error:r,isValidating:d,mutate:u}=(0,l.Ay)(e,s.GO,o),c=n()().format("YYYY-MM-DD"),v=(t||[]).map(e=>({...e,totalDays:n()(e.EndDate).diff(n()(e.startDate),"day")+1,isTodayLeave:n()(e.EndDate).format("YYYY-MM-DD")===c})),p=(0,i.useCallback)(()=>u(),[u]);return(0,i.useMemo)(()=>({leavesData:null!=v?v:[],leavesLoading:a||d,leavesError:r?(null==r?void 0:r.message)||"Error fetching data":null,leavesValidating:d,leavesEmpty:!a&&!d&&(!Array.isArray(v)||0===v.length),getLeaveMutation:p}),[r,a,d,v,p])}function u(){let e=s.vZ.leaveManagement.leaveApplicationWithEmployeeDetails,{data:t,isLoading:a,error:r,isValidating:d,mutate:u}=(0,l.Ay)(e,s.GO,o),c=n()().format("YYYY-MM-DD"),v=(t||[]).map(e=>({...e,totalDays:n()(e.EndDate).diff(n()(e.startDate),"day")+1,isTodayLeave:n()(e.EndDate).format("YYYY-MM-DD")===c})),p=(0,i.useCallback)(()=>u(),[u]);return(0,i.useMemo)(()=>({leavesData:null!=v?v:[],leavesLoading:a||d,leavesError:r?(null==r?void 0:r.message)||"Error fetching data":null,leavesValidating:d,leavesEmpty:!a&&!d&&(!Array.isArray(v)||0===v.length),getLeaveMutation:p}),[r,a,d,v,p])}function c(){let e={total:s.vZ.leaveManagement.totalLeaves,pending:s.vZ.leaveManagement.pendingLeaves,approved:s.vZ.leaveManagement.approvedLeaves,rejected:s.vZ.leaveManagement.rejectedLeaves},{data:t,isLoading:a,error:r,isValidating:n,mutate:d}=(0,l.Ay)(e,async e=>Object.fromEntries(await Promise.all(Object.entries(e).map(async e=>{let[t,a]=e;return[t,await (0,s.GO)(a)]}))),o),u=(0,i.useCallback)(()=>d(),[d]);return(0,i.useMemo)(()=>({leavesData:t,leavesLoading:a,leavesError:r?(null==r?void 0:r.message)||"Error fetching data":null,leavesValidating:n,leavesEmpty:!1,refetchLeaves:u}),[r,a,n,t,u])}function v(e){let t=e?s.vZ.employee.getLeave(e):null,{data:a,isLoading:r,error:n,isValidating:d,mutate:u}=(0,l.Ay)(t,s.GO,o),c=(0,i.useCallback)(()=>u(),[u]);return(0,i.useMemo)(()=>({leaveData:null!=a?a:[],leaveLoading:r,leaveError:n?(null==n?void 0:n.message)||"Error fetching infras":null,leaveValidating:d,leaveEmpty:!r&&!d&&(!Array.isArray(a)||0===a.length),getLeaveMutation:c}),[a,n,r,d,c])}},53560:(e,t,a)=>{Promise.resolve().then(a.bind(a,17358))},69004:(e,t,a)=>{"use strict";a.d(t,{H:()=>d});var l=a(95155),r=a(11654),n=a(96801),i=a(35881),s=a(9670),o=a(27740);function d(e){var t,a,r,i,d,c,v,p,x,h,f,m;let{sx:g,imgUrl:y,action:D,filled:b,slotProps:j,description:w,title:C="No data",...E}=e;return(0,l.jsxs)(u,{filled:b,sx:g,...E,children:[(0,l.jsx)(n.A,{component:"img",alt:"Empty content",src:null!=y?y:"".concat(o.P.assetsDir,"/assets/icons/empty/ic-content.svg"),...null==j?void 0:j.img,sx:[{width:1,maxWidth:160},...Array.isArray(null==j||null==(t=j.img)?void 0:t.sx)?null!=(h=null==j||null==(a=j.img)?void 0:a.sx)?h:[]:[null==j||null==(r=j.img)?void 0:r.sx]]}),C&&(0,l.jsx)(s.default,{variant:"h6",...null==j?void 0:j.title,sx:[{mt:1,textAlign:"center",color:"text.disabled"},...Array.isArray(null==j||null==(i=j.title)?void 0:i.sx)?null!=(f=null==j||null==(d=j.title)?void 0:d.sx)?f:[]:[null==j||null==(c=j.title)?void 0:c.sx]],children:C}),w&&(0,l.jsx)(s.default,{variant:"body2",...null==j?void 0:j.description,sx:[{mt:1,textAlign:"center",color:"text.disabled"},...Array.isArray(null==j||null==(v=j.description)?void 0:v.sx)?null!=(m=null==j||null==(p=j.description)?void 0:p.sx)?m:[]:[null==j||null==(x=j.description)?void 0:x.sx]],children:w}),D&&D]})}let u=(0,i.default)("div",{shouldForwardProp:e=>!["filled","sx"].includes(e)})(e=>{let{filled:t,theme:a}=e;return{flexGrow:1,height:"100%",display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center",padding:a.spacing(0,3),...t&&{borderRadius:2*a.shape.borderRadius,backgroundColor:(0,r.IG)(a.vars.palette.grey["500Channel"],.04),border:"dashed 1px ".concat((0,r.IG)(a.vars.palette.grey["500Channel"],.08))}}})},83469:(e,t,a)=>{"use strict";a.d(t,{g:()=>D});var l=a(95155),r=a(35206),n=a(17764),i=a(72635),s=a(38867);function o(e){let{sx:t,label:a,...r}=e;return(0,l.jsxs)(n.A,{component:i.W,color:"inherit",underline:"none",sx:[e=>({verticalAlign:"middle",["& .".concat(s.M.root)]:{verticalAlign:"inherit",transform:"translateY(-2px)",ml:{xs:"-14px",md:"-18px"},transition:e.transitions.create(["opacity"],{duration:e.transitions.duration.shorter,easing:e.transitions.easing.sharp})},"&:hover":{["& .".concat(s.M.root)]:{opacity:.48}}}),...Array.isArray(t)?t:[t]],...r,children:[(0,l.jsx)(s.W,{width:18,icon:"eva:arrow-ios-back-fill"}),a]})}var d=a(35881);function u(e){let{links:t,sx:a,...r}=e;return(0,l.jsx)(c,{sx:a,...r,children:null==t?void 0:t.map(e=>(0,l.jsx)("li",{children:(0,l.jsx)(n.A,{href:e,variant:"body2",target:"_blank",rel:"noopener",children:e})},e))})}let c=(0,d.default)("ul")(()=>({display:"flex",flexDirection:"column","& > li":{display:"flex"}}));function v(e){let{href:t,icon:a,name:r,disabled:s,...o}=e,d=()=>(0,l.jsxs)(p,{disabled:s,...o,children:[a&&(0,l.jsx)(x,{children:a}),r]});return t?(0,l.jsx)(n.A,{component:i.W,href:t,color:"inherit",sx:{display:"inline-flex",...s&&{pointerEvents:"none"}},children:d()}):d()}let p=(0,d.default)("div",{shouldForwardProp:e=>!["disabled","sx"].includes(e)})(e=>{let{disabled:t,theme:a}=e;return{...a.typography.body2,alignItems:"center",gap:a.spacing(1),display:"inline-flex",color:a.vars.palette.text.primary,...t&&{cursor:"default",pointerEvents:"none",color:a.vars.palette.text.disabled}}}),x=(0,d.default)("span")(()=>({display:"inherit","& > :first-of-type:not(style):not(:first-of-type ~ *), & > style + *":{width:20,height:20}})),h=(0,d.default)("div")(e=>{let{theme:t}=e;return{display:"flex",flexDirection:"column",gap:t.spacing(2)}}),f=(0,d.default)("h6")(e=>{let{theme:t}=e;return{...t.typography.h4,margin:0,padding:0,display:"inline-flex"}}),m=(0,d.default)("div")(e=>{let{theme:t}=e;return{display:"flex",flexWrap:"wrap",gap:t.spacing(2),alignItems:"flex-start",justifyContent:"flex-end"}}),g=(0,d.default)("div")(e=>{let{theme:t}=e;return{display:"flex",flex:"1 1 auto",gap:t.spacing(2),flexDirection:"column"}}),y=(0,d.default)("span")(e=>{let{theme:t}=e;return{width:4,height:4,borderRadius:"50%",backgroundColor:t.vars.palette.text.disabled}});function D(e){var t,a;let{sx:n,action:i,backHref:s,heading:d,slots:c={},links:p=[],moreLinks:x=[],slotProps:D={},activeLast:b=!1,...j}=e,w=null==(t=p[p.length-1])?void 0:t.name;return(0,l.jsxs)(h,{sx:n,...j,children:[(0,l.jsxs)(m,{...null==D?void 0:D.container,children:[(0,l.jsxs)(g,{...null==D?void 0:D.content,children:[(d||s)&&(0,l.jsx)(f,{...null==D?void 0:D.heading,children:s?(0,l.jsx)(o,{href:s,label:d}):d}),(!!p.length||(null==c?void 0:c.breadcrumbs))&&(null!=(a=null==c?void 0:c.breadcrumbs)?a:(0,l.jsx)(r.A,{separator:(0,l.jsx)(y,{}),...null==D?void 0:D.breadcrumbs,children:p.map((e,t)=>{var a;return(0,l.jsx)(v,{icon:e.icon,href:e.href,name:e.name,disabled:e.name===w&&!b||!e.href},null!=(a=e.name)?a:t)})}))]}),i]}),!!(null==x?void 0:x.length)&&(0,l.jsx)(u,{links:x,...null==D?void 0:D.moreLinks})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[544,5004,277,2051,2156,6635,3003,7433,8500,3683,1256,6292,7950,4515,1695,117,1641,2230,3807,4281,1457,9912,9243,2987,2973,204,119,779,3296,1743,8419,6414,7594,6494,567,7452,5510,218,4961,9669,8441,1684,7358],()=>t(53560)),_N_E=e.O()}]);