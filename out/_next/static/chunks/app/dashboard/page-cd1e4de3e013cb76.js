(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5105],{16531:(e,l,t)=>{"use strict";t.d(l,{XL:()=>o,Y3:()=>n,qP:()=>r});var a=t(18835);let o=async e=>{try{return(await a.Ay.post(a.vZ.followups.createFollowup,e)).data}catch(e){var l,t,o;if(console.error("Error (createFollowUp) : ",(null==(l=e.response)?void 0:l.data)||e),e.response)throw(null==(t=e.response.data)?void 0:t.detail)||(null==(o=e.response.data)?void 0:o.message)||"Server error: ".concat(e.response.status);if(e.request)throw"Network error: Unable to reach the server (CORS or server may be down)";throw e.message||"Error creating follow-up"}},n=async(e,l)=>{try{console.log("=== API UPDATE FOLLOW-UP REQUEST ==="),console.log("Endpoint:",a.vZ.followups.updateFollowup(l)),console.log("Follow-up ID:",l),console.log("Request Body:",JSON.stringify(e,null,2));let t=await a.Ay.put(a.vZ.followups.updateFollowup(l),e);return console.log("=== API UPDATE FOLLOW-UP RESPONSE ==="),console.log("Response:",t.data),t.data}catch(e){var t,o,n;if(console.error("Error (updateFollowUp) : ",(null==(t=e.response)?void 0:t.data)||e),e.response)throw(null==(o=e.response.data)?void 0:o.detail)||(null==(n=e.response.data)?void 0:n.message)||"Server error: ".concat(e.response.status);if(e.request)throw"Network error: Unable to reach the server (CORS or server may be down)";throw e.message||"Error updating follow-up"}},r=async e=>{try{return(await a.Ay.delete(a.vZ.followups.deleteFollowup(e))).data}catch(e){var l,t,o;if(console.error("Error (deleteFollowUp) : ",(null==(l=e.response)?void 0:l.data)||e),e.response)throw(null==(t=e.response.data)?void 0:t.detail)||(null==(o=e.response.data)?void 0:o.message)||"Server error: ".concat(e.response.status);if(e.request)throw"Network error: Unable to reach the server (CORS or server may be down)";throw e.message||"Error deleting follow-up"}}},20991:(e,l,t)=>{"use strict";function a(e,l){return l.split(".").reduce((e,l)=>e&&e[l],e)}function o(e,l,t){let o=a(e,t),n=a(l,t);return n<o?-1:+(n>o)}function n(e,l){return"desc"===e?(e,t)=>o(e,t,l):(e,t)=>-o(e,t,l)}t.d(l,{nz:()=>w,cY:()=>g,V2:()=>j,F2:()=>v,gR:()=>y,Sb:()=>b,hz:()=>n,K2:()=>s});var r=t(12115);function s(e){var l,t,a,o,n;let[s,i]=(0,r.useState)(!!(null==e?void 0:e.defaultDense)),[d,u]=(0,r.useState)(null!=(l=null==e?void 0:e.defaultCurrentPage)?l:0),[c,p]=(0,r.useState)(null!=(t=null==e?void 0:e.defaultOrderBy)?t:"customerName"),[m,h]=(0,r.useState)(null!=(a=null==e?void 0:e.defaultRowsPerPage)?a:5),[x,f]=(0,r.useState)(null!=(o=null==e?void 0:e.defaultOrder)?o:"asc"),[v,g]=(0,r.useState)(null!=(n=null==e?void 0:e.defaultSelected)?n:[]),b=(0,r.useCallback)(e=>{let l=c===e&&"asc"===x;""!==e&&(f(l?"desc":"asc"),p(e))},[x,c]),y=(0,r.useCallback)(e=>{g(v.includes(e)?v.filter(l=>l!==e):[...v,e])},[v]),w=(0,r.useCallback)(e=>{u(0),h(parseInt(e.target.value,10))},[]),j=(0,r.useCallback)(e=>{i(e.target.checked)},[]),C=(0,r.useCallback)((e,l)=>{if(e)return void g(l);g([])},[]),A=(0,r.useCallback)((e,l)=>{u(l)},[]),S=(0,r.useCallback)(()=>{u(0)},[]),I=(0,r.useCallback)(e=>{g([]),d&&e<2&&u(d-1)},[d]),D=(0,r.useCallback)((e,l)=>{let t=v.length;g([]),d&&(t===e?u(d-1):t===l?u(0):t>e&&u(Math.ceil((l-t)/m)-1))},[d,m,v.length]);return{dense:s,order:x,page:d,orderBy:c,rowsPerPage:m,selected:v,onSelectRow:y,onSelectAllRows:C,onSort:b,onChangePage:A,onChangeDense:j,onResetPage:S,onChangeRowsPerPage:w,onUpdatePageDeleteRow:I,onUpdatePageDeleteRows:D,setPage:u,setDense:i,setOrder:f,setOrderBy:p,setSelected:g,setRowsPerPage:h}}var i=t(95155);t(69004);var d=t(96801),u=t(21030),c=t(55398),p=t(17764),m=t(9670),h=t(72635),x=t(31224),f=t(32104);let v=(0,r.memo)(function(e){var l;let{params:t,href:a,emptyValue:o="—"}=e,n=null==t||null==(l=t.row)?void 0:l[t.field];return null==n||""===n?(0,i.jsx)("span",{children:o}):(0,i.jsx)(p.A,{component:h.W,href:a,color:"inherit",variant:"subtitle2",sx:{"&:hover":{color:"primary.main"},overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",textTransform:"capitalize"},children:n})}),g=(0,r.memo)(function(e){var l,t;let{params:a,href:o,emptyValue:n="—"}=e;if((null==a||null==(l=a.rowNode)?void 0:l.type)==="group")return(0,i.jsx)(m.default,{variant:"subtitle2",sx:{fontWeight:600},children:a.value||n});let r=null==a||null==(t=a.row)?void 0:t.customerName;if(!r)return(0,i.jsxs)(d.A,{sx:{display:"flex",alignItems:"center",minWidth:1,py:1},children:[(0,i.jsx)(c.A,{sx:{width:30,height:30,mr:2,fontSize:"0.875rem"}}),(0,i.jsx)("span",{children:n})]});let s=r.charAt(0).toUpperCase();return(0,i.jsxs)(d.A,{sx:{display:"flex",alignItems:"center",minWidth:1,py:1},children:[(0,i.jsx)(c.A,{alt:r,sx:{width:30,height:30,mr:2,fontSize:"0.875rem"},children:s}),(0,i.jsx)(p.A,{component:h.W,href:o,variant:"body2",color:"inherit",sx:{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical","&:hover":{color:"primary.main"},textTransform:"capitalize"},children:r})]})}),b=(0,r.memo)(function(e){var l,t;let{params:a,emptyValue:o="—"}=e;if((null==a||null==(l=a.rowNode)?void 0:l.type)==="group")return(0,i.jsx)(m.default,{variant:"subtitle2",sx:{fontWeight:600,textTransform:"capitalize"},children:a.value||o});let n=null==a||null==(t=a.row)?void 0:t[a.field];if(null==n||""===n)return(0,i.jsx)("span",{children:o});let r="string"==typeof n?n:String(n);return(0,i.jsx)(m.default,{variant:"body2",color:"inherit",sx:{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",wordBreak:"break-word"},children:r})}),y=(0,r.memo)(function(e){var l,t;let{params:a,emptyValue:o="—"}=e;if((null==a||null==(l=a.rowNode)?void 0:l.type)==="group")return(0,i.jsx)(m.default,{variant:"subtitle2",sx:{fontWeight:600},children:a.value||o});let n=null==a||null==(t=a.row)?void 0:t[a.field];return null==n||""===n?(0,i.jsx)("span",{children:o}):(0,i.jsx)(m.default,{variant:"body2",color:"inherit",sx:{fontVariantNumeric:"tabular-nums",textAlign:"right",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:n})}),w=(0,r.memo)(function(e){var l;let{params:t,emptyValue:a="—"}=e,o=null==t||null==(l=t.row)?void 0:l[t.field];return null==o||""===o?(0,i.jsx)("span",{children:a}):(0,i.jsx)(m.default,{variant:"body2",color:"inherit",sx:{fontVariantNumeric:"tabular-nums",textAlign:"right",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:(0,x.KZ)(o)})}),j=(0,r.memo)(function(e){var l;let{params:t,emptyValue:a="—",showTime:o=!0}=e,n=null==t||null==(l=t.row)?void 0:l[t.field];return!n||isNaN(new Date(n).getTime())?(0,i.jsx)("span",{children:a}):(0,i.jsxs)(u.A,{spacing:.5,alignItems:"flex-start",children:[(0,i.jsx)(m.default,{variant:"body2",children:(0,f.ts)(n)}),o&&(0,i.jsx)(m.default,{variant:"caption",color:"text.secondary",children:(0,f.qi)(n)})]})})},31847:(e,l,t)=>{"use strict";t.d(l,{I4:()=>D,JT:()=>C,KI:()=>A,Li:()=>I,ND:()=>x,Nz:()=>f,Oe:()=>y,Pu:()=>d,T7:()=>m,Xk:()=>n,c5:()=>w,dk:()=>v,eD:()=>b,eX:()=>S,en:()=>i,h0:()=>a,ie:()=>h,mA:()=>u,nz:()=>s,o4:()=>N,oU:()=>p,rl:()=>r,z4:()=>g,zR:()=>o,zf:()=>c});let a=[{value:"single",label:"Single Floor"},{value:"multiple",label:"Multiple Floor"}],o=[{value:"residential",label:"Residential"},{value:"commercial",label:"Commercial"},{value:"mixed",label:"Mixed Use"}],n=[{value:"available",label:"Available"},{value:"sold",label:"Sold"},{value:"reserved",label:"Reserved"},{value:"blocked",label:"Blocked"}],r=[{value:"north",label:"North"},{value:"south",label:"South"},{value:"east",label:"East"},{value:"west",label:"West"},{value:"northeast",label:"North East"},{value:"northwest",label:"North West"},{value:"southeast",label:"South East"},{value:"southwest",label:"South West"}],s=[{value:"garden",label:"Garden View"},{value:"city",label:"City View"},{value:"sea",label:"Sea View"},{value:"mountain",label:"Mountain View"},{value:"pool",label:"Pool View"},{value:"road",label:"Road View"}],i=[{label:"1 BHK",value:"1 BHK"},{label:"2 BHK",value:"2 BHK"},{label:"3 BHK",value:"3 BHK"},{label:"4 BHK",value:"4 BHK"},{label:"Studio Apartment",value:"Studio Apartment"},{label:"Penthouse",value:"Penthouse"},{label:"Duplex",value:"Duplex"},{label:"Triplex",value:"Triplex"},{label:"Office Space",value:"Office Space"},{label:"Retail Shop",value:"Retail Shop"},{label:"Coworking Space",value:"Coworking Space"},{label:"Showroom",value:"Showroom"},{label:"Row House",value:"Row House"},{label:"Bungalow",value:"Bungalow"},{label:"Farmhouse",value:"Farmhouse"},{label:"Factory Unit",value:"Factory Unit"},{label:"Warehouse/Storage",value:"Warehouse/Storage"},{label:"None/Unknown",value:null}],d=["North","South","East","West","Northeast","Northwest","Southeast","Southwest"],u=[{label:"Available",value:"Available"},{label:"Booked",value:"Booked"},{label:"Purchased",value:"Purchased"},{label:"Sold",value:"Sold"},{label:"None/Unknown",value:null}],c=["Garden View","City View","Sea View","Lake View","Mountain View","Pool View","Street View","Main Road View","Open Land View","Forest View","Industrial Area View","Highway View"],p={available:"success",booked:"warning",purchased:"info",sold:"error"},m=[{label:"New",value:"New"},{label:"Completed",value:"Completed"}],h=[{label:"Today",value:"today"},{label:"This week",value:"this_week"},{label:"Overdue",value:"overdue"}],x={New:{color:"secondary",label:"New"},Completed:{color:"success",label:"Completed"}},f=[{value:"Call",label:"Call"},{value:"Text/SMS",label:"Text/SMS"},{value:"Email",label:"Email"},{value:"Meeting",label:"Meeting"},{value:"Other",label:"Other"}],v=[{value:"Pending",label:"Pending"},{value:"Completed",label:"Completed"},{value:"Cancelled",label:"Cancelled"},{value:"Rescheduled",label:"Rescheduled"},{value:"No Response",label:"No Response"}],g=[{group:"",classify:["New","Win","Lost","Visit","Stale","Qualify"]}],b=[{label:"New",value:"New"},{label:"Win",value:"Win"},{label:"Lost",value:"Lost"},{label:"Visit",value:"Visit"},{label:"Stale",value:"Stale"},{label:"Qualify",value:"Qualify"}],y=[{group:"Social Media(Specific)",classify:["Facebook","Instagram","Twitter/X","YouTube","WhatsApp","Reddit"]},{group:"Offline",classify:["Broker","Walk-in","Event/Expo","Networking","Print Advertisement"]},{group:"Online",classify:["Housing.com","Website","Email Campaign","Online Ads","Webinar","Social Media"]},{group:"Referral & Partner",classify:["Referral","Partner","Existing Customer","Employee Referral"]},{group:"Direct Outreach",classify:["Cold Call","Direct Mail","Door-to-Door Sales","Sales Team Outreach"]},{group:"Other",classify:["Other"]}],w=[{label:"Scheduled",value:"Scheduled"},{label:"Rescheduled",value:"Rescheduled"},{label:"Completed",value:"Completed"},{label:"Cancelled",value:"Cancelled"}],j=e=>({label:e,value:e}),C=["Property Viewing","Property Valuation","Market Analysis","Listing Consultation","Buyer Consultation","Property Inspection","Comparative Market Analysis","Investment Analysis","Rental Assessment","Final Walkthrough","Key Handover","Document Signing","Site Measurement","Photography/Marketing","Open House Preparation","Neighborhood Tour","Follow-up Visit","Client Meeting","Other"].map(j),A=["Positive","Neutral","Negative"].map(j),S={OVERDUE:"overdue",TODAY:"today",THIS_WEEK:"this_week",SCHEDULED:"scheduled",NONE:"none"},I={[S.OVERDUE]:"Overdue",[S.TODAY]:"Today",[S.THIS_WEEK]:"This Week",[S.SCHEDULED]:"Scheduled",[S.NONE]:"None"},D=e=>{if(!e)return S.NONE;let l=e.toLowerCase().trim().replace(/\s+/g,"_");return Object.values(S).includes(l)?l:S.NONE},N=function(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;switch(D(e)){case S.OVERDUE:return{label:"⚠️ ".concat(l||1,"d overdue"),emoji:"⚠️",text:"".concat(l||1,"d overdue"),color:"error"};case S.TODAY:return{label:"\uD83D\uDCC5 Due Today",emoji:"\uD83D\uDCC5",text:"Due Today",color:"warning"};case S.THIS_WEEK:return{label:"\uD83D\uDDD3️ This Week",emoji:"\uD83D\uDDD3️",text:"This Week",color:"warning"};case S.SCHEDULED:if(t){let e=new Date,l=Math.ceil((new Date(t)-e)/864e5);if(l>0&&l<=7)return{label:"✅ In ".concat(l,"d"),emoji:"✅",text:"In ".concat(l,"d"),color:"info"};return{label:"✅ Scheduled",emoji:"✅",text:"Scheduled",color:"info",date:t}}return{label:"✅ Scheduled",emoji:"✅",text:"Scheduled",color:"info"};case S.NONE:default:return{label:"—",emoji:"",text:"—",color:"default"}}}},32868:(e,l,t)=>{"use strict";t.d(l,{CE:()=>s,m5:()=>d});var a=t(19169),o=t(12115),n=t(18835);let r={revalidateIfStale:!1,revalidateOnFocus:!1,revalidateOnReconnect:!1};function s(e){let l=e?n.vZ.followups.readSingle(e):null,{data:t,isLoading:s,error:i,isValidating:d,mutate:u}=(0,a.Ay)(l,n.GO,r);return(0,o.useMemo)(()=>({followUpData:null!=t?t:[],followUpLoading:s,followUpError:i?(null==i?void 0:i.message)||"Error fetching data":null,followUpValidating:d,followUpEmpty:!s&&!d&&(!Array.isArray(t)||0===t.length),getFollowUpMutation:u}),[t,i,s,d,u])}let i=async e=>{try{return(await n.Ay.get(e)).data}catch(o){var l,t;if("string"==typeof o&&("No follow-ups found"===o||o.toLowerCase().includes("no follow-ups found")||o.toLowerCase().includes("not found")||""===o))return[];let a=(null==o||null==(t=o.response)||null==(l=t.data)?void 0:l.detail)||(null==o?void 0:o.message)||o||"";if("string"==typeof a&&("No follow-ups found"===a||a.toLowerCase().includes("no follow-ups found")||a.toLowerCase().includes("not found")))return[];throw console.error("Failed to fetch (".concat(e,"):"),o),o}};function d(e){let l=e?n.vZ.followups.readByLead(e):null,{data:t,isLoading:s,error:d,isValidating:u,mutate:c}=(0,a.Ay)(l,i,r);return(0,o.useMemo)(()=>({followUpsByLeadData:null!=t?t:[],followUpsByLeadLoading:s,followUpsByLeadError:d?(null==d?void 0:d.message)||"Error fetching data":null,followUpsByLeadIsValidating:u,followUpsByLeadEmpty:!s&&!u&&(!Array.isArray(t)||0===t.length),refetchFollowUpsByLead:()=>c()}),[t,s,d,u,c])}},45375:(e,l,t)=>{"use strict";t.d(l,{d:()=>p,Q:()=>c});var a=t(95155),o=t(38637),n=t.n(o),r=t(96801),s=t(45282),i=t(50178),d=t(44192),u=t(88660);function c(e){let{children:l,slotProps:t,sx:o,...n}=e;return(0,a.jsx)(d.A,{sx:[e=>({gap:{sm:0},minHeight:38,flexShrink:0,alignItems:"center",bgcolor:"background.neutral",["& .".concat(u.A.scroller)]:{p:1,...null==t?void 0:t.scroller},["& .".concat(u.A.flexContainer)]:{gap:0,...null==t?void 0:t.flexContainer},["& .".concat(u.A.scrollButtons)]:{borderRadius:1,minHeight:"inherit",...null==t?void 0:t.scrollButtons},["& .".concat(u.A.indicator)]:{py:1,height:1,bgcolor:"transparent","& > span":{width:1,height:1,borderRadius:1,display:"block",bgcolor:"common.white",boxShadow:e.vars.customShadows.z1,...e.applyStyles("dark",{bgcolor:"grey.900"}),...null==t?void 0:t.indicator}},["& .".concat(i.A.root)]:{py:1,px:2,zIndex:1,minHeight:"auto",...null==t?void 0:t.tab,["&.".concat(i.A.selected)]:{...null==t?void 0:t.selected}}}),...Array.isArray(o)?o:[o]],...n,TabIndicatorProps:{children:(0,a.jsx)(s.A,{children:(0,a.jsx)("span",{})})},children:l})}function p(e){let{children:l,value:t,index:o,sx:n,...s}=e;return(0,a.jsx)("div",{role:"tabpanel",hidden:t!==o,id:"simple-tabpanel-".concat(o),"aria-labelledby":"simple-tab-".concat(o),...s,children:t===o&&(0,a.jsx)(r.A,{...Array.isArray(n)?n:[n],children:l})})}p.propTypes={children:n().node,index:n().string.isRequired,value:n().string.isRequired}},67001:(e,l,t)=>{"use strict";t.d(l,{T:()=>d});var a=t(95155),o=t(66292),n=t(29716),r=t(62966),s=t(96358),i=t(12422);function d(e){let{open:l,title:t,action:d,content:u,onClose:c,...p}=e;return(0,a.jsxs)(n.A,{fullWidth:!0,maxWidth:"xs",open:l,onClose:c,...p,children:[(0,a.jsx)(r.A,{sx:{pb:2},children:t}),u&&(0,a.jsxs)(i.A,{sx:{typography:"body2"},children:[" ",u," "]}),(0,a.jsxs)(s.default,{children:[d,(0,a.jsx)(o.default,{variant:"outlined",color:"inherit",onClick:c,children:"Cancel"})]})]})}},69004:(e,l,t)=>{"use strict";t.d(l,{H:()=>d});var a=t(95155),o=t(11654),n=t(96801),r=t(35881),s=t(9670),i=t(27740);function d(e){var l,t,o,r,d,c,p,m,h,x,f,v;let{sx:g,imgUrl:b,action:y,filled:w,slotProps:j,description:C,title:A="No data",...S}=e;return(0,a.jsxs)(u,{filled:w,sx:g,...S,children:[(0,a.jsx)(n.A,{component:"img",alt:"Empty content",src:null!=b?b:"".concat(i.P.assetsDir,"/assets/icons/empty/ic-content.svg"),...null==j?void 0:j.img,sx:[{width:1,maxWidth:160},...Array.isArray(null==j||null==(l=j.img)?void 0:l.sx)?null!=(x=null==j||null==(t=j.img)?void 0:t.sx)?x:[]:[null==j||null==(o=j.img)?void 0:o.sx]]}),A&&(0,a.jsx)(s.default,{variant:"h6",...null==j?void 0:j.title,sx:[{mt:1,textAlign:"center",color:"text.disabled"},...Array.isArray(null==j||null==(r=j.title)?void 0:r.sx)?null!=(f=null==j||null==(d=j.title)?void 0:d.sx)?f:[]:[null==j||null==(c=j.title)?void 0:c.sx]],children:A}),C&&(0,a.jsx)(s.default,{variant:"body2",...null==j?void 0:j.description,sx:[{mt:1,textAlign:"center",color:"text.disabled"},...Array.isArray(null==j||null==(p=j.description)?void 0:p.sx)?null!=(v=null==j||null==(m=j.description)?void 0:m.sx)?v:[]:[null==j||null==(h=j.description)?void 0:h.sx]],children:C}),y&&y]})}let u=(0,r.default)("div",{shouldForwardProp:e=>!["filled","sx"].includes(e)})(e=>{let{filled:l,theme:t}=e;return{flexGrow:1,height:"100%",display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center",padding:t.spacing(0,3),...l&&{borderRadius:2*t.shape.borderRadius,backgroundColor:(0,o.IG)(t.vars.palette.grey["500Channel"],.04),border:"dashed 1px ".concat((0,o.IG)(t.vars.palette.grey["500Channel"],.08))}}})},80596:(e,l,t)=>{"use strict";let a,o;t.r(l),t.d(l,{OverviewAppView:()=>ld});var n=t(95155),r=t(73746),s=t(42861),i=t(96801),d=t(35046),u=t(38543),c=t(68074),p=t(9670),m=t(49742),h=t(72635),x=t(49904),f=t(38867);let v={Lead:m.f.dashboard.lead.new,Contact:m.f.dashboard.contact.new,Leave:m.f.dashboard.employee.leave,Visit:m.f.dashboard.visit.new,Import:m.f.dashboard.importData.root};function g(){let{loggedUserData:e,loggedUserLoading:l,loggedUserError:t}=(0,x.Ht)();return(0,n.jsxs)(i.A,{sx:{p:1,gap:2,display:"flex",flexDirection:"column",boxShadow:1,borderRadius:1,bgcolor:"background.paper",maxHeight:"150px"},children:[(0,n.jsx)(i.A,{sx:{maxWidth:850,gap:1,display:"grid",gridTemplateColumns:{xs:"repeat(2, 1fr)",md:"repeat(5, 1fr)"}},children:Object.entries(v).map(e=>{let[l,t]=e,a="Import"===l;return(0,n.jsx)(c.default,{size:"small",color:"inherit",variant:"contained",startIcon:(0,n.jsx)(f.W,{icon:a?"solar:import-bold":"mingcute:add-line"}),component:h.W,href:t,sx:{flex:1,border:"1px solid",borderColor:"divider",borderRadius:1,maxWidth:150,minWidth:90,position:"relative"},children:l},l)})}),(0,n.jsxs)(i.A,{children:[(0,n.jsx)(p.default,{variant:"h4",sx:{mb:.5},children:"Hi, Welcome back \uD83D\uDC4B"}),(0,n.jsx)(p.default,{sx:{color:"text.secondary"},children:l?"Loading...":t?"Error loading user":(null==e?void 0:e.FirstName)&&(null==e?void 0:e.LastName)?"".concat(e.FirstName," ").concat(e.LastName):"Guest User"})]}),(0,n.jsx)(u.N9,{})]})}var b=t(36339),y=t(12115),w=t(11743),j=t(66292),C=t(84256),A=t(7433),S=t(93972),I=t(88165),D=t(29453),N=t(69004),k=t(67001),E=t(20991);function T(){let[e,l]=(0,y.useState)({page:0,pageSize:25}),[t,a]=(0,y.useState)(0),[o,r]=(0,y.useState)([]),[s,d]=(0,y.useState)([]),u=(0,b.Cg)(),c=e.page*e.pageSize+1,{bwLeadsData:p,bwLeadsLoading:h,bwLeadsError:x,bwLeadsValidating:f}=(0,I.eL)(c,e.pageSize),v=(0,y.useMemo)(()=>{var e;return(null==p||null==(e=p.data)?void 0:e.length)?p.data.map(e=>{var l,t,a,o;return{id:e.LeadId,leadName:e.LeadName,siteName:e.SiteId?null==(l=e.site)?void 0:l.SiteName:null,buyerType:e.ProspectTypeId?null==(t=e.prospecttypes)?void 0:t.ProspectTypeName:null,leadStatus:e.LeadStatus,contactId:e.ContactId,customerName:e.ContactId&&e.contacts?"".concat(e.contacts.ContactFName||""," ").concat(e.contacts.ContactLName||"").trim():null,customerContact:e.ContactId?null==(a=e.contacts)?void 0:a.ContactNo:null,customerEmail:e.ContactId?null==(o=e.contacts)?void 0:o.ContactEmail:null,leadCreatedDate:e.CreatedDate,leadUpdatedDate:e.UpdatedDate,leadClosedDate:e.LeadClosedDate,quotedAmount:e.QuotedAmount,closedAmount:e.ClosedAmount,requestedAmount:e.RequestedAmount}}):[]},[null==p?void 0:p.data]);(0,y.useEffect)(()=>{r(v)},[v]),(0,y.useEffect)(()=>{(null==p?void 0:p.total_records)!==void 0&&a(p.total_records)},[p]);let g=(0,y.useMemo)(()=>[{field:"leadName",headerName:"Lead Name",minWidth:130,flex:1,hideable:!1,groupable:!1,renderCell:e=>(0,n.jsx)(E.F2,{params:e,href:m.f.dashboard.lead.profile(e.row.id)})},{field:"customerName",headerName:"Cust Name",flex:1,minWidth:140,hideable:!1,renderCell:e=>(0,n.jsx)(E.cY,{params:e,href:m.f.dashboard.contact.profile(e.row.contactId)})},{field:"siteName",headerName:"Site Name",minWidth:130,renderCell:e=>(0,n.jsx)(E.Sb,{params:e})},{field:"customerContact",headerName:"Cust Contact",minWidth:130,renderCell:e=>(0,n.jsx)(E.gR,{params:e})},{field:"customerEmail",headerName:"Email",minWidth:140,groupable:!1,renderCell:e=>(0,n.jsx)(E.Sb,{params:e})},{field:"buyerType",headerName:"Buyer Type",minWidth:140,renderCell:e=>(0,n.jsx)(E.Sb,{params:e})},{field:"leadStatus",headerName:"Lead Status",minWidth:120,renderCell:e=>(0,n.jsx)(E.Sb,{params:e})},{field:"requestedAmount",headerName:"Requested Amount",minWidth:150,groupable:!1,renderCell:e=>(0,n.jsx)(E.nz,{params:e})},{field:"quotedAmount",headerName:"Quoted Amount",minWidth:150,groupable:!1,renderCell:e=>(0,n.jsx)(E.nz,{params:e})},{field:"closedAmount",headerName:"Closed Amount",minWidth:150,groupable:!1,renderCell:e=>(0,n.jsx)(E.nz,{params:e})},{field:"leadCreatedDate",headerName:"Lead Created Date",minWidth:150,groupable:!1,renderCell:e=>(0,n.jsx)(E.V2,{params:e})},{field:"leadUpdatedDate",headerName:"Lead Updated Date",minWidth:150,groupable:!1,renderCell:e=>(0,n.jsx)(E.V2,{params:e})},{field:"leadClosedDate",headerName:"Lead Closed Date",minWidth:150,groupable:!1,renderCell:e=>(0,n.jsx)(E.V2,{params:e})}],[]),T=(0,y.useCallback)(t=>{l(t),t.pageSize!==e.pageSize&&l(e=>({...t,page:0}))},[e.pageSize]);(0,y.useCallback)(async t=>{try{r(e=>e.filter(e=>e.id!==t)),a(e=>e-1),D.oR.success("Delete success!"),1===o.length&&e.page>0&&l(e=>({...e,page:e.page-1}))}catch(e){D.oR.error("Delete failed!")}},[o.length,e.page]);let R=(0,y.useCallback)(()=>{let e=o.filter(e=>!s.includes(e.id));D.oR.success("Delete success!"),r(e)},[s,o]),F=(0,y.useCallback)(()=>(0,n.jsx)(k.T,{open:u.value,onClose:u.onFalse,title:"Delete",content:(0,n.jsxs)(n.Fragment,{children:["Are you sure want to delete ",(0,n.jsxs)("strong",{children:[" ",s.length," "]})," items?"]}),action:(0,n.jsx)(j.default,{variant:"contained",color:"error",onClick:()=>{R(),u.onFalse()},children:"Delete"})}),[u,s,R]);return(0,n.jsx)(i.A,{sx:{overflow:"hidden",display:"flex",flexDirection:"column",height:"100%",minHeight:0,maxHeight:"100%"},children:(0,n.jsxs)(C.A,{sx:{flexGrow:1,display:"flex",flexDirection:"column",overflow:"hidden",boxShadow:1,borderRadius:1,bgcolor:"background.paper",minHeight:0,maxHeight:"100%"},children:[(0,n.jsx)(w._,{rows:o,columns:g,rowCount:t,loading:h||f,pagination:!0,paginationMode:"server",paginationModel:e,onPaginationModelChange:T,pageSizeOptions:[10,25,50,100],checkboxSelection:!0,onRowSelectionModelChange:e=>d(e),initialState:{pinnedColumns:{left:[S.f.field]}},error:x,slots:{loadingOverlay:A.A,noRowsOverlay:()=>(0,n.jsx)(N.H,{}),noResultsOverlay:()=>(0,n.jsx)(N.H,{title:"No results found"})},showToolbar:!0,disableRowSelectionOnClick:!0,disablePivoting:!0,disableAggregation:!0,scrollbarSize:30,getRowHeight:()=>"auto",sx:{"& .MuiDataGrid-virtualScroller":{overflow:"auto"},"& .MuiDataGrid-columnHeaders":{borderTop:"2px solid",borderColor:"divider"},"& .MuiDataGrid-cell":{borderRight:"1px solid",borderColor:"divider",alignItems:"center",display:"inline-flex"},"& .MuiDataGrid-row":{borderColor:"divider"},"& .MuiDataGrid-columnHeader":{borderColor:"divider"}}}),F()]})})}var R=t(27740),F=t(30832),L=t.n(F),U=t(55594),O=t(62177),W=t(90221),z=t(15843),P=t(78822),M=t(53494),V=t(15930),H=t(80158),B=t(16964),G=t(91580),q=t(92634),K=t(95946),_=t(5551),Z=t(18835);let Y=async e=>{let l=Z.vZ.todos.create;return(await (0,Z.$P)([l,e])).data};async function Q(e,l){let t=Z.vZ.todos.update(e);await (0,Z.mu)([t,l])}var X=t(54961),$=t(26494);let J=e=>e.map(e=>{var l;return{label:(null==(l=e.data)?void 0:l.LeadName)||"(Unnamed Lead)",value:e.data.LeadId}}),ee=U.z.object({actionItemName:U.z.string().min(1,{message:"action item name is required!"}).max(100,{message:"action item name must be less than 100 characters"}),description:(a="description must be at least 10 characters long",U.z.string().min(10,{message:a}).optional().nullable().or(U.z.literal(""))),leadId:U.z.number().optional().nullable(),proposedEndDate:U.z.union([U.z.string(),U.z.date(),U.z.any()]).optional().nullable()}),el=(0,y.memo)(function(e){let{open:l,onOpen:t,onClose:a,actionItemsMutate:o}=e,r=(0,y.useMemo)(()=>({actionItemName:"",allotedToUserId:null,description:"",leadId:null,proposedEndDate:null,status:"New"}),[]),[s,d]=(0,y.useState)(null),[m,h]=(0,y.useState)([]),[x,v]=(0,y.useState)(null),{searchedLeadsData:g,searchedLeadsLoading:b}=(0,I.Me)(null,(null==s?void 0:s.value)||null,null),w=(0,$.zP)(),C=(0,y.useMemo)(()=>L()().startOf("day"),[]),A=(0,O.mN)({mode:"all",resolver:(0,W.u)(ee),defaultValues:r}),{setValue:S,reset:D,handleSubmit:N,formState:{isSubmitting:k,isDirty:E}}=A;(0,y.useEffect)(()=>{(null==g?void 0:g.length)>0?h(J(g)):h([])},[g]);let T=(0,y.useCallback)(e=>{d(e),v(null),S("leadId",null)},[S]),R=(0,y.useCallback)((e,l)=>{v(l),S("leadId",(null==l?void 0:l.value)||null)},[S]),F=(0,y.useCallback)(()=>{D(r),d(null),v(null),h([])},[D,r]),U=N(async e=>{try{var l,t;let n={ActionItemName:e.actionItemName,Status:e.status||"New",...(null==w||null==(l=w.user)?void 0:l.id)&&{AllotedToUserId:null==w||null==(t=w.user)?void 0:t.id},...e.description&&{Description:e.description},...e.leadId&&{LeadId:e.leadId},...e.proposedEndDate&&{ProposedEndDate:L()(e.proposedEndDate).format("YYYY-MM-DD[T]HH:mm:ss")}};await Y(n),u.oR.success("Todo created successfully!"),o(),F(),a()}catch(e){u.oR.error("Error in creating todo!")}});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(j.default,{disableRipple:!0,variant:"contained",color:"inherit",onClick:t,startIcon:(0,n.jsx)(z.A,{}),sx:{mx:2,my:1},children:"Add"}),(0,n.jsxs)(_.Ay,{anchor:"right",open:l,onClose:()=>{F(),a()},slotProps:{backdrop:{invisible:!0},paper:{sx:{width:400,maxWidth:"90vw",display:"flex",flexDirection:"column",height:"100%"}}},transitionDuration:300,children:[(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(i.A,{sx:{py:2,pr:1,pl:2.5,display:"flex",alignItems:"center"},children:[(0,n.jsx)(p.default,{variant:"h6",sx:{flexGrow:1},children:"Add ToDo Item"}),(0,n.jsx)(P.default,{title:"Reset Form",arrow:!0,children:(0,n.jsx)(M.default,{onClick:F,children:(0,n.jsx)(V.default,{color:"error",variant:"dot",invisible:!E,children:(0,n.jsx)(f.W,{icon:"solar:restart-bold",width:24,height:24})})})}),(0,n.jsx)(M.default,{onClick:()=>{F(),a()},children:(0,n.jsx)(f.W,{icon:"mingcute:close-line",width:24,height:24})})]}),(0,n.jsx)(H.default,{sx:{borderStyle:"dashed"}})]}),(0,n.jsx)(X.lV,{methods:A,onSubmit:U,children:(0,n.jsx)(i.A,{sx:{display:"flex",flexDirection:"column",gap:2,flexGrow:1,height:"100%"},children:(0,n.jsxs)(i.A,{sx:{display:"flex",flexDirection:"column",gap:2,p:2,flexGrow:1,height:"100%"},children:[(0,n.jsx)(X.D0.Text2,{name:"actionItemName",label:"Action Item Name",placeholder:"Enter a name for the action item",helperText:"Brief but descriptive name for the task",required:!0}),(0,n.jsx)(X.D0.Text2,{name:"description",label:"Description",placeholder:"Provide detailed information about the action item...",multiline:!0,minRows:4,maxRows:8}),(0,n.jsxs)(i.A,{children:[(0,n.jsx)(p.default,{variant:"subtitle2",sx:{mb:1,color:"text.secondary"},children:"Customer & Lead Association"}),(0,n.jsx)(eA,{onCustomerSelect:T,placeholder:"Search and select a customer"}),s&&(0,n.jsx)(B.A,{in:!0,children:(0,n.jsx)(G.default,{label:"Selected Customer: ".concat(s.label),size:"small",color:"primary",variant:"outlined",sx:{mt:1}})})]}),(0,n.jsx)(q.default,{options:m,loading:b,disabled:!s,getOptionLabel:e=>e.label,getOptionKey:e=>e.value,isOptionEqualToValue:(e,l)=>e.value===(null==l?void 0:l.value),value:x,onChange:R,renderInput:e=>(0,n.jsx)(K.default,{...e,label:"Select Lead",placeholder:"Choose a lead to associate with action item...",helperText:!s&&"Please select a customer first to view available leads",variant:"outlined"}),noOptionsText:"No Lead found for selected customer",loadingText:"Loading leads..."}),(0,n.jsx)(X.D0.DatePicker2,{name:"proposedEndDate",label:"Proposed End Date",timeMode:"endOfDay",minDate:C,maxDate:C.add(1,"year"),shouldDisableDate:e=>e.isBefore(C,"day")}),(0,n.jsxs)(i.A,{sx:{display:"flex",justifyContent:"flex-end",gap:2},children:[(0,n.jsx)(j.default,{onClick:()=>{F(),a()},color:"inherit",variant:"outlined",children:"Cancel"}),(0,n.jsx)(c.default,{type:"submit",variant:"contained",loading:k,disabled:k,children:k?"Creating...":"Create"})]})]})})})]})]})});el.displayName="ToDoDrawerForm";var et=t(68086),ea=t(31224),eo=t(60521);let en={card:{py:1,pl:2,pr:2,position:"relative"},icon:{size:36,top:24,right:20,position:"absolute"},background:{size:160,top:-44,right:-104,opacity:.12,borderRadius:3,rotation:"40deg",position:"absolute",zIndex:-1},skeleton:{width:60,height:32},value:{typography:"h3",minHeight:32},title:{color:"text.secondary"}},er={top:en.background.top,width:en.background.size,height:en.background.size,right:en.background.right,opacity:en.background.opacity,borderRadius:en.background.borderRadius,position:en.background.position,zIndex:en.background.zIndex,transform:"rotate(".concat(en.background.rotation,")")},es={top:en.icon.top,right:en.icon.right,width:en.icon.size,height:en.icon.size,position:en.icon.position},ei=(0,y.memo)(e=>{let{sx:l,icon:t,title:a,total:o,color:r="warning",loading:s,error:d,formatFunction:u,...c}=e,m=(0,y.useMemo)(()=>s?null:d?"-":u(o),[s,d,o,u]),h=(0,y.useMemo)(()=>[en.card,...Array.isArray(l)?l:[l]],[l]);return(0,n.jsxs)(C.A,{sx:h,...c,children:[(0,n.jsxs)(i.A,{sx:{flexGrow:1},children:[(0,n.jsx)(i.A,{sx:en.value,children:s?(0,n.jsx)(et.A,{variant:"text",width:en.skeleton.width,height:en.skeleton.height,animation:"wave"}):m}),(0,n.jsx)(p.default,{variant:"subtitle2",component:"div",sx:en.title,children:a})]}),t&&!s&&(0,n.jsx)(eo.Q,{src:t,sx:e=>({...es,background:"linear-gradient(135deg, ".concat(e.vars.palette[r].main," 0%, ").concat(e.vars.palette[r].dark," 100%)")})}),!s&&(0,n.jsx)(i.A,{sx:e=>({...er,background:"linear-gradient(to right, ".concat(e.vars.palette[r].main,", transparent)")})})]})},(e,l)=>e.title===l.title&&e.total===l.total&&e.color===l.color&&e.loading===l.loading&&e.error===l.error&&e.icon===l.icon&&e.sx===l.sx);ei.displayName="HomeWidgetBase";let ed=(0,y.memo)(function(e){return(0,n.jsx)(ei,{...e,formatFunction:ea.kB})}),eu=(0,y.memo)(function(e){return(0,n.jsx)(ei,{...e,formatFunction:ea.IG})});var ec=t(80918),ep=t(32104),em=t(31847);let eh=e=>e.map(e=>{var l;return{label:(null==(l=e.data)?void 0:l.LeadName)||"(Unnamed Lead)",value:e.data.LeadId}}),ex=e=>"In-Progress"===e?"New":"Closed"===e?"Completed":e||"New",ef=U.z.object({actionItemName:U.z.string().min(1,{message:"action item name is required!"}).max(100,{message:"action item name must be less than 100 characters"}),description:(o="description must be at least 10 characters long",U.z.string().min(10,{message:o}).optional().nullable().or(U.z.literal(""))),leadId:U.z.number().optional().nullable(),proposedEndDate:U.z.union([U.z.string(),U.z.date(),U.z.any()]).optional().nullable()}),ev=(0,y.memo)(function(e){let{open:l,onClose:t,openedItem:a,actionItemsMutate:o}=e,r=(0,y.useMemo)(()=>({actionItemName:(null==a?void 0:a.ActionItemName)||"",allotedToUserId:(null==a?void 0:a.AllotedToUserId)||null,description:(null==a?void 0:a.Description)||"",leadId:(null==a?void 0:a.LeadId)||null,proposedEndDate:(null==a?void 0:a.ProposedEndDate)||null,status:ex(null==a?void 0:a.Status)}),[a]),[s,d]=(0,y.useState)(!1),[m,h]=(0,y.useState)(null),[x,v]=(0,y.useState)([]),[g,b]=(0,y.useState)(null),{searchedLeadsData:w,searchedLeadsLoading:C}=(0,I.Me)(null,null==m?void 0:m.value,null),A=(0,y.useMemo)(()=>L()().startOf("day"),[]),S=(0,O.mN)({mode:"all",resolver:(0,W.u)(ef),defaultValues:r}),{watch:D,setValue:N,reset:k,handleSubmit:E,formState:{isSubmitting:T}}=S,R=D();(0,y.useEffect)(()=>{a&&k(r)},[null==a?void 0:a.ActionItemId,r,k]),(0,y.useEffect)(()=>{(null==w?void 0:w.length)>0?v(eh(w)):v([])},[w]),(0,y.useEffect)(()=>{var e;let l=null==a||null==(e=a.lead)?void 0:e.contacts;if(null===l)return void h(null);(null==a?void 0:a.LeadId)&&(null==a?void 0:a.lead)?h({label:"".concat(l.ContactFName," ").concat(l.ContactLName," (").concat(l.ContactNo,")"),value:null==l?void 0:l.ContactId}):h(null)},[null==a?void 0:a.LeadId,null==a?void 0:a.lead]),(0,y.useEffect)(()=>{let e=null==a?void 0:a.lead;(null==a?void 0:a.LeadId)&&(null==a?void 0:a.lead)?b({label:e.LeadName,value:e.LeadId}):b(null)},[null==a?void 0:a.LeadId,null==a?void 0:a.lead]);let F=(0,y.useMemo)(()=>em.T7.find(e=>e.value===(null==R?void 0:R.status))||null,[null==R?void 0:R.status]),U=(0,y.useCallback)(e=>{h(e),b(null),N("leadId",null)},[N]),z=(0,y.useCallback)((e,l)=>{b(l),N("leadId",(null==l?void 0:l.value)||null)},[N]),P=E(async e=>{if(s)try{let l={ActionItemName:e.actionItemName,Status:e.status||"New",...e.description&&{Description:e.description},...e.leadId&&{LeadId:e.leadId},...e.proposedEndDate&&{ProposedEndDate:L()(e.proposedEndDate).format("YYYY-MM-DD[T]HH:mm:ss")}};await Q(null==a?void 0:a.ActionItemId,l),u.oR.success("Todo updated successfully!"),o(),t()}catch(e){u.oR.error("Error in updating todo!")}d(e=>!e)}),V=(0,y.useCallback)(()=>{d(!1),k(r),t()},[t,k,r]),Z=(0,y.useCallback)((e,l)=>{if("allotedToUserId"===e){let e=null==a?void 0:a.alloted_to_user_id,t="".concat(null==e?void 0:e.FirstName," ").concat(null==e?void 0:e.LastName);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.default,{variant:"subtitle1",sx:{minWidth:150,fontWeight:500},children:"Alloted To User"}),(0,n.jsx)(p.default,{children:":"}),(0,n.jsx)(p.default,{variant:"body1",sx:{flex:1},children:null===l?"None":t})]})}if("leadId"===e){var t;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.default,{variant:"subtitle1",sx:{minWidth:150,fontWeight:500},children:"Lead Name"}),(0,n.jsx)(p.default,{children:":"}),(0,n.jsx)(p.default,{variant:"body1",sx:{flex:1},children:null===l?"None":null==a||null==(t=a.lead)?void 0:t.LeadName})]})}return"proposedEndDate"===e?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.default,{variant:"subtitle1",sx:{minWidth:150,fontWeight:500},children:e.replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase())}),(0,n.jsx)(p.default,{children:":"}),(0,n.jsx)(p.default,{variant:"body1",sx:{flex:1},children:null===l?"None":(0,ep.ts)(l)})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.default,{variant:"subtitle1",sx:{minWidth:150,fontWeight:500},children:e.replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase())}),(0,n.jsx)(p.default,{children:":"}),(0,n.jsx)(p.default,{variant:"body1",sx:{flex:1},children:null!=l?l:"-"})]})},[a]);return(0,n.jsx)(_.Ay,{anchor:"right",open:l,onClose:V,slotProps:{backdrop:{invisible:!0},paper:{sx:{width:400,maxWidth:"90vw",display:"flex",flexDirection:"column",height:"100%"}}},transitionDuration:300,children:(0,n.jsxs)(X.lV,{methods:S,onSubmit:P,children:[(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(i.A,{sx:{py:2,pr:1,pl:2.5,display:"flex",alignItems:"center"},children:[(0,n.jsx)(p.default,{variant:"h6",sx:{flexGrow:1},children:"ToDo Item Details"}),(0,n.jsx)(M.default,{onClick:V,children:(0,n.jsx)(f.W,{icon:"mingcute:close-line",width:24,height:24})})]}),(0,n.jsx)(H.default,{sx:{borderStyle:"dashed"}})]}),s?(0,n.jsx)(i.A,{sx:{display:"flex",flexDirection:"column",gap:2,flexGrow:1},children:(0,n.jsxs)(i.A,{sx:{display:"flex",flexDirection:"column",gap:2,p:2,flexGrow:1,height:"100%"},children:[(0,n.jsx)(X.D0.Text2,{name:"actionItemName",label:"Action Item Name",placeholder:"Enter a name for the action item",helperText:"Brief but descriptive name for the task",required:!0}),(0,n.jsx)(X.D0.Text2,{name:"description",label:"Description",placeholder:"Provide detailed information about the action item...",multiline:!0,minRows:4,maxRows:8}),(0,n.jsxs)(i.A,{children:[(0,n.jsx)(p.default,{variant:"subtitle2",sx:{mb:1,color:"text.secondary"},children:"Customer & Lead Association"}),(0,n.jsx)(eA,{onCustomerSelect:U,placeholder:"Search and select a customer"}),m&&(0,n.jsx)(B.A,{in:!0,children:(0,n.jsx)(G.default,{label:"Selected Customer: ".concat(m.label||"None"),size:"small",color:"primary",variant:"outlined",sx:{mt:1}})})]}),(0,n.jsx)(q.default,{options:x,loading:C,disabled:!m,getOptionLabel:e=>e.label,getOptionKey:e=>e.value,isOptionEqualToValue:(e,l)=>e.value===(null==l?void 0:l.value),value:g,onChange:z,renderInput:e=>(0,n.jsx)(K.default,{...e,label:"Select Lead",placeholder:"Choose a lead to associate with action item...",helperText:!m&&"Please select a customer first to view available leads",variant:"outlined"}),noOptionsText:"No Lead found for selected customer",loadingText:"Loading leads..."}),(0,n.jsx)(q.default,{options:em.T7,getOptionLabel:e=>e.label,isOptionEqualToValue:(e,l)=>e.value===(null==l?void 0:l.value),value:F,onChange:(e,l)=>N("status",(null==l?void 0:l.value)||null),renderInput:e=>(0,n.jsx)(K.default,{...e,label:"Select Status",variant:"outlined"})}),(0,n.jsx)(X.D0.DatePicker2,{name:"proposedEndDate",label:"Proposed End Date",timeMode:"endOfDay",minDate:A,maxDate:A.add(1,"year"),shouldDisableDate:e=>e.isBefore(A,"day")})]})}):(0,n.jsx)(i.A,{sx:{display:"flex",flexDirection:"column",gap:2,flexGrow:1},children:(0,n.jsx)(i.A,{sx:{display:"flex",flexDirection:"column",gap:2,p:2,flexGrow:1,height:"100%"},children:Object.entries(R).map(e=>{let[l,t]=e;return(0,n.jsx)(ec.A,{children:(0,n.jsx)(i.A,{sx:{display:"flex",alignItems:"center",gap:1},children:Z(l,t)})},l)})})}),(0,n.jsx)(i.A,{sx:{mr:2,display:"flex",justifyContent:"flex-end",gap:2},children:s?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(j.default,{onClick:()=>{d(!1),k(r)},color:"inherit",variant:"outlined",children:"Cancel"}),(0,n.jsx)(c.default,{type:"submit",variant:"contained",loading:T,disabled:T,children:T?"Saving...":"Save"})]}):(0,n.jsx)(j.default,{onClick:()=>d(!0),color:"inherit",variant:"outlined",startIcon:(0,n.jsx)(f.W,{icon:"solar:pen-bold"}),children:"Edit"})})]})})});ev.displayName="ToDoViewEditForm";var eg=t(45964),eb=t.n(eg),ey=t(62516),ew=t(55398),ej=t(74234);let eC=e=>Array.isArray(e)?e.map(e=>({label:"".concat(e.data.ContactFName||""," ").concat(e.data.ContactLName||""," (").concat(e.data.ContactNo||"",")").trim(),value:e.data.ContactId,avatar:e.data.ContactAvatar||null,email:e.data.ContactEmail||null})):[],eA=(0,y.memo)(function(e){let{onCustomerSelect:l,multiple:t=!1,label:a="Search Customer",placeholder:o="Type customer name or contact number ...",disabled:r=!1}=e,[s,d]=(0,y.useState)(!1),[u,c]=(0,y.useState)([]),[m,h]=(0,y.useState)(!1),[x,f]=(0,y.useState)(""),[v,g]=(0,y.useState)(null),b=(0,y.useRef)();(0,y.useEffect)(()=>(b.current=eb()(async e=>{if(!e||e.length<2){c([]),h(!1),g(null);return}g(null);try{let l=await (0,ej.P8)(e,"Customer"),t=eC(l);c(t)}catch(e){g("Failed to search customers"),c([])}finally{h(!1)}},300),()=>{b.current&&b.current.cancel()}),[]),(0,y.useEffect)(()=>{if(x){var e;h(!0),null==(e=b.current)||e.call(b,x)}else c([]),h(!1),g(null)},[x]);let w=(0,y.useCallback)(()=>d(!0),[]),j=(0,y.useCallback)(()=>d(!1),[]),C=(0,y.useCallback)((e,l,t)=>{"input"===t&&f(l)},[]),A=(0,y.useCallback)((e,t)=>{l(t)},[l]),S=(0,y.useCallback)(e=>e,[]),I=(0,y.useMemo)(()=>v||(x.length<2?"Type at least ".concat(2," characters to search"):m?"Searching...":"No customers found"),[x.length,m,v]),D=(0,y.useCallback)(e=>(0,n.jsx)(K.default,{...e,label:a,placeholder:o,variant:"outlined",error:!!v,helperText:v,InputProps:{...e.InputProps,endAdornment:(0,n.jsxs)(n.Fragment,{children:[m&&(0,n.jsx)(ey.default,{color:"inherit",size:20}),e.InputProps.endAdornment]})}}),[a,o,m,v]),N=(0,y.useCallback)((e,l)=>{var t,a;let{key:o,...r}=e;return(0,n.jsx)(i.A,{component:"li",...r,children:(0,n.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",width:"100%",py:.5},children:[l.avatar?(0,n.jsx)(ew.A,{src:l.avatar,sx:{width:32,height:32,mr:2},children:null==(t=l.label)?void 0:t.charAt(0)}):(0,n.jsx)(ew.A,{sx:{width:32,height:32,mr:2},children:null==(a=l.label)?void 0:a.charAt(0)}),(0,n.jsxs)(i.A,{sx:{flexGrow:1,minWidth:0},children:[(0,n.jsx)(p.default,{variant:"body1",sx:{fontWeight:"medium"},noWrap:!0,children:l.label}),l.email&&(0,n.jsx)(p.default,{variant:"body2",color:"text.secondary",noWrap:!0,children:l.email})]})]})},o)},[]),k=(0,y.useCallback)((e,l)=>e.map((e,t)=>{let{key:a,...o}=l({index:t});return(0,n.jsx)(G.default,{variant:"outlined",label:e.label,size:"small",...o},a)}),[]);return(0,n.jsx)(q.default,{multiple:t,open:s,onOpen:w,onClose:j,options:u,loading:m,disabled:r,getOptionLabel:e=>e.label||"",getOptionKey:e=>e.value,isOptionEqualToValue:(e,l)=>e.value===l.value,filterOptions:S,onInputChange:C,onChange:A,renderInput:D,renderOption:N,renderTags:k,noOptionsText:I,loadingText:"Searching customers...",clearOnBlur:!0,selectOnFocus:!0,handleHomeEndKeys:!0})});eA.displayName="CustomerSearchDropdown";let eS={progress:"".concat(R.P.assetsDir,"/assets/icons/courses/ic-courses-progress.svg"),completed:"".concat(R.P.assetsDir,"/assets/icons/courses/ic-courses-completed.svg"),certificates:"".concat(R.P.assetsDir,"/assets/icons/courses/ic-courses-certificates.svg")},eI=[{Component:ed,title:"Monthly Target",dataKey:"monthlyTarget",icon:eS.progress,color:"warning"},{Component:ed,title:"Monthly Conversions",dataKey:"monthlyConv",icon:eS.completed,color:"success"},{Component:eu,title:"Target Rate",dataKey:"targetRate",icon:eS.certificates,color:"secondary"},{Component:eu,title:"Overall Conversion Rate",dataKey:"overallConvRate",icon:eS.progress,color:"info"}],eD={gap:1,display:"grid",gridTemplateColumns:{xs:"repeat(2, 1fr)",md:"repeat(2, 1fr)"}},eN=(0,y.memo)(function(){let{cardsData:e,cardsLoading:l,cardsError:t}=(0,x.O1)(),a=(0,y.useMemo)(()=>({monthlyTarget:(null==e?void 0:e.monthlyTarget)||0,monthlyConv:(null==e?void 0:e.monthlyConv)||0,targetRate:(null==e?void 0:e.targetRate)||0,overallConvRate:(null==e?void 0:e.overallConvRate)||0}),[e]),o=(0,y.useMemo)(()=>eI.map((e,o)=>{let{Component:r,title:s,dataKey:i,icon:d,color:u}=e;return(0,n.jsx)(r,{title:s,total:a[i],icon:d,color:u,loading:l,error:t},"".concat(i,"-").concat(o))}),[a,l,t]);return(0,n.jsx)(i.A,{sx:eD,children:o})});eN.displayName="TopRightCard";var ek=t(21030),eE=t(59886),eT=t(33410),eR=t(85396),eF=t(79608),eL=t(89438),eU=t(77498),eO=t(26403),eW=t(2360),ez=t(29716),eP=t(62966),eM=t(12422),eV=t(96358),eH=t(32868),eB=t(16531),eG=t(56626),eq=t(45375),eK=t(38637),e_=t.n(eK),eZ=t(20033),eY=t(60392),eQ=t(18478),eX=t(99705),e$=t(32987),eJ=t(26348),e0=t(74926),e1=t(47298),e2=t(67384),e5=t(54102),e4=t(90805),e3=t(83025),e6=t(58417);function e9(e){let{open:l,onClose:t,todo:a,followUp:o,onComplete:r}=e,[s,d]=(0,y.useState)({customerResponded:null,notes:(null==o?void 0:o.Notes)||"",scheduleNext:!1,nextFollowUpType:"Call",nextFollowUpDate:null}),[c,m]=(0,y.useState)({}),[h,x]=(0,y.useState)(!1),[f,v]=(0,y.useState)(!1),[g,b]=(0,y.useState)({}),w=(0,y.useMemo)(()=>null===s.customerResponded?null:s.customerResponded?"Completed":"No Response",[s.customerResponded]),C=(0,y.useMemo)(()=>{if(null===s.customerResponded)return!1;let e=(null==o?void 0:o.Notes)||"";if(s.notes.trim()!==e.trim()&&s.notes&&s.notes.trim().length>0&&s.notes.trim().length<10)return!1;if(s.scheduleNext){if(!s.nextFollowUpType||!s.nextFollowUpDate)return!1;let e=L()().add(1,"day").startOf("day");if(L()(s.nextFollowUpDate).startOf("day").isBefore(e))return!1}return!0},[s,o]),A=(0,y.useCallback)((e,l)=>{d(t=>({...t,[e]:l})),v(!0),m(l=>({...l,[e]:null}))},[]),S=(0,y.useCallback)(e=>{let l="responded"===e.target.value;A("customerResponded",l),l?A("customerResponded",l):d(e=>({...e,customerResponded:l,scheduleNext:!0}))},[A]),I=(0,y.useCallback)(e=>{A("notes",e.target.value),b(e=>({...e,notes:!0}))},[A]),D=(0,y.useCallback)(e=>{e.target.checked?d(e=>({...e,scheduleNext:!0,nextFollowUpType:e.nextFollowUpType||"Call"})):d(e=>({...e,scheduleNext:!1,nextFollowUpType:"",nextFollowUpDate:null})),v(!0)},[]),N=(0,y.useCallback)(e=>{A("nextFollowUpDate",L()().add(e,"day"))},[A]),k=(0,y.useCallback)(()=>{let e={};null===s.customerResponded&&(e.customerResponded="Please indicate if customer responded");let l=(null==o?void 0:o.Notes)||"",t=s.notes.trim()!==l.trim();if(s.notes&&s.notes.trim().length>0&&(t&&s.notes.trim().length<10?e.notes="Minimum 10 characters required (or leave empty)":s.notes.length>1e3&&(e.notes="Notes cannot exceed 1000 characters")),s.scheduleNext)if(s.nextFollowUpType||(e.nextFollowUpType="Please select follow-up type"),s.nextFollowUpDate){let l=L()().add(1,"day").startOf("day");L()(s.nextFollowUpDate).startOf("day").isBefore(l)&&(e.nextFollowUpDate="Date must be in the future (tomorrow or later)")}else e.nextFollowUpDate="Please select a future date";return m(e),0===Object.keys(e).length},[s,o]),E=(0,y.useCallback)(async()=>{if(!k()){u.oR.error("Please fix the errors before submitting"),window.scrollTo({top:0,behavior:"smooth"});return}x(!0);try{let e={todoId:a.ActionItemId,todoStatus:"Completed",todoActualEndDate:new Date().toISOString(),followUpId:o.FollowUpsId,followUpStatus:w,followUpNotes:s.notes.trim(),customerResponded:s.customerResponded,createNextFollowUp:s.scheduleNext,nextFollowUp:s.scheduleNext?{LeadId:o.LeadId||null,UserId:o.UserId,FollowUpType:s.nextFollowUpType,FollowUpDate:L()(s.nextFollowUpDate).toISOString(),NextFollowUpDate:L()(s.nextFollowUpDate).add(7,"day").toISOString(),Status:"Pending",Notes:"",VisitId:o.LeadId?null:o.VisitId||null}:null};await r(e);let l=s.scheduleNext?"Follow-up completed & next follow-up scheduled":"Follow-up completed successfully";u.oR.success(l),d({customerResponded:null,notes:"",scheduleNext:!1,nextFollowUpType:"",nextFollowUpDate:null}),v(!1),m({}),b({}),t()}catch(e){console.error("Error completing follow-up:",e),u.oR.error(e.message||"Error completing follow-up")}finally{x(!1)}},[s,a,o,w,k,r,t]),T=(0,y.useCallback)(()=>{d({customerResponded:null,notes:"",scheduleNext:!1,nextFollowUpType:"",nextFollowUpDate:null}),v(!1),m({}),b({}),t()},[t]),R=e=>{switch(e){case"Call":return(0,n.jsx)(eR.A,{fontSize:"small"});case"Email":return(0,n.jsx)(eY.A,{fontSize:"small"});case"Meeting":return(0,n.jsx)(e0.A,{fontSize:"small"});case"Text/SMS":return(0,n.jsx)(eZ.A,{fontSize:"small"});default:return(0,n.jsx)(eX.A,{fontSize:"small"})}};return a&&o?(0,n.jsxs)(ez.A,{open:l,onClose:T,maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{width:{xs:"100%",sm:600}}},children:[(0,n.jsx)(eP.A,{children:(0,n.jsxs)(ek.A,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[(0,n.jsx)(p.default,{variant:"h6",children:"Follow-up Outcome"}),(0,n.jsx)(M.default,{edge:"end",color:"inherit",onClick:T,"aria-label":"close",size:"small",children:(0,n.jsx)(eF.A,{})})]})}),(0,n.jsx)(eM.A,{dividers:!0,children:(0,n.jsxs)(ek.A,{spacing:2,children:[(0,n.jsx)(i.A,{sx:{bgcolor:"background.neutral",p:1.5,borderRadius:1},children:(0,n.jsxs)(ek.A,{direction:"row",alignItems:"center",spacing:1,children:[R(o.FollowUpType),(0,n.jsx)(p.default,{variant:"body2",fontWeight:"medium",children:o.FollowUpType}),(0,n.jsx)(p.default,{variant:"body2",color:"text.secondary",children:"•"}),(0,n.jsx)(p.default,{variant:"body2",color:"text.secondary",children:(0,ep.ts)(o.FollowUpDate)})]})}),(0,n.jsx)(H.default,{}),(0,n.jsx)(i.A,{children:(0,n.jsxs)(eU.A,{component:"fieldset",error:!!c.customerResponded,fullWidth:!0,children:[(0,n.jsx)(e1.A,{component:"legend",required:!0,sx:{mb:1},children:"Customer Response"}),(0,n.jsxs)(e2.A,{value:null===s.customerResponded?"":s.customerResponded?"responded":"no-response",onChange:S,children:[(0,n.jsx)(e5.default,{value:"responded",control:(0,n.jsx)(e4.default,{}),label:(0,n.jsxs)(ek.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,n.jsx)(p.default,{variant:"body2",children:"Customer Responded"}),!0===s.customerResponded&&(0,n.jsx)(G.default,{label:"Status: Completed",size:"small",color:"success",icon:(0,n.jsx)(eJ.A,{fontSize:"small"})})]})}),(0,n.jsx)(e5.default,{value:"no-response",control:(0,n.jsx)(e4.default,{}),label:(0,n.jsxs)(ek.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,n.jsx)(p.default,{variant:"body2",children:"No Response"}),!1===s.customerResponded&&(0,n.jsx)(G.default,{label:"Status: No Response",size:"small",color:"warning",icon:(0,n.jsx)(eQ.A,{fontSize:"small"})})]}),sx:{mt:.5}})]}),c.customerResponded&&(0,n.jsx)(e3.A,{children:c.customerResponded})]})}),(0,n.jsx)(i.A,{children:(0,n.jsx)(K.default,{label:s.notes.length>0?"What happened? (".concat(s.notes.length," / 1000)"):"What happened?",placeholder:!0===s.customerResponded?"What did the customer say? (e.g., Interested in 2BHK, budget 50L...)":!1===s.customerResponded?"What happened? (e.g., Called at 2PM, no answer. Left voicemail...)":"What happened during this follow-up?",multiline:!0,rows:3,fullWidth:!0,value:s.notes,onChange:I,error:!!c.notes&&g.notes,helperText:c.notes?c.notes:"",FormHelperTextProps:{sx:{display:"flex",justifyContent:"space-between",color:c.notes&&g.notes?"error.main":10>s.notes.length?"warning.main":"text.secondary"}}})}),(0,n.jsxs)(i.A,{children:[(0,n.jsx)(p.default,{variant:"subtitle2",sx:{mb:1},children:"Next Steps"}),(0,n.jsx)(e5.default,{control:(0,n.jsx)(eE.default,{checked:s.scheduleNext,onChange:D,color:"primary"}),label:(0,n.jsxs)(i.A,{children:[(0,n.jsx)(p.default,{variant:"body2",fontWeight:"medium",children:"Schedule next follow-up"}),!1===s.customerResponded&&(0,n.jsx)(p.default,{variant:"caption",color:"warning.main",children:"Recommended for no-response cases"})]})}),s.scheduleNext&&(0,n.jsx)(i.A,{sx:{mt:1.5,ml:3,p:1.5,bgcolor:"background.neutral",borderRadius:1},children:(0,n.jsxs)(ek.A,{spacing:1.5,children:[(0,n.jsxs)(eU.A,{fullWidth:!0,error:!!c.nextFollowUpType,required:!0,children:[(0,n.jsx)(p.default,{variant:"caption",color:"text.secondary",sx:{mb:.5},children:"Next Follow-up Type *"}),(0,n.jsxs)(eO.A,{value:s.nextFollowUpType,onChange:e=>A("nextFollowUpType",e.target.value),displayEmpty:!0,children:[(0,n.jsx)(eW.default,{value:"",disabled:!0,children:"Select type"}),em.Nz.map(e=>(0,n.jsx)(eW.default,{value:e.value,children:(0,n.jsxs)(ek.A,{direction:"row",alignItems:"center",spacing:1,children:[R(e.value),(0,n.jsx)("span",{children:e.label})]})},e.value))]}),c.nextFollowUpType&&(0,n.jsx)(e3.A,{children:c.nextFollowUpType})]}),(0,n.jsxs)(eU.A,{fullWidth:!0,error:!!c.nextFollowUpDate,required:!0,children:[(0,n.jsx)(p.default,{variant:"caption",color:"text.secondary",sx:{mb:.5},children:"Next Follow-up Date *"}),(0,n.jsx)(e6.$J,{children:(0,n.jsx)(e$.l,{value:s.nextFollowUpDate?L()(s.nextFollowUpDate):null,onChange:e=>A("nextFollowUpDate",e),minDate:L()().add(1,"day"),slotProps:{textField:{fullWidth:!0,error:!!c.nextFollowUpDate,helperText:c.nextFollowUpDate}}})})]}),(0,n.jsxs)(i.A,{children:[(0,n.jsx)(p.default,{variant:"caption",color:"text.secondary",sx:{mb:.25},children:"Quick Options"}),(0,n.jsx)(ek.A,{direction:"row",spacing:.75,sx:{mt:.5},children:!1===s.customerResponded?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(j.default,{size:"small",variant:"outlined",onClick:()=>N(1),children:"Tomorrow"}),(0,n.jsx)(j.default,{size:"small",variant:"outlined",onClick:()=>N(2),children:"+2 days"}),(0,n.jsx)(j.default,{size:"small",variant:"outlined",onClick:()=>N(7),children:"+1 week"})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(j.default,{size:"small",variant:"outlined",onClick:()=>N(3),children:"+3 days"}),(0,n.jsx)(j.default,{size:"small",variant:"outlined",onClick:()=>N(7),children:"+1 week"}),(0,n.jsx)(j.default,{size:"small",variant:"outlined",onClick:()=>N(14),children:"+2 weeks"})]})})]})]})})]})]})}),(0,n.jsxs)(eV.default,{sx:{px:2.5,py:1.5},children:[(0,n.jsx)(j.default,{onClick:T,color:"inherit",disabled:h,children:"Cancel"}),(0,n.jsx)(j.default,{onClick:E,variant:"contained",color:"primary",disabled:!C||h,startIcon:h?null:(0,n.jsx)(eJ.A,{}),children:h?"Completing...":"Complete"})]})]}):null}e9.propTypes={open:e_().bool.isRequired,onClose:e_().func.isRequired,todo:e_().object,followUp:e_().object,onComplete:e_().func.isRequired};let e8=e=>e&&Array.isArray(e)?e.map(e=>({...e,is_overdue:(0,x.zx)(e)})):[],e7=e=>e&&Array.isArray(e)?e.filter(e=>e.ProposedEndDate&&(0,x.cK)(e.ProposedEndDate)):[],le=e=>e&&Array.isArray(e)?e.filter(e=>{let l=e.ProposedEndDate;if(!l)return!1;let t=(0,x.xc)(l),a=!(0,x.cK)(l),o="New"===e.Status;return t&&a&&o}):[],ll=e=>e&&Array.isArray(e)?e.filter(e=>!0===e.is_overdue):[],lt=e=>e.slice().sort((e,l)=>{let t=+("Completed"===e.Status),a=+("Completed"===l.Status);return t!==a?t-a:"Completed"===e.Status?new Date(l.ActualEndDate||l.CreatedDate)-new Date(e.ActualEndDate||e.CreatedDate):new Date(l.CreatedDate)-new Date(e.CreatedDate)}),la=e=>e.slice().sort((e,l)=>new Date(e.ProposedEndDate)-new Date(l.ProposedEndDate)),lo=e=>"In-Progress"===e?"New":"Closed"===e?"Completed":e,ln=e=>"Completed"===lo(e.Status),lr=(0,y.memo)(function(e){let{title:l,sx:t,...a}=e,o=(0,r.default)(),d=(0,s.A)(o.breakpoints.up("md")),u=(0,b.Cg)(),c=(0,b.Cg)(),m=(0,b.uc)("today"),{actionItemsData:h,actionItemsLoading:f,actionItemsError:v,actionItemsMutate:g}=(0,x.bi)(),[w,j]=(0,y.useState)(null);(0,y.useEffect)(()=>{(null==w?void 0:w.ActionItemId)&&c.onTrue()},[w,c]);let A=(0,y.useMemo)(()=>e8(h),[h]),S=(0,y.useMemo)(()=>({today:e7(A).length,this_week:le(A).length,overdue:ll(A).length}),[A]),I=(0,y.useMemo)(()=>{switch(m.value){case"today":return e7(A);case"this_week":return le(A);case"overdue":return ll(A);default:return A}},[A,m.value]),D=(0,y.useMemo)(()=>"today"===m.value?lt(I):"this_week"===m.value||"overdue"===m.value?la(I):I,[I,m.value]),N=(0,y.useMemo)(()=>f?(0,n.jsx)(et.A,{variant:"rectangular",width:"100%",height:500}):v?(0,n.jsx)(ek.A,{sx:{minHeight:200,justifyContent:"center",alignItems:"center",py:4},children:(0,n.jsx)(p.default,{variant:"body1",color:"error",children:"Failed to load action items. Please try again."})}):h&&0!==h.length?D&&0!==D.length?(0,n.jsx)(ek.A,{divider:(0,n.jsx)(H.default,{sx:{borderStyle:"dashed"}}),children:D.map(e=>(0,n.jsx)(ls,{item:e,selected:ln(e),setOpenedItem:j,onStatusUpdate:g,currentTab:m.value},e.ActionItemId))}):(0,n.jsx)(ek.A,{sx:{minHeight:200,justifyContent:"center",alignItems:"center",py:4},children:(0,n.jsxs)(p.default,{variant:"body1",color:"text.secondary",children:["No items ",{today:"today",this_week:"this week",overdue:"overdue"}[m.value]||m.value]})}):(0,n.jsx)(ek.A,{sx:{minHeight:200,justifyContent:"center",alignItems:"center",py:4},children:(0,n.jsx)(p.default,{variant:"body1",color:"text.secondary",children:"No action items found"})}),[f,h,v,g,D,m.value]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(C.A,{sx:{position:"relative",height:"100%",display:"flex",flexDirection:"column",...t},...a,children:[(0,n.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",flexShrink:0,borderBottom:"1px solid",borderColor:"divider",px:2,py:1},children:[(0,n.jsx)(p.default,{variant:"h5",children:l}),(0,n.jsx)(el,{open:u.value,onOpen:u.onTrue,onClose:u.onFalse,actionItemsMutate:g})]}),(0,n.jsx)(i.A,{sx:{flexShrink:0,px:2*!d,py:1.5*!d},children:d?(0,n.jsx)(eq.Q,{value:m.value,onChange:m.onChange,variant:"scrollable",scrollButtons:"auto",allowScrollButtonsMobile:!0,sx:{width:1,borderRadius:1},children:em.ie.map(e=>(0,n.jsx)(eL.default,{value:e.value,label:(0,n.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,n.jsx)("span",{children:e.label}),(0,n.jsx)(G.default,{label:S[e.value]||0,size:"small",color:"overdue"===e.value?S.overdue>0?"error":"success":"primary",sx:{minWidth:24,height:20,"& .MuiChip-label":{px:.75,fontSize:"0.75rem"}}})]})},e.value))}):(0,n.jsx)(eU.A,{fullWidth:!0,size:"small",children:(0,n.jsx)(eO.A,{value:m.value,onChange:e=>m.onChange(null,e.target.value),sx:{"& .MuiSelect-select":{display:"flex",alignItems:"center",gap:1}},children:em.ie.map(e=>(0,n.jsx)(eW.default,{value:e.value,children:(0,n.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",gap:1,width:"100%"},children:[(0,n.jsx)(p.default,{sx:{flexGrow:1},children:e.label}),(0,n.jsx)(G.default,{label:S[e.value]||0,size:"small",color:"overdue"===e.value?S.overdue>0?"error":"success":"primary",sx:{minWidth:24,height:20,"& .MuiChip-label":{px:.75,fontSize:"0.75rem"}}})]})},e.value))})})}),(0,n.jsx)(i.A,{sx:{flex:1,overflow:"hidden"},children:(0,n.jsx)(eG.Z,{sx:{height:"100%",overflowY:"auto",pb:2},children:N})})]}),null!==w&&(0,n.jsx)(ev,{open:c.value,onClose:()=>{c.onFalse(),j(null)},openedItem:w,actionItemsMutate:g})]})});lr.displayName="AnalyticsTasks";let ls=(0,y.memo)(function(e){var l;let{item:t,selected:a,onChange:o,setOpenedItem:r,sx:s,onStatusUpdate:d,currentTab:c,...m}=e,[h,x]=(0,y.useState)(!1),[f,v]=(0,y.useState)(!1),[g,b]=(0,y.useState)(null),[w,C]=(0,y.useState)(!1),[A,S]=(0,y.useState)(null),{followUpData:I,followUpLoading:D}=(0,eH.CE)(t.FollowUpsId),N=(0,y.useMemo)(()=>lo(t.Status),[t.Status]),k=(0,y.useMemo)(()=>{var e,l,a,o,n,r,s;return[{label:"Lead",value:null==(e=t.lead)?void 0:e.LeadName},{label:"Site",value:null==(a=t.lead)||null==(l=a.site)?void 0:l.SiteName},{label:"Contact",value:null==(n=t.lead)||null==(o=n.contacts)?void 0:o.ContactFName},{label:"Contact No.",value:null==(s=t.lead)||null==(r=s.contacts)?void 0:r.ContactNo}]},[t.lead]),E=(0,y.useMemo)(()=>[{pl:2,pr:1,display:"flex",alignItems:"center",..."today"===c&&"Completed"===N&&{bgcolor:"success.lighter"},...a&&{color:"text.disabled",textDecoration:"line-through"}},...Array.isArray(s)?s:[s]],[a,s,c,N]),T=(0,y.useCallback)(()=>{r(t)},[t]),R=(0,y.useCallback)(e=>{e.preventDefault(),x(!0)},[]),F=(0,y.useCallback)(async e=>{if("Completed"===e&&t.FollowUpsId&&I&&!D&&I){S(I),C(!0),x(!1);return}v(!0),b(e);try{let l={ActionItemName:t.ActionItemName,Status:e,AllotedToUserId:t.AllotedToUserId,ProposedEndDate:t.ProposedEndDate,Description:t.Description,LeadId:t.LeadId||null,VisitId:t.VisitId||null};await Q(t.ActionItemId,l),u.oR.success('Todo status updated to "'.concat(e,'" successfully!')),d&&await d(),x(!1)}catch(e){u.oR.error("Error updating todo status!")}finally{v(!1),b(null)}},[t.ActionItemId,t.ActionItemName,t.FollowUpsId,I,D,d]),L=(0,y.useCallback)(()=>{f||x(!1)},[f]),U=(0,y.useCallback)(async e=>{try{let l={ActionItemName:t.ActionItemName,Status:"Completed",AllotedToUserId:t.AllotedToUserId,ProposedEndDate:t.ProposedEndDate,Description:t.Description,LeadId:t.LeadId||null,VisitId:t.VisitId||null};await Q(t.ActionItemId,l);let a={UserId:I.UserId,FollowUpType:I.FollowUpType,Status:e.followUpStatus,Notes:e.followUpNotes,FollowUpDate:I.FollowUpDate,NextFollowUpDate:I.NextFollowUpDate};I.LeadId&&(a.LeadId=I.LeadId),I.VisitId&&(a.VisitId=I.VisitId),await (0,eB.Y3)(a,e.followUpId),e.createNextFollowUp&&e.nextFollowUp&&await (0,eB.XL)(e.nextFollowUp),d&&await d()}catch(e){throw console.error("Error completing follow-up:",e),e}},[t.ActionItemId,t.ActionItemName,I,d]),O=(0,y.useCallback)(()=>{C(!1),S(null)},[]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(i.A,{sx:E,...m,children:[(0,n.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",flexGrow:1},children:[(0,n.jsx)(eE.default,{disableRipple:!0,checked:a,onChange:R,disabled:f,slotProps:{input:{"aria-label":"Mark ".concat(t.ActionItemName," as complete"),id:"".concat(t.ActionItemId,"-checkbox")}}}),(0,n.jsx)(i.A,{sx:{flexGrow:1,ml:1},children:(0,n.jsxs)(ek.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,n.jsx)(p.default,{component:"span",onClick:T,sx:{cursor:"pointer",flexGrow:1},children:t.ActionItemName}),f&&(0,n.jsx)(ey.default,{size:16,thickness:4})]})})]}),(0,n.jsxs)(i.A,{sx:{display:"flex",gap:1,alignItems:"center"},children:[(0,n.jsx)(M.default,{size:"small",disabled:!0,"aria-label":"Call contact",children:(0,n.jsx)(eR.A,{fontSize:"small"})}),(0,n.jsx)(M.default,{size:"small",disabled:!0,"aria-label":"Message contact",children:(0,n.jsx)(eT.A,{fontSize:"small"})})]})]}),(0,n.jsx)(i.A,{sx:{pl:7,pr:1,pb:1},children:k.map(e=>{let{label:l,value:a}=e;return(0,n.jsx)(p.default,{variant:"body2",color:"text.secondary",sx:{fontSize:12},children:"".concat(l,": ").concat(a||"N/A")},"".concat(t.ActionItemId,"-").concat(l))})}),(0,n.jsxs)(ez.A,{open:h,onClose:L,maxWidth:"xs",fullWidth:!0,disableEscapeKeyDown:f,children:[(0,n.jsxs)(eP.A,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,n.jsx)(p.default,{variant:"bold",children:"Change Status"}),!f&&(0,n.jsx)(M.default,{edge:"end",color:"inherit",onClick:L,"aria-label":"close",size:"small",children:(0,n.jsx)(eF.A,{})})]}),(0,n.jsxs)(eM.A,{children:[(0,n.jsxs)(p.default,{variant:"body2",color:"text.secondary",sx:{mb:2},children:["Todo : ",(0,n.jsx)("strong",{children:t.ActionItemName})]}),(0,n.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[(0,n.jsx)(p.default,{variant:"body2",color:"text.secondary",children:"Current status:"}),(0,n.jsx)(G.default,{label:N,size:"small",color:(null==(l=em.ND[N])?void 0:l.color)||"default",variant:"filled"})]})]}),(0,n.jsx)(eV.default,{sx:{p:2,pt:0},children:(0,n.jsx)(ek.A,{direction:"column",spacing:1,sx:{width:"100%"},children:Object.entries(em.ND).map(e=>{let[l,t]=e;return(0,n.jsx)(j.default,{variant:N===l?"contained":"outlined",color:t.color,onClick:()=>F(l),disabled:f||N===l,startIcon:f&&g===l?(0,n.jsx)(ey.default,{size:16}):null,sx:{justifyContent:"flex-start",textTransform:"none"},children:f&&g===l?"Updating to ".concat(t.label,"..."):"Mark as ".concat(t.label)},l)})})})]}),w&&A&&(0,n.jsx)(e9,{open:w,onClose:O,todo:t,followUp:A,onComplete:U})]})}),li=(0,y.memo)(function(){return(0,n.jsx)(lr,{title:"TO-DOs"})});function ld(){let e=(0,r.default)();return(0,s.A)(e.breakpoints.down("sm"))?(0,n.jsx)(d.KG,{maxWidth:"2xl",children:(0,n.jsxs)(i.A,{sx:{flex:"1 1 auto",gap:2,display:"grid",gridTemplateColumns:"1fr",gridTemplateRows:"auto auto minmax(0, 400px) minmax(0, 500px)",overflow:"hidden"},children:[(0,n.jsx)(g,{}),(0,n.jsx)(eN,{}),(0,n.jsx)(i.A,{sx:{maxHeight:"400px",overflow:"auto",borderRadius:1},children:(0,n.jsx)(li,{})}),(0,n.jsx)(i.A,{sx:{maxHeight:"500px",overflow:"auto",borderRadius:1},children:(0,n.jsx)(T,{})})]})}):(0,n.jsx)(d.KG,{maxWidth:"2xl",children:(0,n.jsxs)(i.A,{sx:{flex:"1 1 auto",gap:2,display:"grid",gridTemplateColumns:{xs:"1fr",md:"1fr auto"},height:"100%",overflow:"hidden"},children:[(0,n.jsxs)(i.A,{sx:{gap:1,display:"grid",gridTemplateColumns:"1fr",gridTemplateRows:"auto 1fr",minHeight:0,overflow:"hidden",height:"calc(100vh - 100px)"},children:[(0,n.jsx)(g,{}),(0,n.jsx)(T,{})]}),(0,n.jsxs)(i.A,{sx:{gap:1,display:"grid",gridTemplateColumns:"1fr",gridTemplateRows:"auto 1fr",minHeight:0,overflow:"hidden",height:"calc(100vh - 100px)"},children:[(0,n.jsx)(eN,{}),(0,n.jsx)(li,{})]})]})})}li.displayName="BottomRightCard"},88165:(e,l,t)=>{"use strict";t.d(l,{Ey:()=>c,Me:()=>h,OB:()=>i,Q6:()=>p,aA:()=>u,cF:()=>m,eL:()=>d,tR:()=>s});var a=t(19169),o=t(12115),n=t(18835);let r={revalidateIfStale:!1,revalidateOnFocus:!1,revalidateOnReconnect:!1},s=async e=>{let l=n.vZ.leads.create;return(await (0,n.$P)([l,e])).data};function i(e){let l=e?[n.vZ.leads.readSingleInDetail(e)]:"",{data:t,isLoading:s,error:i,isValidating:d,mutate:u}=(0,a.Ay)(l,n.GO,r);return(0,o.useMemo)(()=>({detailedLeadData:null!=t?t:[],detailedLeadLoading:s,detailedLeadError:i?(null==i?void 0:i.message)||"Error fetching (useGetDetailedLead)":null,detailedLeadValidating:d,detailedLeadEmpty:!s&&!d&&(!Array.isArray(t)||0===t.length),refetch:()=>u()}),[t,i,s,d,u])}function d(e,l){let t=n.vZ.leads.paginationBuyerWiseLeads(e,l),{data:s,isLoading:i,error:d,isValidating:u,mutate:c}=(0,a.Ay)(t,n.GO,r);return(0,o.useMemo)(()=>({bwLeadsData:null!=s?s:[],bwLeadsLoading:i,bwLeadsError:d?(null==d?void 0:d.message)||"Error fetching data":null,bwLeadsValidating:u,bwLeadsEmpty:!i&&!u&&(!Array.isArray(s)||0===s.length)}),[s,d,i,u,c])}let u=function(e,l){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=n.vZ.leads.readAllInDetail(e,l,t),{data:i,isLoading:d,error:u,isValidating:c,mutate:p}=(0,a.Ay)(s,async t=>{try{return await (0,n.GO)(t)}catch(t){if("No records found for the given filter(s)."===t)return{data:[],total_records:0,sIndex:e,limit:l};throw t}},r);return(0,o.useMemo)(()=>({detailedLeadsData:null!=i?i:[],detailedLeadsLoading:d,detailedLeadsError:u?(null==u?void 0:u.message)||"Error fetching data":null,detailedLeadsIsValidating:c,detailedLeadsEmpty:!d&&!c&&(!i||!i.data||0===i.data.length),refetch:()=>p()}),[i,d,u,c,p])};function c(){let e=n.vZ.leads.aggregates,{data:l,isLoading:t,error:r,mutate:s}=(0,a.Ay)(e,n.ev,{revalidateIfStale:!0,revalidateOnFocus:!0,revalidateOnReconnect:!0,dedupingInterval:3e4,shouldRetryOnError:e=>{var l;let t=null==e||null==(l=e.response)?void 0:l.status;return!(t>=400)||!(t<500)},errorRetryCount:2,errorRetryInterval:5e3,onError:(e,l)=>{var t;console.error("[Aggregates Error]",{endpoint:l,status:null==e||null==(t=e.response)?void 0:t.status,message:e.message,timestamp:new Date().toISOString()})}});return(0,o.useMemo)(()=>{var e;return{aggregatesData:null!=(e=null==l?void 0:l.aggregates)?e:{},aggregatesLoading:t,aggregatesError:r,refetchAggregates:s}},[l,t,r,s])}async function p(e,l){let t=n.vZ.leads.update(e);await (0,n.mu)([t,l])}async function m(e,l){let t=n.vZ.leads.update(e);return await (0,n.tD)([t,l])}let h=(e,l,t)=>{let s=e=>null!=e&&""!==e,i=s(e)||s(l)||s(t),d=i?n.vZ.leads.search(e,l,t):null,{data:u,isLoading:c,error:p,isValidating:m,mutate:h}=(0,a.Ay)(d,n.GO,r);return(0,o.useMemo)(()=>({searchedLeadsData:i&&null!=u?u:[],searchedLeadsLoading:!!i&&c,searchedLeadsError:i&&p?(null==p?void 0:p.message)||"Error fetching data":null,searchedLeadsIsValidating:!!i&&m,searchedLeadsEmpty:!c&&!m&&(!Array.isArray(u)||0===u.length),refetchSearchedLeads:()=>h(),hasParams:i}),[u,c,p,m,h,i])}},91993:(e,l,t)=>{Promise.resolve().then(t.bind(t,80596))}},e=>{var l=l=>e(e.s=l);e.O(0,[544,5004,277,2051,2156,6635,3003,7433,8500,3683,1256,6292,7950,4515,1695,117,1641,2230,3807,4281,1457,9912,9243,2987,2973,204,119,779,3296,1743,7696,6414,7594,6494,567,7452,5510,218,4961,9669,8441,1684,7358],()=>l(91993)),_N_E=e.O()}]);