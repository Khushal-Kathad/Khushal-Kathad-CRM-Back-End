"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2591],{18088:(e,l,t)=>{t.d(l,{Q:()=>j});var a=t(95155),n=t(12115),r=t(62177),i=t(36339),o=t(73746),s=t(42861),d=t(21030),u=t(80158),c=t(96801),x=t(9670),h=t(53494),p=t(62516),f=t(71984),m=t(38867),g=t(28292),b=t(95383);function j(){var e,l,t,j,v,y;let{sitesData:S,sitesLoading:C}=(0,f.MZ)(),A=(0,n.useMemo)(()=>!C&&(null==S?void 0:S.length)?S.map(e=>({id:e.SiteId,name:e.SiteName||"Name Not Found",fullAddress:e.SiteAddress||"Address Not Found"})):[],[S,C]),{watch:w,setValue:k,formState:{errors:D}}=(0,r.xW)(),I=w(),F=(0,o.default)(),N=(0,s.A)(F.breakpoints.up("md")),z=(0,i.Cg)(),T=(0,i.Cg)();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(d.A,{divider:(0,a.jsx)(u.default,{flexItem:!0,orientation:N?"vertical":"horizontal",sx:{borderStyle:"dashed"}}),sx:{p:3,gap:{xs:3,md:5},flexDirection:{xs:"column",md:"row"}},children:[(0,a.jsxs)(d.A,{sx:{width:1},children:[(0,a.jsxs)(c.A,{sx:{mb:1,display:"flex",alignItems:"center"},children:[(0,a.jsxs)(x.default,{variant:"h6",sx:{color:"text.disabled",flexGrow:1},children:["Contact Details: ",(0,a.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,a.jsx)(h.default,{onClick:T.onTrue,children:(0,a.jsx)(m.W,{icon:"solar:pen-bold"})})]}),(0,a.jsxs)(d.A,{spacing:1,children:[!I.contactDetails&&D.contactDetails&&(0,a.jsx)(x.default,{typography:"caption",sx:{color:"error.main"},children:null==(e=D.contactDetails)?void 0:e.message}),I.contactDetails?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(x.default,{variant:"subtitle2",children:["Name : ",null==(l=I.contactDetails)?void 0:l.name]}),(0,a.jsxs)(x.default,{variant:"body2",children:["Mo.No. : ",null==(t=I.contactDetails)?void 0:t.phoneNumber]})]}):(0,a.jsx)(x.default,{variant:"body2",sx:{color:"text.secondary"},children:"No contact selected"})]})]}),(0,a.jsxs)(d.A,{sx:{width:1},children:[(0,a.jsxs)(c.A,{sx:{mb:1,display:"flex",alignItems:"center"},children:[(0,a.jsxs)(x.default,{variant:"h6",sx:{color:"text.disabled",flexGrow:1},children:["Interested Site Details: ",(0,a.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,a.jsx)(h.default,{onClick:z.onTrue,disabled:C,children:C?(0,a.jsx)(p.default,{size:20}):(0,a.jsx)(m.W,{icon:"solar:pen-bold"})})]}),(0,a.jsxs)(d.A,{spacing:1,children:[!I.siteDetails&&D.siteDetails&&(0,a.jsx)(x.default,{typography:"caption",sx:{color:"error.main"},children:null==(j=D.siteDetails)?void 0:j.message}),I.siteDetails?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(x.default,{variant:"subtitle2",children:["Name : ",null==(v=I.siteDetails)?void 0:v.name]}),(0,a.jsxs)(x.default,{variant:"body2",children:["Address : ",null==(y=I.siteDetails)?void 0:y.fullAddress]})]}):(0,a.jsx)(x.default,{variant:"body2",sx:{color:"text.secondary"},children:"No site selected"})]})]})]}),(0,a.jsx)(g.Tt,{title:"Contacts List",type:"Customer",open:T.value,onClose:T.onFalse,selected:e=>{var l;return(null==(l=I.contactDetails)?void 0:l.id)===e},onSelect:e=>k("contactDetails",e,{shouldDirty:!0,shouldValidate:!0})}),(0,a.jsx)(b.ND,{title:"Sites List",open:z.value,onClose:z.onFalse,selected:e=>{var l;return(null==(l=I.siteDetails)?void 0:l.id)===e},onSelect:e=>k("siteDetails",e,{shouldDirty:!0,shouldValidate:!0}),list:A})]})}},32591:(e,l,t)=>{t.d(l,{NN:()=>H,Jh:()=>eg,vo:()=>e0,e$:()=>em,up:()=>eP.u,Jw:()=>I,H:()=>eX,HA:()=>et,Cy:()=>B,Ti:()=>ez,oB:()=>ey,uC:()=>x,qk:()=>eV,V1:()=>ec,N$:()=>eW,xE:()=>eS,Md:()=>eK,Z3:()=>eC,Ed:()=>el});var a=t(95155);t(69004);var n=t(12115),r=t(84256),i=t(9670),o=t(96801),s=t(53494),d=t(78822),u=t(14208),c=t(38867);function x(e){let{currentLead:l,setCurrentLead:t}=e,[x,h]=(0,n.useState)(!1),[p,f]=(0,n.useState)((null==l?void 0:l.LeadNotes)||"");(0,n.useEffect)(()=>{f((null==l?void 0:l.LeadNotes)||"")},[null==l?void 0:l.LeadNotes]);let m=()=>{x&&t(e=>({...e,LeadNotes:p})),h(e=>!e)};return(0,a.jsxs)(r.A,{sx:{p:3,position:"relative"},children:[(0,a.jsx)(i.default,{variant:"h6",sx:{mb:2},children:"Lead Notes"}),x?(0,a.jsxs)(o.A,{children:[(0,a.jsx)(u.K,{simple:!0,id:"lead-notes-editor",value:p,onChange:f,sx:{minHeight:200}}),(0,a.jsxs)(o.A,{sx:{display:"flex",gap:1,mt:2,justifyContent:"flex-end"},children:[(0,a.jsx)(s.default,{onClick:()=>{f((null==l?void 0:l.LeadNotes)||""),h(!1)},size:"small",children:(0,a.jsx)(d.default,{title:"Cancel",arrow:!0,children:(0,a.jsx)(c.W,{icon:"solar:close-circle-bold"})})}),(0,a.jsx)(s.default,{onClick:m,size:"small",children:(0,a.jsx)(d.default,{title:"Save",arrow:!0,children:(0,a.jsx)(c.W,{icon:"fa-solid:check"})})})]})]}):(0,a.jsxs)(a.Fragment,{children:[p&&""!==p.trim()?(0,a.jsx)(o.A,{dangerouslySetInnerHTML:{__html:p},sx:{"& p":{margin:0,marginBottom:1},"& p:last-child":{marginBottom:0},"& ul, & ol":{marginTop:.5,marginBottom:.5,paddingLeft:2},"& h1, & h2, & h3, & h4, & h5, & h6":{marginTop:.5,marginBottom:.5},fontSize:"0.875rem",lineHeight:1.5,minHeight:100,p:2,bgcolor:"background.neutral",borderRadius:1}}):(0,a.jsx)(o.A,{sx:{p:3,minHeight:100,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"background.neutral",borderRadius:1},children:(0,a.jsx)(i.default,{variant:"body2",color:"text.secondary",children:"No notes added yet. Click edit to add notes."})}),(0,a.jsx)(s.default,{onClick:m,sx:{position:"absolute",top:22,right:16},children:(0,a.jsx)(d.default,{title:"Edit",arrow:!0,children:(0,a.jsx)(c.W,{icon:"solar:pen-bold"})})})]})]})}t(32030);var h=t(36906),p=t(35881),f=t(66292),m=t(66587),g=t(2360),b=t(30832),j=t.n(b),v=t(20837),y=t(21030),S=t(31847);function C(e){let{filters:l,options:t,onResetPage:r,sortOptions:d,currentSortBy:u,onSortChange:x}=e,[h,p]=(0,n.useState)(!1),[m,g]=(0,n.useState)(!1),{state:b,setState:C}=l,A=(0,n.useCallback)(()=>{let e=[],{leadStatus:l,leadSource:t,site:a,prospect:n,startDate:r,endDate:i,broker:o,customer:s,healthScoreRange:d,buyingIntent:u,followUpStatus:c}=b;return(null==l?void 0:l.length)>0&&e.push({label:"Status",value:l.length,key:"leadStatus"}),(null==t?void 0:t.length)>0&&e.push({label:"Source",value:t.length,key:"leadSource"}),(null==a?void 0:a.length)>0&&e.push({label:"Sites",value:a.length,key:"site"}),(null==n?void 0:n.length)>0&&e.push({label:"Buyer Type",value:n.length,key:"prospect"}),r&&e.push({label:"Start Date",value:j()(r).format("MMM D, YYYY"),key:"startDate"}),i&&e.push({label:"End Date",value:j()(i).format("MMM D, YYYY"),key:"endDate"}),(null==o?void 0:o.value)&&e.push({label:"Broker",value:o.label,key:"broker"}),(null==s?void 0:s.value)&&e.push({label:"Customer",value:s.label,key:"customer"}),d&&e.push({label:"Health",value:{25:"Critical",50:"Attention",75:"Healthy"}[d],key:"healthScoreRange"}),u&&e.push({label:"Intent",value:{3:"Cold",6:"Warm",9:"Hot"}[u],key:"buyingIntent"}),c&&e.push({label:"Follow-up",value:S.Li[c]||c,key:"followUpStatus"}),e},[b]),{leadStatus:w,leadSource:k,site:D,prospect:I,startDate:F,endDate:N,broker:z,customer:T,healthScoreRange:M,buyingIntent:W,followUpStatus:E}=b,L=[(null==w?void 0:w.length)>0,(null==k?void 0:k.length)>0,(null==D?void 0:D.length)>0,(null==I?void 0:I.length)>0,!!F,!!N,!!(null==z?void 0:z.value),!!(null==T?void 0:T.value),!!M,!!W,!!E].filter(Boolean).length;return(0,a.jsxs)(a.Fragment,{children:[L>0&&(0,a.jsxs)(o.A,{sx:{px:1.5,pb:.5},children:[(0,a.jsx)(f.default,{fullWidth:!0,size:"small",variant:"text",color:"inherit",onClick:()=>g(!m),endIcon:(0,a.jsx)(c.W,{icon:m?"eva:arrow-up-fill":"eva:arrow-down-fill",width:16}),sx:{justifyContent:"space-between",color:"text.secondary","&:hover":{bgcolor:"action.hover"}},children:(0,a.jsxs)(i.default,{variant:"caption",children:[m?"Hide":"Show"," Active Filters (",L,")"]})}),(0,a.jsx)(v.A,{in:m,children:(0,a.jsxs)(y.A,{spacing:1,sx:{mt:1},children:[A().map(e=>(0,a.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",p:1,bgcolor:"background.neutral",borderRadius:1},children:[(0,a.jsxs)(i.default,{variant:"caption",sx:{fontWeight:600},children:[e.label,":"]}),(0,a.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",gap:.5},children:[(0,a.jsx)(i.default,{variant:"caption",color:"text.secondary",children:"number"==typeof e.value?"".concat(e.value," selected"):e.value}),(0,a.jsx)(s.default,{size:"small",onClick:()=>{let l={};"startDate"===e.key||"endDate"===e.key||"broker"===e.key||"customer"===e.key?l[e.key]=null:"healthScoreRange"===e.key||"buyingIntent"===e.key||"followUpStatus"===e.key?l[e.key]="":l[e.key]=[],C(l),r()},sx:{p:.25},children:(0,a.jsx)(c.W,{icon:"eva:close-circle-fill",width:16})})]})]},e.key)),(0,a.jsx)(f.default,{fullWidth:!0,size:"small",variant:"outlined",color:"error",startIcon:(0,a.jsx)(c.W,{icon:"eva:trash-2-outline"}),onClick:()=>{C({leadStatus:[],leadSource:[],site:[],prospect:[],startDate:null,endDate:null,broker:null,customer:null,healthScoreRange:"",healthScoreMin:null,healthScoreMax:null,buyingIntent:"",buyingIntentMin:null,buyingIntentMax:null,overdueDaysMin:null,overdueDaysMax:null,followUpStatus:""}),r(),g(!1)},children:"Clear All Filters"})]})})]}),(0,a.jsx)(eV,{open:h,onClose:()=>p(!1),filters:l,options:t,onResetPage:r})]})}var A=t(52717),w=t(91580),k=t(98294);function D(e){var l,t,r,i,o,s,d,u,c,x,h,p,f,m;let{filters:g,onResetPage:b,totalResults:j,options:v,sx:y}=e,{state:S,setState:C}=g,D=(0,n.useCallback)(e=>{let l=S.leadStatus.filter(l=>l!==e);b(),C({leadStatus:l})},[S.leadStatus,b,C]),I=(0,n.useCallback)(()=>{b(),C({leadStatus:[]})},[b,C]),F=(0,n.useCallback)(e=>{let l=S.leadSource.filter(l=>l!==e);b(),C({leadSource:l})},[S.leadSource,b,C]),N=(0,n.useCallback)(()=>{b(),C({leadSource:[]})},[b,C]),z=(0,n.useCallback)(e=>{let l=S.site.filter(l=>l!==e);b(),C({site:l})},[S.site,b,C]),T=(0,n.useCallback)(()=>{b(),C({site:[]})},[b,C]),M=(0,n.useCallback)(e=>{let l=S.prospect.filter(l=>l!==e);b(),C({prospect:l})},[S.prospect,b,C]),W=(0,n.useCallback)(()=>{b(),C({prospect:[]})},[b,C]),E=(0,n.useCallback)(()=>{b(),C({startDate:null})},[b,C]),L=(0,n.useCallback)(()=>{b(),C({endDate:null})},[b,C]),B=(0,n.useCallback)(()=>{b(),C({broker:null})},[b,C]),H=(0,n.useCallback)(()=>{b(),C({customer:null})},[b,C]);(0,n.useCallback)(()=>{b(),C({healthScoreRange:""})},[b,C]),(0,n.useCallback)(()=>{b(),C({buyingIntent:""})},[b,C]);let R=(0,n.useCallback)(()=>{b(),C({followUpStatus:""})},[b,C]),U=(e,l)=>{let t=(v[e]||[]).find(e=>e.value===l);return t?t.label:String(l)},O=(e,l)=>{if("healthScore"===e)switch(l){case"25":return"Critical (<40)";case"50":return"Attention (40-69)";case"75":return"Healthy (≥70)";default:return l}if("buyingIntent"===e)switch(l){case"3":return"Cold (<5)";case"6":return"Warm (5-7)";case"9":return"Hot (≥8)";default:return l}if("followUpStatus"===e)switch(l){case"overdue":return"Overdue";case"today":return"Due Today";case"this_week":return"Due This Week";case"scheduled":return"Scheduled";default:return(0,A.Z)(l)}return l},P=(0,n.useCallback)(()=>{b(),C({leadStatus:[],leadSource:[],site:[],prospect:[],startDate:null,endDate:null,broker:null,customer:null,healthScoreRange:"",healthScoreMin:null,healthScoreMax:null,buyingIntent:"",buyingIntentMin:null,buyingIntentMax:null,overdueDaysMin:null,overdueDaysMax:null,followUpStatus:""})},[b,C]);return(0,a.jsxs)(k.T7,{totalResults:j,onReset:P,sx:y,children:[(0,a.jsxs)(k.Hv,{label:"Lead Status:",isShow:(null==(l=S.leadStatus)?void 0:l.length)>0,children:[S.leadStatus.map(e=>(0,n.createElement)(w.default,{...k.NJ,key:e,label:(0,A.Z)(e),onDelete:()=>D(e)})),(null==(t=S.leadStatus)?void 0:t.length)>1&&(0,a.jsx)(w.default,{...k.NJ,label:"Clear All Statuses",onDelete:I,color:"error",variant:"outlined"})]}),(0,a.jsxs)(k.Hv,{label:"Lead Source:",isShow:(null==(r=S.leadSource)?void 0:r.length)>0,children:[S.leadSource.map(e=>(0,n.createElement)(w.default,{...k.NJ,key:e,label:(0,A.Z)(e),onDelete:()=>F(e)})),(null==(i=S.leadSource)?void 0:i.length)>1&&(0,a.jsx)(w.default,{...k.NJ,label:"Clear All Sources",onDelete:N,color:"error",variant:"outlined"})]}),(0,a.jsxs)(k.Hv,{label:"Sites:",isShow:(null==(o=S.site)?void 0:o.length)>0,children:[S.site.map(e=>(0,n.createElement)(w.default,{...k.NJ,key:e,label:U("site",e),onDelete:()=>z(e)})),(null==(s=S.site)?void 0:s.length)>1&&(0,a.jsx)(w.default,{...k.NJ,label:"Clear All Sites",onDelete:T,color:"error",variant:"outlined"})]}),(0,a.jsxs)(k.Hv,{label:"Buyer Type:",isShow:(null==(d=S.prospect)?void 0:d.length)>0,children:[S.prospect.map(e=>(0,n.createElement)(w.default,{...k.NJ,key:e,label:U("prospect",e),onDelete:()=>M(e)})),(null==(u=S.prospect)?void 0:u.length)>1&&(0,a.jsx)(w.default,{...k.NJ,label:"Clear All Types",onDelete:W,color:"error",variant:"outlined"})]}),(0,a.jsx)(k.Hv,{label:"Lead Created From:",isShow:!!S.startDate,children:(0,a.jsx)(w.default,{...k.NJ,label:S.startDate,onDelete:E})}),(0,a.jsx)(k.Hv,{label:"Lead Created To:",isShow:!!S.endDate,children:(0,a.jsx)(w.default,{...k.NJ,label:S.endDate,onDelete:L})}),(0,a.jsx)(k.Hv,{label:"Broker:",isShow:!!(null==(c=S.broker)?void 0:c.value),children:(0,n.createElement)(w.default,{...k.NJ,key:null==(x=S.broker)?void 0:x.value,label:null==(h=S.broker)?void 0:h.label,onDelete:B})}),(0,a.jsx)(k.Hv,{label:"Customer:",isShow:!!(null==(p=S.customer)?void 0:p.value),children:(0,n.createElement)(w.default,{...k.NJ,key:null==(f=S.customer)?void 0:f.value,label:null==(m=S.customer)?void 0:m.label,onDelete:H})}),(0,a.jsx)(k.Hv,{label:"Health Score:",isShow:!!S.healthScoreRange||null!=S.healthScoreMin||null!=S.healthScoreMax,children:(0,a.jsx)(w.default,{...k.NJ,label:S.healthScoreRange?O("healthScore",S.healthScoreRange):null!=S.healthScoreMax&&null==S.healthScoreMin?"< ".concat(S.healthScoreMax+1):null!=S.healthScoreMin&&null==S.healthScoreMax?"≥ ".concat(S.healthScoreMin):"".concat(S.healthScoreMin,"-").concat(S.healthScoreMax),onDelete:()=>{b(),C({healthScoreRange:"",healthScoreMin:null,healthScoreMax:null})}})}),(0,a.jsx)(k.Hv,{label:"Buying Intent:",isShow:!!S.buyingIntent||null!=S.buyingIntentMin||null!=S.buyingIntentMax,children:(0,a.jsx)(w.default,{...k.NJ,label:S.buyingIntent?O("buyingIntent",S.buyingIntent):null!=S.buyingIntentMin&&null==S.buyingIntentMax?"≥ ".concat(S.buyingIntentMin):null!=S.buyingIntentMax&&null==S.buyingIntentMin?"< ".concat(S.buyingIntentMax+1):"".concat(S.buyingIntentMin,"-").concat(S.buyingIntentMax),onDelete:()=>{b(),C({buyingIntent:"",buyingIntentMin:null,buyingIntentMax:null})}})}),(0,a.jsx)(k.Hv,{label:"Overdue:",isShow:null!=S.overdueDaysMin||null!=S.overdueDaysMax,children:(0,a.jsx)(w.default,{...k.NJ,label:null!=S.overdueDaysMin&&null==S.overdueDaysMax?"> ".concat(S.overdueDaysMin-1," days"):null!=S.overdueDaysMax&&null==S.overdueDaysMin?"≤ ".concat(S.overdueDaysMax," days"):"".concat(S.overdueDaysMin,"-").concat(S.overdueDaysMax," days"),onDelete:()=>{b(),C({overdueDaysMin:null,overdueDaysMax:null})}})}),(0,a.jsx)(k.Hv,{label:"Follow-up Status:",isShow:!!S.followUpStatus,children:(0,a.jsx)(w.default,{...k.NJ,label:O("followUpStatus",S.followUpStatus),onDelete:R})})]})}(0,p.default)(h.e)({marginLeft:"auto"});let I=(0,n.memo)(function(e){let{filters:l,canReset:t,filteredResults:r,totalRecords:s,hasActiveFilters:d,leadStatusOptions:u,leadSourceOptions:c,prospectOptions:x,siteOptions:h,STATUS_OPTIONS:p,SORT_OPTIONS:b,selectedRowIds:j,handleMassUpdateStatus:v,onResetPage:y,viewMode:S,isMobile:A,currentSortBy:w,onSortChange:k}=e,[I,F]=(0,n.useState)(null),N=(0,n.useCallback)(e=>{F(e.currentTarget)},[]),z=(0,n.useCallback)(()=>{F(null)},[]),T=(0,n.useCallback)(e=>{v(e),z()},[v,z]),M=j.length>0;return(0,a.jsxs)(o.A,{sx:{display:"flex",flexDirection:"column",p:.5},children:[(0,a.jsx)(C,{onResetPage:y,filters:l,options:{leadStatus:u,leadSource:c,site:h,prospect:x},sortOptions:b,currentSortBy:w,onSortChange:k,isMobile:A}),M&&"table"===S&&(0,a.jsx)(o.A,{sx:{display:"flex",justifyContent:"flex-end",mb:.5},children:(0,a.jsx)(f.default,{size:"small",color:"secondary",variant:"outlined",onClick:N,children:"Actions"})}),(0,a.jsx)(m.A,{anchorEl:I,open:!!I,onClose:z,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:p.map(e=>{let{label:l,color:t}=e;return(0,a.jsx)(g.default,{onClick:()=>T(l),children:(0,a.jsxs)(i.default,{variant:"body2",sx:{display:"flex",alignItems:"center"},children:["Qualify"!==l?"Mark":"",(0,a.jsx)(o.A,{component:"span",sx:{backgroundColor:t,color:"white",borderRadius:"4px",px:.5,ml:.5},children:l})]})},l)})}),t&&(0,a.jsx)(D,{onResetPage:y,filters:l,totalResults:s,options:{site:h,prospect:x},sx:{p:2.5}})]})});var F=t(38543),N=t(73746),z=t(62516),T=t(7433),M=t(15589),W=t(80158),E=t(88165);let L=(0,n.memo)(function(e){var l,t,d,u;let{lead:x,onRefresh:h,onOpenFollowUp:p,onViewDetails:m}=e,g=(0,N.default)(),[b,j]=(0,n.useState)(!1),[v,C]=(0,n.useState)(!1),A=(0,n.useCallback)(async e=>{j(!0);try{await (0,E.cF)(x.id,{LeadName:x.leadName,LeadStatus:e}),F.oR.success("Lead status updated to ".concat(e),{containerId:"success"}),h&&h(),C(!1)}catch(e){F.oR.error(e.message||"Failed to update lead status",{containerId:"error"})}finally{j(!1)}},[x,h]),k=(d=x.buyingIntent)||0===d?d>=8?{label:"Hot",color:g.palette.error.main,bgcolor:g.palette.error.lighter||"".concat(g.palette.error.main,"15"),icon:"\uD83D\uDD25"}:d>=5?{label:"Warm",color:g.palette.warning.main,bgcolor:g.palette.warning.lighter||"".concat(g.palette.warning.main,"15"),icon:"\uD83D\uDD36"}:{label:"Cold",color:g.palette.info.main,bgcolor:g.palette.info.lighter||"".concat(g.palette.info.main,"15"),icon:"\uD83E\uDDCA"}:null,D=(u=x.healthScore)||0===u?u<40?g.palette.error.main:u<70?g.palette.warning.main:g.palette.success.main:g.palette.grey[500],I={New:"info",Open:"primary",Qualify:"secondary",Win:"success",Lost:"error",Stale:"grey"}[x.leadStatus]||"grey";return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(r.A,{sx:{p:1.5,mb:1.5,position:"relative",transition:"all 0.2s",cursor:"pointer","&:hover":{boxShadow:(null==(l=g.customShadows)?void 0:l.z8)||4,transform:"translateY(-1px)",borderColor:"primary.main"}},onClick:()=>m(x),children:[b&&(0,a.jsx)(o.A,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,bgcolor:"dark"===g.palette.mode?"rgba(0, 0, 0, 0.7)":"rgba(255, 255, 255, 0.8)",backdropFilter:"blur(2px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10,borderRadius:1},children:(0,a.jsx)(z.default,{})}),(0,a.jsxs)(o.A,{sx:{display:"flex",justifyContent:"space-between",mb:1,alignItems:"flex-start"},children:[(0,a.jsxs)(y.A,{spacing:.25,sx:{flex:1},children:[(0,a.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",gap:.5},children:[(0,a.jsx)(s.default,{size:"small",sx:{p:.5,color:"primary.main","&:hover":{bgcolor:"dark"===g.palette.mode?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.04)"}},onClick:e=>{e.stopPropagation(),m(x)},children:(0,a.jsx)(c.W,{icon:"eva:eye-fill",width:18})}),(0,a.jsx)(i.default,{variant:"subtitle1",sx:{fontWeight:600,fontSize:"0.95rem",cursor:"pointer","&:hover":{color:"primary.main"}},children:x.leadName})]}),(0,a.jsx)(i.default,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.7rem",ml:3},children:x.siteName||"No site assigned"})]}),(0,a.jsx)(w.default,{label:x.leadStatus,size:"small",sx:{backgroundColor:null==(t=g.palette[I])?void 0:t.main,color:"white",fontWeight:600,height:24,fontSize:"0.75rem"}})]}),(0,a.jsxs)(y.A,{direction:"row",spacing:1.5,mb:1.5,alignItems:"center",flexWrap:"wrap",children:[(0,a.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",gap:.5},children:[(0,a.jsx)(c.W,{icon:"eva:person-fill",width:16,sx:{color:"text.secondary"}}),(0,a.jsx)(i.default,{variant:"body2",sx:{fontWeight:500,fontSize:"0.85rem"},children:x.customerName||"No customer"})]}),x.customerContact&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.default,{variant:"body2",color:"text.disabled",sx:{fontSize:"0.85rem"},children:"•"}),(0,a.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",gap:.5},children:[(0,a.jsx)(c.W,{icon:"eva:phone-fill",width:16,sx:{color:"text.secondary"}}),(0,a.jsx)(i.default,{variant:"body2",color:"text.secondary",sx:{fontSize:"0.85rem"},children:x.customerContact})]})]})]}),(0,a.jsxs)(y.A,{direction:"row",spacing:1.5,mb:1.5,alignItems:"center",children:[(0,a.jsxs)(o.A,{sx:{flex:1,minWidth:0},children:[(0,a.jsx)(i.default,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.7rem",display:"block"},children:"Health"}),(0,a.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",gap:.5,mt:.25},children:[(0,a.jsx)(i.default,{variant:"body2",sx:{fontWeight:700,color:D,fontSize:"0.9rem",minWidth:"28px"},children:x.healthScore||"—"}),(0,a.jsx)(o.A,{sx:{flex:1,minWidth:0},children:(0,a.jsx)(T.A,{variant:"determinate",value:x.healthScore||0,sx:{height:3,borderRadius:2,backgroundColor:"dark"===g.palette.mode?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.08)","& .MuiLinearProgress-bar":{backgroundColor:D}}})})]})]}),x.aiPriority&&(0,a.jsxs)(o.A,{sx:{textAlign:"center"},children:[(0,a.jsx)(i.default,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.7rem",display:"block"},children:"Priority"}),(0,a.jsx)(w.default,{label:x.aiPriority,size:"small",color:x.aiPriority<=3?"error":x.aiPriority<=6?"warning":"info",sx:{height:22,fontSize:"0.75rem",fontWeight:600,mt:.25,minWidth:32}})]})]}),(0,a.jsxs)(y.A,{direction:"row",spacing:.75,mb:1.25,flexWrap:"wrap",children:[k&&(0,a.jsx)(w.default,{label:"".concat(k.icon," ").concat(k.label),size:"small",sx:{backgroundColor:k.bgcolor,color:k.color,fontWeight:600,height:24,fontSize:"0.7rem"}}),x.followUpStatus&&x.followUpStatus!==S.eX.NONE&&(()=>{let e=(0,S.o4)(x.followUpStatus,x.overdueDays,x.nextFollowUpDate),l={[S.eX.OVERDUE]:{backgroundColor:"#FFE7E7",color:"#FF5630"},[S.eX.TODAY]:{backgroundColor:"#FFF5E6",color:"#FFA500"},[S.eX.THIS_WEEK]:{backgroundColor:"#FFF0E6",color:"#FF8C00"},[S.eX.SCHEDULED]:{backgroundColor:"#E6F4FF",color:"#00B8D9"}}[x.followUpStatus]||{backgroundColor:g.palette.grey[200],color:g.palette.text.secondary};return(0,a.jsx)(w.default,{label:e.label,size:"small",sx:{backgroundColor:l.backgroundColor,color:l.color,height:24,fontSize:"0.7rem",fontWeight:600}})})()]}),(0,a.jsxs)(y.A,{direction:"row",spacing:.75,mt:1.5,children:[(0,a.jsx)(f.default,{size:"small",variant:"outlined",color:"success",startIcon:(0,a.jsx)(c.W,{icon:"ic:baseline-check-circle",width:16}),onClick:e=>{e.stopPropagation(),A("Win")},disabled:"Win"===x.leadStatus||b,sx:{px:1.5,py:.5,fontSize:"0.75rem",minHeight:32},children:"Win"}),(0,a.jsx)(f.default,{size:"small",variant:"outlined",color:"error",startIcon:(0,a.jsx)(c.W,{icon:"mingcute:close-circle-fill",width:16}),onClick:e=>{e.stopPropagation(),A("Lost")},disabled:"Lost"===x.leadStatus||b,sx:{px:1.5,py:.5,fontSize:"0.75rem",minHeight:32},children:"Lost"}),(0,a.jsx)(f.default,{size:"small",variant:"outlined",color:"primary",startIcon:(0,a.jsx)(c.W,{icon:"mdi:calendar-clock",width:16}),onClick:e=>{e.stopPropagation(),p(x)},sx:{px:1.5,py:.5,fontSize:"0.75rem",minHeight:32},children:"Follow-up"})]}),(x.brokerName||x.requestedAmount)&&(0,a.jsx)(o.A,{sx:{mt:1.5,pt:1.5,borderTop:"1px solid",borderColor:"divider"},children:(0,a.jsxs)(y.A,{direction:"row",spacing:1.5,alignItems:"center",flexWrap:"wrap",children:[x.brokerName&&(0,a.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",gap:.5},children:[(0,a.jsx)(c.W,{icon:"mdi:handshake",width:14,sx:{color:"text.secondary"}}),(0,a.jsx)(i.default,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.7rem"},children:x.brokerName})]}),x.requestedAmount&&(0,a.jsxs)(a.Fragment,{children:[x.brokerName&&(0,a.jsx)(i.default,{variant:"caption",color:"text.disabled",sx:{fontSize:"0.7rem"},children:"•"}),(0,a.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",gap:.5},children:[(0,a.jsx)(c.W,{icon:"solar:dollar-bold",width:14,sx:{color:"text.secondary"}}),(0,a.jsxs)(i.default,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.7rem"},children:["₹",(x.requestedAmount/1e5).toFixed(2),"L"]})]})]})]})})]}),(0,a.jsx)(M.A,{anchor:"bottom",open:v,onClose:()=>C(!1),onOpen:()=>C(!0),PaperProps:{sx:{borderTopLeftRadius:16,borderTopRightRadius:16,p:2}},children:(0,a.jsxs)(o.A,{sx:{width:"auto",pb:2},children:[(0,a.jsx)(o.A,{sx:{width:40,height:4,bgcolor:"grey.300",borderRadius:2,mx:"auto",mb:2}}),(0,a.jsxs)(i.default,{variant:"h6",gutterBottom:!0,children:["Actions for ",x.leadName]}),(0,a.jsxs)(y.A,{spacing:1,mt:2,children:[(0,a.jsx)(f.default,{fullWidth:!0,variant:"outlined",color:"inherit",startIcon:(0,a.jsx)(c.W,{icon:"material-symbols:diamond"}),onClick:()=>A("Qualify"),disabled:"Qualify"===x.leadStatus,children:"Mark as Qualify"}),(0,a.jsx)(f.default,{fullWidth:!0,variant:"outlined",color:"warning",startIcon:(0,a.jsx)(c.W,{icon:"material-symbols:hourglass"}),onClick:()=>A("Stale"),disabled:"Stale"===x.leadStatus,children:"Mark as Stale"}),(0,a.jsx)(W.default,{sx:{my:1}}),(0,a.jsx)(f.default,{fullWidth:!0,variant:"outlined",color:"info",startIcon:(0,a.jsx)(c.W,{icon:"eva:eye-fill"}),onClick:()=>{C(!1),m(x)},children:"View Full Details"}),(0,a.jsx)(f.default,{fullWidth:!0,variant:"contained",color:"primary",startIcon:(0,a.jsx)(c.W,{icon:"material-symbols:add-task"}),onClick:()=>{C(!1),p(x)},children:"Create Follow-up"})]})]})})]})}),B=(0,n.memo)(function(e){let{leads:l,loading:t,onRefresh:n,onOpenFollowUp:r,onViewDetails:s}=e;return t?(0,a.jsxs)(o.A,{sx:{p:3,textAlign:"center"},children:[(0,a.jsx)(z.default,{}),(0,a.jsx)(i.default,{sx:{mt:2},color:"text.secondary",children:"Loading leads..."})]}):l&&0!==l.length?(0,a.jsx)(o.A,{sx:{p:{xs:1,sm:2}},children:l.map(e=>(0,a.jsx)(L,{lead:e,onRefresh:n,onOpenFollowUp:r,onViewDetails:s},e.id))}):(0,a.jsxs)(o.A,{sx:{p:4,textAlign:"center"},children:[(0,a.jsx)(c.W,{icon:"tabler:database-off",width:64,sx:{color:"text.disabled",mb:2}}),(0,a.jsx)(i.default,{variant:"h6",gutterBottom:!0,children:"No leads found"}),(0,a.jsx)(i.default,{variant:"body2",color:"text.secondary",children:"Try adjusting your filters or create a new lead"})]})});t(50827);let H=(0,n.memo)(function(e){var l,t;let{params:n,emptyValue:r="—"}=e;if((null==n||null==(l=n.rowNode)?void 0:l.type)==="group")return(0,a.jsx)(i.default,{variant:"subtitle2",sx:{fontWeight:600},children:n.value||r});let s=null==n||null==(t=n.row)?void 0:t.aiPriority;if(null==s)return(0,a.jsx)("span",{children:r});let d=s>=80?"#FF5630":s>=60?"#FF8B00":s>=40?"#FFA500":s>=20?"#2196F3":"#919EAB",u=s>=80?"Urgent":s>=60?"High":s>=40?"Medium":s>=20?"Low":"Very Low";return(0,a.jsxs)(o.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:.25},children:[(0,a.jsx)(i.default,{variant:"h6",sx:{fontWeight:700,color:d,fontSize:"1.1rem",fontVariantNumeric:"tabular-nums"},children:s}),(0,a.jsx)(i.default,{variant:"caption",sx:{color:d,fontSize:"0.65rem",fontWeight:500,letterSpacing:.5,textTransform:"uppercase"},children:u})]})});var R=t(82940),U=t.n(R),O=t(68074),P=t(15843),V=t(68086),q=t(15876),X=t(84762),Y=t(25949),G=t(72137),J=t(60032),_=t(72330),Z=t(57236),K=t(49742),Q=t(72635),$=t(56626);let ee=e=>e?U()(e).format("DD MMM YYYY"):"-";function el(e){let{visitByLeadData:l,visitByLeadLoading:t,leadId:s}=e,[u,c]=(0,n.useState)([]);(0,n.useEffect)(()=>{t||c(l.map(e=>({id:e.VisitId,type:e.VisitType,purpose:e.Purpose,visitStatus:e.VisitStatus,visitDate:ee(e.VisitDate),propertyType:e.PropertyType,buyingIntent:e.BuyingIntent,createdDate:ee(e.CreatedDate),updatedDate:ee(e.UpdatedDate),followUpDate:ee(e.FollowUpDate),followUpStatus:e.FollowUpStatus,floor:e.FloorPreference,sizeSqFt:e.SizeSqFt,viewType:e.ViewType,outlook:e.VisitOutlook,feedback:e.VisitorFeedback,notes:e.Notes})))},[l,t]);let[x,h]=(0,n.useState)(null);return(0,a.jsx)(a.Fragment,{children:t?(0,a.jsx)(V.A,{variant:"rectangular",width:"100%",height:180,sx:{borderRadius:3}}):(0,a.jsxs)(r.A,{children:[(0,a.jsxs)(o.A,{sx:{display:"grid",gridTemplateColumns:{xs:"repeat(2, 1fr)",md:"repeat(2, 1fr)"}},children:[(0,a.jsx)(o.A,{sx:{display:"flex",justifyContent:"flex-start",alignContent:"center"},children:(0,a.jsx)(i.default,{variant:"h6",sx:{ml:2.5,mr:2.5,mt:1,mb:1},children:"Visits Details"})}),(0,a.jsx)(o.A,{sx:{display:"flex",justifyContent:"flex-end",alignContent:"center"},children:(0,a.jsx)(d.default,{title:"Create New Visit",arrow:!0,children:(0,a.jsx)(O.default,{color:"inherit",variant:"contained",component:Q.W,href:"".concat(K.f.dashboard.visit.new,"?leadId=").concat(s),size:"small",startIcon:(0,a.jsx)(P.A,{}),sx:{ml:2.5,mr:1,mt:1,mb:1},children:"Visit"})})})]}),(0,a.jsx)(o.A,{sx:{position:"relative"},children:(0,a.jsx)($.Z,{children:(0,a.jsx)(q.A,{component:X.default,sx:{maxHeight:300},children:(0,a.jsxs)(Y.A,{size:"small",children:[(0,a.jsx)(G.A,{children:(0,a.jsx)(J.default,{children:["Visit Type","Visit Purpose","Visit Status","Visit Date","Property Type","Buying Intent","FollowUp Date","FollowUp Status","Floor","SizeSqFt","View Type","Outlook","Feedback","Notes"].map(e=>(0,a.jsx)(_.default,{style:{whiteSpace:"nowrap"},children:e},e))})}),(0,a.jsx)(Z.A,{children:t?(0,a.jsx)(J.default,{children:(0,a.jsx)(_.default,{colSpan:10,align:"center",children:(0,a.jsx)(z.default,{size:24})})}):x?(0,a.jsx)(J.default,{children:(0,a.jsx)(_.default,{colSpan:10,align:"center",children:x})}):u.length>0?u.map(e=>(0,a.jsxs)(J.default,{children:[(0,a.jsx)(_.default,{children:e.type||"-"}),(0,a.jsx)(_.default,{children:e.purpose||"-"}),(0,a.jsx)(_.default,{children:e.visitStatus||"-"}),(0,a.jsx)(_.default,{children:e.visitDate||"-"}),(0,a.jsx)(_.default,{children:e.propertyType||"-"}),(0,a.jsx)(_.default,{children:e.buyingIntent||"-"}),(0,a.jsx)(_.default,{children:e.followUpDate||"-"}),(0,a.jsx)(_.default,{children:e.followUpStatus||"-"}),(0,a.jsx)(_.default,{children:e.floor||"-"}),(0,a.jsx)(_.default,{children:e.sizeSqFt||"-"}),(0,a.jsx)(_.default,{children:e.viewType||"-"}),(0,a.jsx)(_.default,{children:e.outlook||"-"}),(0,a.jsx)(_.default,{children:e.feedback||"-"}),(0,a.jsx)(_.default,{children:e.notes||"-"})]},e.id)):(0,a.jsx)(J.default,{children:(0,a.jsx)(_.default,{colSpan:10,align:"center",children:"No data available"})})})]})})})})]})})}let et=(0,n.memo)(function(e){var l,t,n;let{params:r,emptyValue:s="—"}=e;if((null==r||null==(l=r.rowNode)?void 0:l.type)==="group")return(0,a.jsx)(i.default,{variant:"subtitle2",sx:{fontWeight:600},children:r.value||s});let d=null==r||null==(t=r.row)?void 0:t.healthScore,u=null==r||null==(n=r.row)?void 0:n.healthScoreLabel;if(null==d)return(0,a.jsx)("span",{children:s});let c=d<40?"#FF5630":d<70?"#FFA500":"#22C55E",x=d<40?"\uD83D\uDD34":d<70?"\uD83D\uDFE1":"\uD83D\uDFE2",h=u||(d<40?"Critical":d<70?"Attention":"Healthy");return(0,a.jsxs)(o.A,{sx:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",gap:.5},children:[(0,a.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",gap:.5},children:[(0,a.jsx)(i.default,{variant:"h6",sx:{fontWeight:600,color:c,fontSize:"1rem"},children:d}),(0,a.jsx)(i.default,{sx:{fontSize:"1rem",lineHeight:1},children:x})]}),(0,a.jsx)(o.A,{sx:{width:"80px"},children:(0,a.jsx)(T.A,{variant:"determinate",value:d,sx:{height:4,borderRadius:2,backgroundColor:"grey.300","& .MuiLinearProgress-bar":{backgroundColor:c,borderRadius:2}}})}),(0,a.jsx)(i.default,{variant:"caption",sx:{color:"text.secondary",fontSize:"0.7rem"},children:h})]})});var ea=t(45964),en=t.n(ea),er=t(62177),ei=t(92634),eo=t(95946),es=t(56117),ed=t(44353),eu=t(54961);let ec=n.memo(function(e){var l,t,s,d,u;let{siteId:c}=e,[x,h]=(0,n.useState)(null),[p,f]=(0,n.useState)(!1),{watch:m,setValue:g}=(0,er.xW)(),b=m(["floor","direction","unitType","view","locality","sizeSqFt","buyingIntent"]),j={floor:b[0],direction:b[1],unitType:b[2],view:b[3],locality:b[4],sizeSqFt:b[5],buyingIntent:b[6]},v=(0,n.useMemo)(()=>({floor:j.floor,direction:j.direction,unitType:j.unitType,view:j.view,siteId:c}),[j.floor,j.direction,j.unitType,j.view,c]),{infraUnitSearchData:y,infraUnitSearchLoading:S,refetchInfraUnit:C}=(0,es.AK)(null!=(l=v.siteId)?l:null,null!=(t=v.floor)?t:null,null!=(s=v.direction)?s:null,null!=(d=v.unitType)?d:null,null!=(u=v.view)?u:null),A=(0,n.useMemo)(()=>(null==y?void 0:y.length)?y.map(e=>{var l,t,a,n,r,i,o;return{id:e.InfraUnitId,floorNumber:null!=(l=e.FloorNumber)?l:"-",unitNumber:null!=(t=e.UnitNumber)?t:"-",unitSize:null!=(a=e.UnitSize)?a:"-",availabilityStatus:null!=(n=e.AvailabilityStatus)?n:"-",direction:null!=(r=e.Direction)?r:"-",unitType:null!=(i=e.UnitType)?i:"-",view:null!=(o=e.View)?o:"-"}}):[],[y]),w=(0,n.useMemo)(()=>{var e,l,t;return[{label:"Floor Preference",name:"floor",options:(null==(e=ed.NS[0])?void 0:e.classify)||[]},{label:"Direction Preference",name:"direction",options:(null==(l=ed.Ac[0])?void 0:l.classify)||[]},{label:"Unit Type",name:"unitType",options:ed.Tm.flatMap(e=>e.classify)||[]},{label:"View Preference",name:"view",options:(null==(t=ed.GZ[0])?void 0:t.classify)||[]},{label:"Size (in Square Feet)",name:"sizeSqFt",options:[]},{label:"Locality",name:"locality",options:[]},{label:"Buying Intent (in months)",name:"buyingIntent",options:[]}]},[]),k=(0,n.useRef)(C);(0,n.useEffect)(()=>{k.current=C},[C]);let D=(0,n.useCallback)(async()=>{f(!0),h(null);try{await k.current()}catch(a){var e,l;console.error("Error fetching infra units:",a),F.oR.dismiss();let t=(null==a||null==(l=a.response)||null==(e=l.data)?void 0:e.message)||(null==a?void 0:a.message)||"Failed to fetch unit suggestions";F.oR.error(t,{containerId:"error"}),h("Unable to load suggestions. Please try again.")}finally{f(!1)}},[]),I=(0,n.useMemo)(()=>en()(D,500),[D]);return(0,n.useEffect)(()=>()=>{I.cancel()},[I]),(0,n.useEffect)(()=>{v.siteId&&I()},[v,I]),(0,a.jsxs)(o.A,{sx:{columnGap:1,rowGap:1,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",md:"repeat(2, 1fr)"}},children:[(0,a.jsxs)(r.A,{children:[(0,a.jsx)(i.default,{variant:"h6",sx:{pl:2.5,pr:2.5,pt:1,pb:1},children:"Requirement"}),(0,a.jsx)(W.default,{}),(0,a.jsx)(o.A,{sx:{p:1.5,columnGap:1,rowGap:1,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",md:"repeat(2, 1fr)"}},children:w.map(e=>{let{label:l,name:t,options:n}=e;return"locality"===t?(0,a.jsx)(eu.D0.Text2,{name:"locality",label:"Locality"},"locality"):"buyingIntent"===t?(0,a.jsx)(eu.D0.Text2,{name:"buyingIntent",label:"Buying Intent (in months)"},"buyingIntent"):"sizeSqFt"===t?(0,a.jsx)(eu.D0.Text2,{name:"sizeSqFt",label:"Size (in Square Feet)"},"sizeSqFt"):(0,a.jsx)(ei.default,{value:j[t]||null,options:n,autoHighlight:!0,disabled:p,renderInput:e=>(0,a.jsx)(eo.default,{...e,label:l}),onChange:(e,l)=>g(t,l)},t)})})]}),(0,a.jsxs)(r.A,{children:[(0,a.jsx)(i.default,{variant:"h6",sx:{pl:2.5,pr:2.5,pt:1,pb:1},children:"Options & Suggestions"}),(0,a.jsx)(o.A,{sx:{position:"relative"},children:(0,a.jsx)($.Z,{children:(0,a.jsx)(q.A,{component:X.default,sx:{maxHeight:250},children:(0,a.jsxs)(Y.A,{size:"small",children:[(0,a.jsx)(G.A,{children:(0,a.jsx)(J.default,{children:["Floor No.","Unit No.","Unit Size","Availability","Direction","Unit Type","View"].map(e=>(0,a.jsx)(_.default,{style:{whiteSpace:"nowrap"},children:e},e))})}),(0,a.jsx)(Z.A,{children:p?(0,a.jsx)(J.default,{children:(0,a.jsx)(_.default,{colSpan:7,align:"center",children:(0,a.jsx)(z.default,{size:50})})}):x?(0,a.jsx)(J.default,{children:(0,a.jsx)(_.default,{colSpan:7,align:"center",children:x})}):A.length>0?A.map(e=>{let{id:l,floorNumber:t,unitNumber:n,unitSize:r,availabilityStatus:i,direction:o,unitType:s,view:d}=e;return(0,a.jsxs)(J.default,{children:[(0,a.jsx)(_.default,{style:{whiteSpace:"nowrap"},children:t}),(0,a.jsx)(_.default,{style:{whiteSpace:"nowrap"},children:n}),(0,a.jsx)(_.default,{style:{whiteSpace:"nowrap"},children:r}),(0,a.jsx)(_.default,{style:{whiteSpace:"nowrap"},children:i}),(0,a.jsx)(_.default,{style:{whiteSpace:"nowrap"},children:o}),(0,a.jsx)(_.default,{style:{whiteSpace:"nowrap"},children:s}),(0,a.jsx)(_.default,{style:{whiteSpace:"nowrap"},children:d})]},l)}):(0,a.jsx)(J.default,{children:(0,a.jsx)(_.default,{colSpan:7,align:"center",children:"No options available"})})})]})})})})]})]})});var ex=t(36339),eh=t(25114),ep=t(28292);let ef=[{label:"Search by name or number",value:"search",disabled:!0},{label:"Add New Broker",value:"add",disabled:!1}];function em(e){var l;let{brokerId:t}=e,[s,d]=(0,n.useState)(!1),[u,c]=(0,n.useState)(ef),x=(0,ex.Cg)(),h=(0,n.useRef)(null),{watch:p,setValue:f,getValues:m}=(0,er.xW)(),g=p("leadStatus"),b=p("leadSource"),j=p("brokerId"),v=(0,n.useMemo)(()=>j&&u.find(e=>e.value===j)||null,[j,u]),y=(0,n.useCallback)(e=>e&&Array.isArray(e)&&0!==e.length?[...ef,...e.map(e=>({label:"".concat(e.data.ContactFName," ").concat(e.data.ContactLName," (").concat(e.data.ContactNo,")"),value:e.data.ContactId}))]:[{label:"Data Not Found",value:"nan",disabled:!0},{label:"Add New Broker",value:"add",disabled:!1}],[]);(0,n.useEffect)(()=>(h.current=en()(async e=>{if(!e.trim())return void c(ef);d(!0);try{let l=await (0,eh.P8)(e,"Broker"),t=y(l);c(t)}catch(e){F.oR.error("Something Went Wrong!",{containerId:"error"}),c([{label:"Error In Searching, Try again!",value:"error",disabled:!0},{label:"Add New Broker",value:"add",disabled:!1}])}finally{d(!1)}},500),()=>{h.current&&h.current.cancel()}),[y]);let C=(0,n.useCallback)(()=>{v||c(ef)},[v]),A=(0,n.useCallback)(e=>{let l={value:e.ContactId,label:"".concat(e.ContactFName," ").concat(e.ContactLName," (").concat(e.ContactNo,")")};f("brokerId",l.value),c(e=>[...e,l])},[f]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(r.A,{children:[(0,a.jsx)(i.default,{variant:"h6",sx:{px:2.5,py:1},children:"Other Details"}),(0,a.jsx)(W.default,{}),(0,a.jsxs)(o.A,{sx:{p:2,gap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",md:"repeat(2, 1fr)"}},children:[(0,a.jsxs)(o.A,{sx:{gap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",md:"repeat(2, 1fr)"}},children:[(0,a.jsx)(ei.default,{options:S.z4.flatMap(e=>e.classify.map(e=>e)),value:g||null,onChange:(e,l)=>f("leadStatus",l||""),renderInput:e=>(0,a.jsx)(eo.default,{...e,label:"Lead Status",required:!0,error:!g,helperText:g?"":"Lead Status is required"}),autoHighlight:!0}),(0,a.jsx)(ei.default,{options:S.Oe.flatMap(e=>e.classify.map(l=>({label:l,value:l,group:e.group}))),groupBy:e=>e.group,value:b?{label:b,value:b,group:null==(l=S.Oe.find(e=>e.classify.includes(b)))?void 0:l.group}:null,onChange:(e,l)=>f("leadSource",(null==l?void 0:l.value)||""),renderInput:e=>(0,a.jsx)(eo.default,{...e,label:"Lead Source"}),getOptionLabel:e=>(null==e?void 0:e.label)||e||"",isOptionEqualToValue:(e,l)=>e.value===(null==l?void 0:l.value)||e===l,autoHighlight:!0})]}),(0,a.jsx)(ei.default,{options:u,value:v||null,getOptionLabel:e=>(null==e?void 0:e.label)||"-",autoHighlight:!0,loading:s,isOptionEqualToValue:(e,l)=>e.value===(null==l?void 0:l.value),filterOptions:(e,l)=>e,onInputChange:(e,l,t)=>{"input"===t&&h.current&&h.current(l)},onChange:(e,l)=>{if((null==l?void 0:l.value)==="add")return void x.onTrue();f("brokerId",(null==l?void 0:l.value)||null)},onBlur:C,getOptionDisabled:e=>e.disabled||!1,renderOption:(e,l)=>{let{key:t,...n}=e;return(0,a.jsx)("li",{...n,children:"add"===l.value?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(P.A,{sx:{mr:1}}),l.label]}):l.label},t)},renderInput:e=>(0,a.jsx)(eo.default,{...e,label:"Broker Name",placeholder:"Search by name or contact number.",InputProps:{...e.InputProps,endAdornment:(0,a.jsxs)(a.Fragment,{children:[s?(0,a.jsx)(z.default,{color:"inherit",size:20}):null,e.InputProps.endAdornment]})}})})]})]}),(0,a.jsx)(ep.Zn,{title:"Create Broker",type:"Broker",open:x.value,onClose:x.onFalse,onCreate:A})]})}let eg=(0,n.memo)(function(e){var l,t;let{params:n,emptyValue:r="—"}=e;if((null==n||null==(l=n.rowNode)?void 0:l.type)==="group")return(0,a.jsx)(i.default,{variant:"subtitle2",sx:{fontWeight:600},children:n.value||r});let s=null==n||null==(t=n.row)?void 0:t.buyingIntent;if(null==s)return(0,a.jsx)(i.default,{variant:"caption",sx:{color:"text.secondary"},children:r});let d=s>=8?{label:"Hot",icon:"\uD83D\uDD25",bgColor:"#FFE7E7",textColor:"#FF5630",barColor:"#FF5630"}:s>=5?{label:"Warm",icon:"\uD83D\uDD36",bgColor:"#FFF5E6",textColor:"#FF8C00",barColor:"#FF8C00"}:{label:"Cold",icon:"\uD83E\uDDCA",bgColor:"#E6F4FF",textColor:"#0288D1",barColor:"#0288D1"};return(0,a.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",gap:1,width:"100%",px:1},children:[(0,a.jsx)(w.default,{label:"".concat(d.icon," ").concat(s,"/10"),size:"small",sx:{backgroundColor:d.bgColor,color:d.textColor,fontWeight:600,fontSize:"0.75rem",height:24,minWidth:70,"& .MuiChip-label":{px:1}}}),(0,a.jsx)(i.default,{variant:"caption",sx:{color:d.textColor,fontWeight:600,fontSize:"0.7rem"},children:d.label})]})});var eb=t(42861);let ej=(0,n.memo)(function(){return(0,a.jsx)(r.A,{sx:{p:2,mb:2},children:(0,a.jsxs)(y.A,{spacing:2,children:[(0,a.jsxs)(o.A,{sx:{display:"flex",justifyContent:"space-between"},children:[(0,a.jsxs)(o.A,{sx:{flex:1},children:[(0,a.jsx)(V.A,{variant:"text",width:"60%",height:28}),(0,a.jsx)(V.A,{variant:"text",width:"40%",height:20})]}),(0,a.jsx)(V.A,{variant:"rounded",width:80,height:24})]}),(0,a.jsxs)(y.A,{spacing:.5,children:[(0,a.jsx)(V.A,{variant:"text",width:"50%",height:20}),(0,a.jsx)(V.A,{variant:"text",width:"40%",height:20})]}),(0,a.jsxs)(o.A,{sx:{display:"flex",gap:2},children:[(0,a.jsxs)(o.A,{sx:{flex:1},children:[(0,a.jsx)(V.A,{variant:"text",width:"30%",height:16}),(0,a.jsx)(V.A,{variant:"rectangular",height:4,sx:{borderRadius:2}})]}),(0,a.jsx)(V.A,{variant:"circular",width:40,height:40})]}),(0,a.jsxs)(o.A,{sx:{display:"flex",gap:1},children:[(0,a.jsx)(V.A,{variant:"rounded",width:80,height:32}),(0,a.jsx)(V.A,{variant:"rounded",width:80,height:32}),(0,a.jsx)(V.A,{variant:"rounded",width:100,height:32})]})]})})}),ev=(0,n.memo)(function(e){let{columns:l=8}=e;return(0,a.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",p:2,borderBottom:"1px solid",borderColor:"divider"},children:[(0,a.jsx)(V.A,{variant:"rectangular",width:20,height:20,sx:{mr:2}}),Array.from({length:l}).map((e,l)=>(0,a.jsx)(o.A,{sx:{flex:1,px:1},children:(0,a.jsx)(V.A,{variant:"text",width:"".concat(40*Math.random()+60,"%"),height:20})},l))]})}),ey=(0,n.memo)(function(e){let{viewMode:l="table"}=e,t=(0,N.default)(),n=(0,eb.A)(t.breakpoints.down("md")),r=n?5:10,i=n?4:8;return"card"===l?(0,a.jsx)(o.A,{sx:{p:{xs:1,sm:2}},children:Array.from({length:r}).map((e,l)=>(0,a.jsx)(ej,{},l))}):(0,a.jsxs)(o.A,{children:[(0,a.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",p:2,bgcolor:"background.neutral",borderBottom:"2px solid",borderColor:"divider"},children:[(0,a.jsx)(V.A,{variant:"rectangular",width:20,height:20,sx:{mr:2}}),Array.from({length:i}).map((e,l)=>(0,a.jsx)(o.A,{sx:{flex:1,px:1},children:(0,a.jsx)(V.A,{variant:"text",width:"80%",height:20})},l))]}),Array.from({length:r}).map((e,l)=>(0,a.jsx)(ev,{columns:i},l))]})}),eS=(0,n.memo)(function(){let e=(0,N.default)(),l=(0,eb.A)(e.breakpoints.down("sm"));return(0,a.jsx)(r.A,{sx:{p:{xs:1.5,sm:2},mb:{xs:1,sm:2},background:l?e.palette.primary.main:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:(0,a.jsxs)(y.A,{spacing:l?1:2,children:[(0,a.jsx)(o.A,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:(0,a.jsx)(V.A,{variant:"text",width:150,height:30,sx:{bgcolor:"rgba(255, 255, 255, 0.2)"}})}),(0,a.jsx)(y.A,{direction:l?"column":"row",spacing:l?.5:1.5,flexWrap:!l&&"wrap",useFlexGap:!l,children:Array.from({length:4}).map((e,t)=>(0,a.jsx)(V.A,{variant:"rounded",width:l?"100%":140,height:l?32:36,sx:{bgcolor:"rgba(255, 255, 255, 0.2)"}},t))})]})})}),eC=(0,n.memo)(function(){let e=(0,N.default)();return(0,eb.A)(e.breakpoints.down("md"))?(0,a.jsxs)(o.A,{sx:{p:2,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,a.jsx)(V.A,{variant:"rounded",width:100,height:36}),(0,a.jsxs)(o.A,{sx:{display:"flex",gap:1},children:[(0,a.jsx)(V.A,{variant:"rounded",width:80,height:32}),(0,a.jsx)(V.A,{variant:"rounded",width:80,height:32})]})]}):(0,a.jsx)(o.A,{sx:{p:2},children:(0,a.jsx)(o.A,{sx:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:1},children:Array.from({length:8}).map((e,l)=>(0,a.jsx)(V.A,{variant:"rounded",height:40},l))})})});var eA=t(6270),ew=t(57033),ek=t(56156),eD=t(73816),eI=t(78129);let eF=e=>{if(!e)return"";let l=e.toLowerCase();return"customer"===l?"Customer":"broker"===l?"Broker":e};function eN(e){let{selectedCustomer:l,selectedBroker:t,onCustomerChange:r,onBrokerChange:i,sx:s={}}=e,[d,u]=(0,n.useState)(""),x=(0,ex.d7)(d,500),h=x&&x.trim().length>=3?x.trim():null,{searchResults:p,searchLoading:f}=(0,eI.ig)(h,null),m=(0,n.useMemo)(()=>p.map(e=>({label:"".concat(e.data.ContactFName," ").concat(e.data.ContactLName," (").concat(e.data.ContactNo,")"),value:e.data.ContactId,ContactNo:e.data.ContactNo,ContactFName:e.data.ContactFName,ContactLName:e.data.ContactLName,ContactType:e.data.ContactType})),[p]),g=(0,n.useCallback)((e,l)=>{if(l){let e=eF(l.ContactType);"Customer"===e?r(l):"Broker"===e&&i(l),u("")}},[r,i]),b=(0,n.useCallback)((e,l,t)=>{"input"===t&&u(l)},[]),j=e=>{let l=eF(e);return"Customer"===l?"eva:person-fill":"Broker"===l?"eva:briefcase-fill":"eva:question-mark-circle-fill"},v=e=>{let l=eF(e);return"Customer"===l?"info":"Broker"===l?"warning":"default"};return(0,a.jsx)(ei.default,{size:"small",sx:{width:"100%","& .MuiTextField-root":{width:"100% !important"},"& .MuiInputBase-root":{width:"100% !important"},...s},value:null,onChange:g,inputValue:d,onInputChange:b,options:m,loading:f,isOptionEqualToValue:(e,l)=>e.value===(null==l?void 0:l.value),getOptionLabel:e=>e.label||"",noOptionsText:d.trim().length>0&&d.trim().length<3?"Type at least 3 characters to search...":d.trim().length>=3?"No contacts found":"Start typing to search...",renderInput:e=>(0,a.jsx)(eo.default,{...e,label:"Search customer or broker",placeholder:"Type name or number...",InputProps:{...e.InputProps,startAdornment:(0,a.jsx)(eD.A,{position:"start",children:(0,a.jsx)(c.W,{icon:"eva:search-fill",sx:{color:"text.disabled"}})}),endAdornment:(0,a.jsxs)(a.Fragment,{children:[f?(0,a.jsx)(z.default,{color:"inherit",size:20}):null,e.InputProps.endAdornment]})},"aria-label":"Search customers or brokers","aria-autocomplete":"list"}),renderOption:(e,l)=>{let{key:t,...n}=e,r=j(l.ContactType),i=v(l.ContactType);return(0,a.jsxs)(o.A,{component:"li",...n,sx:{display:"flex",alignItems:"center",gap:1},children:[(0,a.jsx)(c.W,{icon:r,sx:{color:"info"===i?"info.main":"warning.main",fontSize:20,flexShrink:0}}),(0,a.jsx)(o.A,{sx:{flexGrow:1},children:l.label}),(0,a.jsx)(w.default,{label:l.ContactType,size:"small",color:i,sx:{height:20,fontSize:"0.7rem",fontWeight:600}})]},t)}})}function ez(e){let{filters:l,onCustomerChange:t,onBrokerChange:n}=e;return(0,a.jsxs)(eA.b,{sx:e=>({p:2,display:"grid",gap:2,gridTemplateColumns:"1fr 1fr",gridTemplateAreas:'\n          "search search"\n          "columns export"\n        ',[e.breakpoints.up("md")]:{gridTemplateColumns:"minmax(0, 1fr) auto",gridTemplateAreas:'"search buttons"'}}),children:[(0,a.jsx)(o.A,{sx:{gridArea:"search"},children:(0,a.jsx)(eN,{selectedCustomer:l.customer,selectedBroker:l.broker,onCustomerChange:t,onBrokerChange:n})}),(0,a.jsx)(o.A,{sx:{gridArea:"columns",display:{xs:"block",md:"none"}},children:(0,a.jsx)(ew.j,{sx:{width:"100%"}})}),(0,a.jsx)(o.A,{sx:{gridArea:"export",display:{xs:"block",md:"none"}},children:(0,a.jsx)(ek.qn,{sx:{width:"100%"}})}),(0,a.jsxs)(o.A,{sx:{gridArea:"buttons",display:{xs:"none",md:"flex"},gap:1,alignItems:"center"},children:[(0,a.jsx)(ew.j,{}),(0,a.jsx)(ek.qn,{})]})]})}var eT=t(78894),eM=t(3951);let eW=(0,n.memo)(function(e){let{aggregates:l,onBadgeClick:t,activeBadge:s,loading:d=!1,error:u=null,onRetry:x=null,sx:h={}}=e,p=(0,N.default)(),m=(0,eb.A)(p.breakpoints.down("sm")),g=(0,eb.A)(p.breakpoints.between("sm","md")),b=(0,eb.A)(p.breakpoints.between("md","lg"));(0,eb.A)(p.breakpoints.up("lg"));let j=(0,n.useMemo)(()=>m?"xs":g?"sm":b?"md":"lg",[m,g,b]),v=(0,n.useMemo)(()=>({xs:{columns:2,spacing:1,padding:1,titleSize:"0.875rem",badgeHeight:36,showFullText:!0,cardPadding:1.5},sm:{columns:2,spacing:1.5,padding:1.5,titleSize:"1rem",badgeHeight:38,showFullText:!0,cardPadding:1.75},md:{columns:4,spacing:2,padding:2,titleSize:"1.125rem",badgeHeight:40,showFullText:!0,cardPadding:2},lg:{columns:4,spacing:2,padding:2,titleSize:"1.25rem",badgeHeight:42,showFullText:!0,cardPadding:2}}),[])[j],y=(0,n.useMemo)(()=>[{id:"urgent",icon:"\uD83D\uDEA8",label:"URGENT",compactLabel:"URG",count:(null==l?void 0:l.urgentCount)||0,color:"#d32f2f",activeBackgroundColor:(0,eT.X4)("#d32f2f",.1),bgColor:(0,eT.X4)("#d32f2f",.08),hoverColor:(0,eT.X4)("#d32f2f",.12),description:"Critical health leads (Health < 40 & Overdue > 3 days)"},{id:"due_today",icon:"\uD83D\uDCC5",label:"DUE TODAY",compactLabel:"TODAY",count:(null==l?void 0:l.dueTodayCount)||0,color:"#f57c00",activeBackgroundColor:(0,eT.X4)("#f57c00",.1),bgColor:(0,eT.X4)("#f57c00",.08),hoverColor:(0,eT.X4)("#f57c00",.12),description:"Follow-ups scheduled for today"},{id:"high_intent",icon:"\uD83D\uDD25",label:"HIGH INTENT",compactLabel:"HOT",count:(null==l?void 0:l.highIntentCount)||0,color:"#7b1fa2",activeBackgroundColor:(0,eT.X4)("#7b1fa2",.1),bgColor:(0,eT.X4)("#7b1fa2",.08),hoverColor:(0,eT.X4)("#7b1fa2",.12),description:"Hot leads with buying intent ≥ 8"},{id:"overdue",icon:"⏰",label:"OVERDUE",compactLabel:"LATE",count:(null==l?void 0:l.overdueCount)||0,color:"#d84315",activeBackgroundColor:(0,eT.X4)("#d84315",.1),bgColor:(0,eT.X4)("#d84315",.08),hoverColor:(0,eT.X4)("#d84315",.12),description:"Overdue follow-ups requiring attention"}],[l]),S=(0,n.useCallback)(e=>{t&&t(e)},[t]);if(u)return(0,a.jsx)(r.A,{elevation:0,sx:{p:2,mb:{xs:1.5,sm:2},bgcolor:(0,eT.X4)(p.palette.error.main,.08),border:"1px solid ".concat((0,eT.X4)(p.palette.error.main,.2)),borderRadius:2,...h},children:(0,a.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[(0,a.jsx)(c.W,{icon:"eva:alert-circle-fill",sx:{color:"error.main",width:24,height:24,flexShrink:0}}),(0,a.jsxs)(o.A,{sx:{flex:1},children:[(0,a.jsx)(i.default,{variant:"subtitle2",color:"error.main",sx:{fontWeight:600,mb:.5},children:"Failed to load priority alerts"}),(0,a.jsx)(i.default,{variant:"caption",color:"text.secondary",children:"Unable to fetch aggregate counts. Please try refreshing."})]}),x&&(0,a.jsx)(f.default,{size:"small",variant:"outlined",color:"error",onClick:x,sx:{flexShrink:0},children:"Retry"})]})});if(d&&!l)return(0,a.jsx)(r.A,{elevation:0,sx:{p:2,mb:{xs:1.5,sm:2},bgcolor:(0,eT.X4)(p.palette.primary.main,.04),borderRadius:2,display:"flex",alignItems:"center",justifyContent:"center",minHeight:100,...h},children:(0,a.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[(0,a.jsx)(z.default,{size:24}),(0,a.jsx)(i.default,{variant:"body2",color:"text.secondary",children:"Loading priority alerts..."})]})});if(!l)return null;let C=y.reduce((e,l)=>e+l.count,0),A=C>0;return(0,a.jsxs)(r.A,{elevation:0,sx:{p:v.cardPadding,mb:{xs:1.5,sm:2},background:"xs"===j?"linear-gradient(135deg, ".concat(p.palette.primary.main,", ").concat(p.palette.primary.dark,")"):"linear-gradient(135deg, ".concat((0,eT.X4)(p.palette.primary.main,.9),", ").concat((0,eT.X4)(p.palette.primary.dark,.95),")"),borderRadius:2,position:"relative",overflow:"hidden",...h},children:[(0,a.jsx)(o.A,{sx:{position:"absolute",top:0,right:0,width:"40%",height:"100%",opacity:.05,background:"radial-gradient(circle, white 20%, transparent 20%)",backgroundSize:"20px 20px",pointerEvents:"none"}}),(0,a.jsxs)(o.A,{sx:{position:"relative",zIndex:1},children:[(0,a.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:A?1.5:.5},children:[(0,a.jsxs)(i.default,{variant:"h6",sx:{color:"white",fontWeight:600,fontSize:v.titleSize,display:"flex",alignItems:"center",gap:.75},children:[(0,a.jsx)("span",{style:{fontSize:"1.1em"},children:"\uD83C\uDFAF"}),(0,a.jsx)("span",{children:"xs"===j?"Alerts":"Priority Alerts"}),A&&"xs"===j&&(0,a.jsx)(o.A,{component:"span",sx:{backgroundColor:"rgba(255, 255, 255, 0.2)",borderRadius:"10px",px:.75,py:.25,fontSize:"0.75rem",fontWeight:500},children:C})]}),A&&"xs"!==j&&(0,a.jsxs)(i.default,{variant:"body2",sx:{color:"rgba(255, 255, 255, 0.9)",fontWeight:500,fontSize:{sm:"0.875rem",md:"0.9rem"}},children:[C," alert",1!==C?"s":""," need attention"]})]}),A?(0,a.jsx)(eM.Ay,{container:!0,spacing:v.spacing/2,children:y.map(e=>(0,a.jsx)(eM.Ay,{item:!0,xs:6,sm:6,md:3,children:(0,a.jsx)(w.default,{label:(0,a.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",gap:.5,width:"100%",justifyContent:"space-between"},children:[(0,a.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",gap:.5},children:[(0,a.jsx)("span",{style:{fontSize:"xs"===j?"0.9rem":"1rem"},children:e.icon}),(0,a.jsx)("span",{style:{fontSize:{xs:"0.7rem",sm:"0.75rem",md:"0.8rem"},fontWeight:600},children:v.showFullText?e.label:e.compactLabel})]}),(0,a.jsx)(o.A,{component:"span",sx:{backgroundColor:s===e.id?p.palette.grey[700]:e.color,borderRadius:"10px",px:.6,py:.1,fontSize:{xs:"0.7rem",sm:"0.75rem",md:"0.8rem"},fontWeight:700,minWidth:"24px",textAlign:"center",color:"white",transition:"all 0.2s"},children:e.count})]}),onClick:()=>S(e.id),sx:{width:"100%",height:v.badgeHeight,backgroundColor:s===e.id?(0,eT.X4)(p.palette.grey[200],.9):"white",color:s===e.id?p.palette.grey[800]:e.color,fontWeight:600,cursor:t?"pointer":"default",transition:"all 0.2s",border:s===e.id?"2px solid ".concat(p.palette.grey[700]):"none",boxShadow:s===e.id?"0 3px 10px ".concat((0,eT.X4)(p.palette.grey[500],.25)):"0 1px 3px ".concat((0,eT.X4)(p.palette.grey[300],.2)),"&:hover":t?{backgroundColor:s===e.id?(0,eT.X4)(p.palette.grey[300],.8):(0,eT.X4)(p.palette.grey[100],.8),transform:"scale(1.02)",boxShadow:"0 4px 12px ".concat((0,eT.X4)(e.color,.15))}:{},"& .MuiChip-label":{px:1.5,py:0,width:"100%"}},title:e.description})},e.id))}):(0,a.jsx)(o.A,{sx:{textAlign:"center",py:2},children:(0,a.jsx)(i.default,{variant:"body2",sx:{color:"rgba(255, 255, 255, 0.8)",fontStyle:"italic"},children:"No priority alerts at this time"})})]})]})});var eE=t(32987),eL=t(5551),eB=t(15930),eH=t(77498),eR=t(78880),eU=t(26403),eO=t(58417),eP=t(83919);function eV(e){let{open:l,onClose:t,filters:r,options:d,onResetPage:u}=e,{state:x,setState:h}=r,[p,m]=(0,n.useState)(x.leadStatus||[]),[b,v]=(0,n.useState)(x.leadSource||[]),[C,A]=(0,n.useState)(x.site||[]),[k,D]=(0,n.useState)(x.prospect||[]),[I,F]=(0,n.useState)(x.startDate),[N,z]=(0,n.useState)(x.endDate),[T,M]=(0,n.useState)(x.broker),[E,L]=(0,n.useState)(x.customer),[B,H]=(0,n.useState)(x.healthScoreRange||""),[R,U]=(0,n.useState)(x.buyingIntent||""),[O,P]=(0,n.useState)(x.followUpStatus||""),V=[(null==p?void 0:p.length)>0,(null==b?void 0:b.length)>0,(null==C?void 0:C.length)>0,(null==k?void 0:k.length)>0,!!I,!!N,!!(null==T?void 0:T.value),!!(null==E?void 0:E.value),!!B,!!R,!!O].filter(Boolean).length;(0,n.useEffect)(()=>{m((x.leadStatus||[]).map(e=>{var l;return null==(l=d.leadStatus)?void 0:l.find(l=>l.value===e)}).filter(Boolean)),v((x.leadSource||[]).map(e=>{var l;return null==(l=d.leadSource)?void 0:l.find(l=>l.value===e)}).filter(Boolean)),A((x.site||[]).map(e=>{var l;return null==(l=d.site)?void 0:l.find(l=>l.value===e)}).filter(Boolean)),D((x.prospect||[]).map(e=>{var l;return null==(l=d.prospect)?void 0:l.find(l=>l.value===e)}).filter(Boolean)),F(x.startDate),z(x.endDate),M(x.broker),L(x.customer),H(x.healthScoreRange||""),U(x.buyingIntent||""),P(x.followUpStatus||"")},[x,d.leadStatus,d.leadSource,d.site,d.prospect]);let q=(0,n.useCallback)(()=>{u();let e={leadStatus:p.map(e=>e.value),leadSource:b.map(e=>e.value),site:C.map(e=>e.value),prospect:k.map(e=>e.value),startDate:I,endDate:N,broker:T,customer:E,healthScoreRange:B,buyingIntent:R,followUpStatus:O};switch(B){case"25":e.healthScoreMax=39,e.healthScoreMin=null;break;case"50":e.healthScoreMin=40,e.healthScoreMax=69;break;case"75":e.healthScoreMin=70,e.healthScoreMax=null;break;default:e.healthScoreMin=null,e.healthScoreMax=null}switch(R){case"9":e.buyingIntentMin=8,e.buyingIntentMax=null;break;case"6":e.buyingIntentMin=5,e.buyingIntentMax=7;break;case"3":e.buyingIntentMin=null,e.buyingIntentMax=4;break;default:e.buyingIntentMin=null,e.buyingIntentMax=null}h(e),t()},[p,b,C,k,I,N,T,E,B,R,O,u,h,t]),X=(0,n.useCallback)(()=>{m([]),v([]),A([]),D([]),F(null),z(null),M(null),L(null),H(""),U(""),P(""),u(),h({leadStatus:[],leadSource:[],site:[],prospect:[],startDate:null,endDate:null,broker:null,customer:null,healthScoreRange:"",healthScoreMin:null,healthScoreMax:null,buyingIntent:"",buyingIntentMin:null,buyingIntentMax:null,overdueDaysMin:null,overdueDaysMax:null,followUpStatus:""})},[u,h]);return(0,a.jsxs)(eL.Ay,{anchor:"right",open:l,onClose:t,hideBackdrop:!0,disableScrollLock:!0,elevation:16,PaperProps:{sx:{width:{xs:"100%",sm:420,md:450},p:0,boxShadow:24}},children:[(0,a.jsxs)(o.A,{sx:{p:2,display:"flex",alignItems:"center",justifyContent:"space-between",borderBottom:"1px solid",borderColor:"divider",bgcolor:"background.neutral"},children:[(0,a.jsxs)(y.A,{direction:"row",spacing:1,alignItems:"center",children:[(0,a.jsx)(i.default,{variant:"h6",children:"Filters"}),V>0&&(0,a.jsx)(eB.default,{badgeContent:V,color:"primary"})]}),(0,a.jsx)(s.default,{onClick:t,size:"small",children:(0,a.jsx)(c.W,{icon:"eva:close-fill"})})]}),(0,a.jsx)(o.A,{sx:{p:2,overflowY:"auto",flex:1},children:(0,a.jsxs)(y.A,{spacing:3,children:[(0,a.jsxs)(o.A,{children:[(0,a.jsx)(i.default,{variant:"subtitle2",sx:{mb:2,fontWeight:600},children:"Contacts"}),(0,a.jsxs)(y.A,{spacing:2,children:[(0,a.jsx)(eP.u,{handleFilterContact:e=>L(e),contactType:"Customer",defaultValue:E}),(0,a.jsx)(eP.u,{handleFilterContact:e=>M(e),contactType:"Broker",defaultValue:T})]})]}),(0,a.jsx)(W.default,{}),(0,a.jsxs)(o.A,{children:[(0,a.jsx)(i.default,{variant:"subtitle2",sx:{mb:2,fontWeight:600},children:"Date Range"}),(0,a.jsxs)(y.A,{spacing:2,children:[(0,a.jsx)(eO.$J,{children:(0,a.jsx)(eE.l,{label:"Lead Created From",value:I?j()(I):null,onChange:e=>{F(e?e.format("YYYY-MM-DD"):null)},format:"DD-MM-YYYY",maxDate:N?j()(N):void 0,slotProps:{textField:{size:"small",fullWidth:!0}}})}),(0,a.jsx)(eO.$J,{children:(0,a.jsx)(eE.l,{label:"Lead Created To",value:N?j()(N):null,onChange:e=>{z(e?e.format("YYYY-MM-DD"):null)},format:"DD-MM-YYYY",minDate:I?j()(I):void 0,slotProps:{textField:{size:"small",fullWidth:!0}}})})]})]}),(0,a.jsx)(W.default,{}),(0,a.jsxs)(o.A,{children:[(0,a.jsx)(i.default,{variant:"subtitle2",sx:{mb:2,fontWeight:600},children:"Lead Information"}),(0,a.jsxs)(y.A,{spacing:2,children:[(0,a.jsx)(ei.default,{multiple:!0,size:"small",value:p,options:d.leadStatus||[],onChange:(e,l)=>{m(l)},getOptionLabel:e=>e.label,isOptionEqualToValue:(e,l)=>e.value===l.value,renderInput:e=>(0,a.jsx)(eo.default,{...e,label:"Lead Status",placeholder:"Select statuses..."}),renderTags:(e,l)=>e.map((e,t)=>{let{key:n,...r}=l({index:t});return(0,a.jsx)(w.default,{size:"small",label:e.label,...r},n)})}),(0,a.jsx)(ei.default,{multiple:!0,size:"small",value:b,options:d.leadSource||[],onChange:(e,l)=>{v(l)},getOptionLabel:e=>e.label,isOptionEqualToValue:(e,l)=>e.value===l.value,renderInput:e=>(0,a.jsx)(eo.default,{...e,label:"Lead Source",placeholder:"Select sources..."}),renderTags:(e,l)=>e.map((e,t)=>{let{key:n,...r}=l({index:t});return(0,a.jsx)(w.default,{size:"small",label:e.label,...r},n)})}),(0,a.jsx)(ei.default,{multiple:!0,size:"small",value:k,options:d.prospect||[],onChange:(e,l)=>{D(l)},getOptionLabel:e=>e.label,isOptionEqualToValue:(e,l)=>e.value===l.value,renderInput:e=>(0,a.jsx)(eo.default,{...e,label:"Buyer Type",placeholder:"Select types..."}),renderTags:(e,l)=>e.map((e,t)=>{let{key:n,...r}=l({index:t});return(0,a.jsx)(w.default,{size:"small",label:e.label,...r},n)})}),(0,a.jsx)(ei.default,{multiple:!0,size:"small",value:C,options:d.site||[],onChange:(e,l)=>{A(l)},getOptionLabel:e=>e.label,isOptionEqualToValue:(e,l)=>e.value===l.value,renderInput:e=>(0,a.jsx)(eo.default,{...e,label:"Sites",placeholder:"Select sites..."}),renderTags:(e,l)=>e.map((e,t)=>{let{key:n,...r}=l({index:t});return(0,a.jsx)(w.default,{size:"small",label:e.label,...r},n)})})]})]}),(0,a.jsx)(W.default,{}),(0,a.jsxs)(o.A,{children:[(0,a.jsx)(i.default,{variant:"subtitle2",sx:{mb:2,fontWeight:600},children:"Lead Scoring"}),(0,a.jsxs)(y.A,{spacing:2,children:[(0,a.jsxs)(eH.A,{fullWidth:!0,size:"small",children:[(0,a.jsx)(eR.default,{children:"Health Score"}),(0,a.jsxs)(eU.A,{value:B,onChange:e=>H(e.target.value),label:"Health Score",children:[(0,a.jsx)(g.default,{value:"",children:"All"}),(0,a.jsx)(g.default,{value:"25",children:"\uD83D\uDD34 Critical (<40)"}),(0,a.jsx)(g.default,{value:"50",children:"\uD83D\uDFE1 Attention (40-69)"}),(0,a.jsx)(g.default,{value:"75",children:"\uD83D\uDFE2 Healthy (≥70)"})]})]}),(0,a.jsxs)(eH.A,{fullWidth:!0,size:"small",children:[(0,a.jsx)(eR.default,{children:"Buying Intent"}),(0,a.jsxs)(eU.A,{value:R,onChange:e=>U(e.target.value),label:"Buying Intent",children:[(0,a.jsx)(g.default,{value:"",children:"All"}),(0,a.jsx)(g.default,{value:"9",children:"\uD83D\uDD25 Hot (≥8)"}),(0,a.jsx)(g.default,{value:"6",children:"\uD83D\uDD36 Warm (5-7)"}),(0,a.jsx)(g.default,{value:"3",children:"\uD83E\uDDCA Cold (<5)"})]})]}),(0,a.jsxs)(eH.A,{fullWidth:!0,size:"small",children:[(0,a.jsx)(eR.default,{children:"Follow-up Status"}),(0,a.jsxs)(eU.A,{value:O,onChange:e=>P(e.target.value),label:"Follow-up Status",children:[(0,a.jsx)(g.default,{value:"",children:"All"}),(0,a.jsxs)(g.default,{value:S.eX.OVERDUE,children:["⚠️ ",S.Li[S.eX.OVERDUE]]}),(0,a.jsxs)(g.default,{value:S.eX.TODAY,children:["\uD83D\uDCC5 Due ",S.Li[S.eX.TODAY]]}),(0,a.jsxs)(g.default,{value:S.eX.THIS_WEEK,children:["\uD83D\uDDD3️ ",S.Li[S.eX.THIS_WEEK]]}),(0,a.jsxs)(g.default,{value:S.eX.SCHEDULED,children:["✅ ",S.Li[S.eX.SCHEDULED]]})]})]})]})]})]})}),(0,a.jsxs)(o.A,{sx:{p:2,display:"flex",gap:2,borderTop:"1px solid",borderColor:"divider"},children:[(0,a.jsx)(f.default,{fullWidth:!0,variant:"outlined",color:"inherit",onClick:X,disabled:0===V,children:"Reset"}),(0,a.jsx)(f.default,{fullWidth:!0,variant:"contained",color:"primary",onClick:q,children:"Apply Filters"})]})]})}var eq=t(32104);let eX=(0,n.memo)(function(e){var l,t,n,r;let{params:o,emptyValue:s="—"}=e;if((null==o||null==(l=o.rowNode)?void 0:l.type)==="group")return(0,a.jsx)(i.default,{variant:"subtitle2",sx:{fontWeight:600},children:o.value||s});let d=null==o||null==(t=o.row)?void 0:t.followUpStatus,u=null==o||null==(n=o.row)?void 0:n.overdueDays,c=null==o||null==(r=o.row)?void 0:r.nextFollowUpDate;if(!d||d===S.eX.NONE)return(0,a.jsx)(i.default,{variant:"caption",sx:{color:"text.secondary"},children:s});let x=(0,S.o4)(d,u,c);if("—"===x.label)return(0,a.jsx)(i.default,{variant:"caption",sx:{color:"text.secondary"},children:s});let h={[S.eX.OVERDUE]:{backgroundColor:"#FFE7E7",color:"#FF5630",fontWeight:600},[S.eX.TODAY]:{backgroundColor:"#FFF5E6",color:"#FFA500",fontWeight:600},[S.eX.THIS_WEEK]:{backgroundColor:"#FFF0E6",color:"#FF8C00",fontWeight:600},[S.eX.SCHEDULED]:{backgroundColor:"#E6F4FF",color:"#00B8D9",fontWeight:500}}[d]||{backgroundColor:"#F4F6F8",color:"#637381",fontWeight:500},p=x.label;return d===S.eX.SCHEDULED&&x.date&&(p="✅ ".concat((0,eq.ts)(x.date))),(0,a.jsx)(w.default,{label:p,size:"small",sx:{backgroundColor:h.backgroundColor,color:h.color,fontWeight:h.fontWeight,fontSize:"0.75rem",height:24,"& .MuiChip-label":{px:1}}})});var eY=t(55594),eG=t(90221),eJ=t(80918),e_=t(74234);let eZ=eY.z.object({floor:eY.z.string().optional().nullable(),viewType:eY.z.string().optional().nullable(),direction:eY.z.string().optional().nullable(),bedrooms:eY.z.string().optional().nullable()});function eK(e){let{currentLead:l,setCurrentLead:t,siteId:u}=e,x=(0,n.useMemo)(()=>({floor:null!==l.FloorPreference?String(l.FloorPreference):"",viewType:l.ViewType||"",direction:l.Direction||"",bedrooms:l.Bedrooms||"",locality:l.Locality||"",sizeSqFt:l.SizeSqFt||""}),[l]),h=(0,er.mN)({mode:"all",resolver:(0,eG.u)(eZ),defaultValues:x}),{reset:p,watch:f,setValue:m,handleSubmit:g,formState:{isSubmitting:b}}=h,j=f(),v=function(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"NA";return null!=e?e:l},[y,S]=(0,n.useState)([]),[C,A]=(0,n.useState)(!1),w=(0,n.useMemo)(()=>{let{floor:e,direction:l,viewType:t,bedrooms:a}=j,n=e=>null==e||""===e||"string"==typeof e&&""===e.trim();return n(e)&&n(l)&&n(t)&&n(a)?null:u},[j.floor,j.direction,j.viewType,j.bedrooms,u]),{infraUnitSearchData:k,infraUnitSearchLoading:D,infraUnitSearchError:I,infraUnitSearchEmpty:F,hasValidParams:N,refetchInfraUnit:T}=(0,es.AK)(w,j.floor&&Number(j.floor),j.direction,j.bedrooms,j.viewType);(0,n.useEffect)(()=>{D||S(k.map(e=>{var l,t,a,n,r,i,o;return{id:e.InfraUnitId,floor_number:null!=(l=e.FloorNumber)?l:"-",unit_number:null!=(t=e.UnitNumber)?t:"-",unit_size:null!=(a=e.UnitSize)?a:"-",availability_status:null!=(n=e.AvailabilityStatus)?n:"-",direction:null!=(r=e.Direction)?r:"-",unit_type:null!=(i=e.UnitType)?i:"-",view:null!=(o=e.View)?o:"-"}}))},[k,D]);let M=(0,n.useMemo)(()=>{var e,l,t,a;return[{label:"Floor",name:"floor",options:e_.NS[0].classify||[]},{label:"View",name:"viewType",options:(null==(e=e_.GZ[0])?void 0:e.classify)||[]},{label:"Direction",name:"direction",options:(null==(l=e_.Ac[0])?void 0:l.classify)||[]},{label:"Bedrooms",name:"bedrooms",options:e_.Tm.flatMap(e=>e.classify)||[]},{label:"Locality",name:"locality",options:(null==(t=e_.GZ[0])?void 0:t.classify)||[]},{label:"Size Square Feet",name:"sizeSqFt",options:(null==(a=e_.GZ[0])?void 0:a.classify)||[]}]},[]);(0,n.useEffect)(()=>{p(x)},[x,p]);let E=e=>{t(l=>({...l,SuggestedUnitId:e}))};return(0,a.jsx)(eu.lV,{methods:h,children:(0,a.jsxs)(o.A,{sx:{columnGap:3,rowGap:1,display:"grid",gridTemplateColumns:{xs:"repeat(1,1fr)",md:"repeat(2,1fr)"}},children:[(0,a.jsxs)(r.A,{children:[(0,a.jsxs)(o.A,{sx:{display:"grid",gridTemplateColumns:{xs:"repeat(2,1fr)",md:"repeat(2,1fr)"}},children:[(0,a.jsx)(o.A,{sx:{display:"flex",justifyContent:"flex-start",alignItems:"center"},children:(0,a.jsx)(i.default,{variant:"h6",sx:{pl:2.5,pr:2.5,pt:1,pb:1},children:"Requirement"})}),(0,a.jsx)(o.A,{sx:{display:"flex",justifyContent:"flex-end",alignItems:"center"},children:(0,a.jsx)(s.default,{onClick:()=>{C&&t(e=>({...e,FloorPreference:j.floor&&""!==j.floor?Number(j.floor):null,ViewType:j.viewType||null,Direction:j.direction||null,Locality:j.locality||null,SizeSqFt:j.sizeSqFt||null,Bedrooms:j.bedrooms||null})),A(e=>!e)},loading:b,disabled:b,sx:{mr:1},children:(0,a.jsx)(d.default,{title:C?"Save":"Edit",arrow:!0,children:(0,a.jsx)(c.W,{icon:C?"fa-solid:check":"solar:pen-bold"})})})})]}),(0,a.jsx)(W.default,{}),(0,a.jsx)(o.A,{sx:{pr:3,pl:3,pt:2,pb:2,columnGap:3,rowGap:3,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",md:"repeat(2, 1fr)"}},children:C?(0,a.jsx)(a.Fragment,{children:M.map(e=>{let{label:l,name:t,options:n}=e;return"locality"===t?(0,a.jsx)(eu.D0.Text,{name:"locality",label:"Locality"},t):"sizeSqFt"===t?(0,a.jsx)(eu.D0.Text,{name:"sizeSqFt",label:"Size Square Feet"},t):(0,a.jsx)(ei.default,{options:n,autoHighlight:!0,disabled:D,value:j[t]||"",onChange:(e,l)=>m(t,l||""),renderInput:e=>(0,a.jsx)(eo.default,{...e,label:l})},t)})}):Object.entries(j).map(e=>{let[l,t]=e;return(0,a.jsx)(eJ.A,{children:(0,a.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,a.jsx)(i.default,{variant:"subtitle1",sx:{minWidth:110,fontWeight:500},children:l.replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase())}),(0,a.jsx)(i.default,{children:":"}),(0,a.jsx)(i.default,{variant:"body1",sx:{flex:1},children:v(t)})]})},l)})})]}),(0,a.jsxs)(r.A,{children:[(0,a.jsx)(i.default,{variant:"h6",sx:{pl:2.5,pr:2.5,pt:1,pb:1},children:"Available Unit Options"}),(0,a.jsx)(o.A,{sx:{position:"relative"},children:(0,a.jsx)($.Z,{children:(0,a.jsx)(q.A,{component:X.default,sx:{maxHeight:170},children:(0,a.jsxs)(Y.A,{size:"small",children:[(0,a.jsx)(G.A,{children:(0,a.jsx)(J.default,{children:["Unit No.","Unit Type","Unit Details","Action"].map(e=>(0,a.jsx)(_.default,{style:{whiteSpace:"nowrap"},children:e},e))})}),(0,a.jsx)(Z.A,{children:D?(0,a.jsx)(J.default,{children:(0,a.jsx)(_.default,{colSpan:4,align:"center",children:(0,a.jsx)(z.default,{size:50})})}):I?(0,a.jsx)(J.default,{children:(0,a.jsx)(_.default,{colSpan:4,align:"center",children:I})}):y.length>0?y.map(e=>{let{id:t,floor_number:n,unit_number:r,unit_size:i,availability_status:o,direction:s,unit_type:d,view:u}=e;return(0,a.jsxs)(J.default,{children:[(0,a.jsx)(_.default,{children:n}),(0,a.jsx)(_.default,{children:d}),(0,a.jsxs)(_.default,{children:[s," & ",u]}),(0,a.jsx)(_.default,{onClick:()=>E(t),sx:{cursor:"pointer",color:t===l.SuggestedUnitId?"success.main":"#1976D2","&:hover":{textDecoration:"underline"}},children:t===l.SuggestedUnitId?"Suggested":"Suggest"})]},t)}):(0,a.jsx)(J.default,{children:(0,a.jsx)(_.default,{colSpan:4,align:"center",children:u?"No units match the current requirements":"Please select a site to view suggested units"})})})]})})})})]})]})})}t(92447),t(18088);var eQ=t(95383);let e$=eY.z.object({contactDetails:eu.yf.nullableInput(eY.z.object({id:eY.z.number(),name:eY.z.string(),phoneNumber:eY.z.number()}),{message:"Contact Details is required!"}),brokerDetails:eY.z.object({id:eY.z.number(),name:eY.z.string(),phoneNumber:eY.z.number()}).nullable().optional(),siteDetails:eY.z.object({id:eY.z.number(),name:eY.z.string(),fullAddress:eY.z.string()}).nullable().optional()});function e0(e){let{currentLead:l,setCurrentLead:t,isReset:r,setIsReset:u}=e,x=(0,n.useMemo)(()=>{var e,t,a,n;return{contactDetails:l.ContactId?{id:l.ContactId,name:l.contacts&&"".concat(l.contacts.ContactFName||""," ").concat(l.contacts.ContactLName||"").trim()||"Unknown Contact",phoneNumber:null==(e=l.contacts)?void 0:e.ContactNo}:null,brokerDetails:l.BrokerId?{id:l.BrokerId,name:l.broker&&"".concat(l.broker.ContactFName||""," ").concat(l.broker.ContactLName||"").trim()||"Unknown Broker",phoneNumber:null==(t=l.broker)?void 0:t.ContactNo}:null,siteDetails:l.SiteId?{id:l.SiteId,name:(null==(a=l.site)?void 0:a.SiteName)||"Unknown Site",fullAddress:(null==(n=l.site)?void 0:n.SiteAddress)||"No Address"}:null}},[l]),h=(0,er.mN)({mode:"all",resolver:(0,eG.u)(e$),defaultValues:x}),{reset:p,watch:m,setValue:g,handleSubmit:b,formState:{isSubmitting:j,errors:v}}=h;(0,n.useEffect)(()=>{r&&(p(x),u(!1))},[r,p,x]),(0,n.useEffect)(()=>{p(x)},[x,p]);let S=(0,N.default)(),C=(0,eb.A)(S.breakpoints.up("md")),{contactDetails:A,brokerDetails:w,siteDetails:k}=m(),{contactData:D,contactLoading:I}=(0,eI.ot)(l.ContactId),{contactData:z,contactLoading:T}=(0,eI.ot)(l.BrokerId),[M,E]=(0,n.useState)([]),L=(0,ex.Cg)(),B=(0,ex.Cg)(),H=(0,ex.Cg)(),R=(0,ex.Cg)(),U=(0,ex.Cg)();(0,n.useEffect)(()=>{(async()=>{try{let e=await (0,e_.ZA)();e&&E(e.map(e=>({id:e.SiteId,name:e.SiteName||"NA",fullAddress:e.SiteAddress||"NA"})))}catch(e){F.oR.error("Something Went Wrong!",{containerId:"error"})}})()},[]);let O=(e,l)=>{g(e,l),"contactDetails"===e&&t(e=>{var t,a;return{...e,ContactId:l.id,contacts:l.id?{ContactId:l.id,ContactFName:(null==(t=l.name)?void 0:t.split(" ")[0])||"",ContactLName:(null==(a=l.name)?void 0:a.split(" ").slice(1).join(" "))||"",ContactNo:l.phoneNumber}:null}}),"brokerDetails"===e&&t(e=>{var t,a;return{...e,BrokerId:(null==l?void 0:l.id)||null,broker:(null==l?void 0:l.id)?{ContactId:l.id,ContactFName:(null==(t=l.name)?void 0:t.split(" ")[0])||"",ContactLName:(null==(a=l.name)?void 0:a.split(" ").slice(1).join(" "))||"",ContactNo:l.phoneNumber}:null}}),"siteDetails"===e&&t(e=>({...e,SiteId:(null==l?void 0:l.id)||null,site:(null==l?void 0:l.id)?{SiteId:l.id,SiteName:l.name,SiteAddress:l.fullAddress}:null}))};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(eu.lV,{methods:h,children:[(0,a.jsxs)(y.A,{divider:(0,a.jsx)(W.default,{flexItem:!0,orientation:C?"vertical":"horizontal",sx:{borderStyle:"dashed",borderWidth:"2px"}}),sx:{pr:3,pl:3,pt:2,pb:2,gap:{xs:3,md:5},flexDirection:{xs:"column",md:"row"}},children:[(0,a.jsxs)(y.A,{sx:{width:1},children:[(0,a.jsxs)(o.A,{sx:{mb:1,display:"flex",alignItems:"center"},children:[(0,a.jsx)(i.default,{variant:"h6",sx:{color:"text.disabled",flexGrow:1},children:"Lead Contact Details:"}),(0,a.jsx)(d.default,{title:"Change Contact",arrow:!0,children:(0,a.jsx)(s.default,{onClick:L.onTrue,children:(0,a.jsx)(c.W,{icon:"mingcute:add-line"})})}),(null==A?void 0:A.id)&&(0,a.jsx)(d.default,{title:"Edit Contact",arrow:!0,children:(0,a.jsx)(s.default,{onClick:R.onTrue,children:(0,a.jsx)(c.W,{icon:"solar:pen-bold"})})})]}),(null==A?void 0:A.id)?(0,a.jsxs)(y.A,{spacing:1,children:[(0,a.jsxs)(i.default,{variant:"subtitle2",children:["Name : ",A.name]}),(0,a.jsxs)(i.default,{variant:"body2",children:["Phone No. : ",A.phoneNumber||"NA"]})]}):(0,a.jsx)(i.default,{variant:"body2",sx:{color:"text.secondary",fontStyle:"italic"},children:"No contact assigned. Click + to add a contact."})]}),(0,a.jsxs)(y.A,{sx:{width:1},children:[(0,a.jsxs)(o.A,{sx:{mb:1,display:"flex",alignItems:"center"},children:[(0,a.jsx)(i.default,{variant:"h6",sx:{color:"text.disabled",flexGrow:1},children:"Associated Broker Details:"}),(0,a.jsx)(d.default,{title:"Change Broker",arrow:!0,children:(0,a.jsx)(s.default,{onClick:B.onTrue,children:(0,a.jsx)(c.W,{icon:"mingcute:add-line"})})}),(null==w?void 0:w.id)&&(0,a.jsx)(d.default,{title:"Edit Broker",arrow:!0,children:(0,a.jsx)(s.default,{onClick:U.onTrue,children:(0,a.jsx)(c.W,{icon:"solar:pen-bold"})})})]}),(null==w?void 0:w.id)?(0,a.jsxs)(y.A,{spacing:1,children:[(0,a.jsxs)(i.default,{variant:"subtitle2",children:["Name : ",w.name]}),(0,a.jsxs)(i.default,{variant:"body2",children:["Phone No. : ",w.phoneNumber]})]}):(0,a.jsx)(i.default,{variant:"subtitle1",children:"No Broker Assigned"})]}),(0,a.jsxs)(y.A,{sx:{width:1},children:[(0,a.jsxs)(o.A,{sx:{mb:1,display:"flex",alignItems:"center"},children:[(0,a.jsx)(i.default,{variant:"h6",sx:{color:"text.disabled",flexGrow:1},children:"Interested Site Details:"}),(0,a.jsx)(d.default,{title:"Change Site",arrow:!0,children:(0,a.jsx)(s.default,{onClick:H.onTrue,children:(0,a.jsx)(c.W,{icon:"mingcute:add-line"})})})]}),(null==k?void 0:k.id)?(0,a.jsxs)(y.A,{spacing:1,children:[(0,a.jsxs)(i.default,{variant:"subtitle2",children:["Name : ",k.name]}),(0,a.jsxs)(i.default,{variant:"body2",children:["Address : ",k.fullAddress]})]}):(0,a.jsx)(i.default,{variant:"body2",sx:{color:"text.secondary",fontStyle:"italic"},children:"No site selected. Click + to select a site."})]})]}),(0,a.jsx)(ep.Tt,{title:"Contacts List",type:"Customer",open:L.value,onClose:L.onFalse,selected:e=>(null==A?void 0:A.id)===e,onSelect:e=>O("contactDetails",e),action:(0,a.jsx)(f.default,{size:"small",startIcon:(0,a.jsx)(c.W,{icon:"mingcute:add-line"}),sx:{alignSelf:"flex-end"},children:"New"})}),(0,a.jsx)(ep.Tt,{title:"Brokers List",type:"Broker",open:B.value,onClose:B.onFalse,selected:e=>(null==w?void 0:w.id)===e,onSelect:e=>O("brokerDetails",e),action:(0,a.jsx)(f.default,{size:"small",startIcon:(0,a.jsx)(c.W,{icon:"mingcute:add-line"}),sx:{alignSelf:"flex-end"},children:"New"})}),(0,a.jsx)(eQ.ND,{title:"Sites List",open:H.value,onClose:H.onFalse,selected:e=>(null==k?void 0:k.id)===e,onSelect:e=>O("siteDetails",e),list:M})]}),D.ContactId&&(0,a.jsx)(ep.Rz,{title:"Edit Contact",type:"Customer",open:R.value,onClose:R.onFalse,currentContact:D,onCreate:()=>{}}),z.ContactId&&(0,a.jsx)(ep.Rz,{title:"Edit Broker",type:"Broker",open:U.value,onClose:U.onFalse,currentContact:z,onCreate:()=>{}})]})}},50827:(e,l,t)=>{t.d(l,{x:()=>k});var a=t(95155),n=t(82940),r=t.n(n),i=t(55594),o=t(62177),s=t(90221),d=t(12115),u=t(26403),c=t(2360),x=t(92634),h=t(95946),p=t(84256),f=t(80918),m=t(96801),g=t(9670),b=t(53494),j=t(78822),v=t(97439),y=t(31847),S=t(38867),C=t(54961);let A=e=>e?r()(e).format("DD MMM YYYY"):"-",w=i.z.object({leadName:i.z.string().min(1,{message:"Lead name is required!"}),leadStatus:i.z.string().min(1,{message:"Lead status is required!"}),leadSource:i.z.string().optional().nullable(),buyingIntent:i.z.number().optional().nullable(),prospectType:i.z.number().optional().nullable(),lostReasons:i.z.string().optional().nullable()});function k(e){let{currentLead:l,setCurrentLead:t}=e,n=(0,d.useMemo)(()=>{var e,t,a,n,r,i,o,s,d;return{leadName:null!=(e=l.LeadName)?e:"",prospectType:null!=(t=l.ProspectTypeId)?t:0,createdDate:null!=(a=A(null==l?void 0:l.CreatedDate))?a:"",leadStatus:null!=(n=l.LeadStatus)?n:"",buyingIntent:null!=(r=l.BuyingIntent)?r:"",updatedDate:null!=(i=A(null==l?void 0:l.UpdatedDate))?i:"",leadSource:null!=(o=l.LeadSource)?o:"",createdBy:l.CreatedById?"".concat(l.created_by.FirstName," ").concat(l.created_by.LastName):"",closedDate:null!=(s=A(null==l?void 0:l.LeadClosedDate))?s:"",lostReasons:null!=(d=l.LostReasons)?d:""}},[l]),r=(0,o.mN)({mode:"all",resolver:(0,s.u)(w),defaultValues:n}),{reset:i,watch:k,setValue:D,handleSubmit:I,formState:{isSubmitting:F,error:N}}=r,z=k(),T=function(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-";return null!=e?e:l};(0,d.useEffect)(()=>{i(n)},[n,i]);let{prospectData:M,prospectLoading:W}=(0,v.n)(),[E,L]=(0,d.useState)([]);(0,d.useEffect)(()=>{!W&&M&&Array.isArray(M)&&L(M.map(e=>({label:e.ProspectTypeName||"",value:e.ProspectTypeId||0})))},[M,W]);let[B,H]=(0,d.useState)(!1),R=e=>{let l=E.find(l=>l.value===e);return l?l.label:""},U=(0,d.useCallback)((e,l)=>{if("leadStatus"===e)return(0,a.jsx)(u.A,{value:l,onChange:l=>D(e,l.target.value),size:"small",sx:{flex:1,minWidth:150},children:y.eD.map(e=>(0,a.jsx)(c.default,{value:e.value,children:e.label},e.value))});if("prospectType"===e)return(0,a.jsx)(x.default,{options:E,value:E.find(e=>e.value===l)||null,onChange:(l,t)=>D(e,(null==t?void 0:t.value)||null),getOptionLabel:e=>(null==e?void 0:e.label)||"",isOptionEqualToValue:(e,l)=>e.value===(null==l?void 0:l.value),renderInput:e=>(0,a.jsx)(h.default,{...e,sx:{"& .MuiInputBase-root":{height:40},"& .MuiOutlinedInput-input":{padding:"8px 14px"}}}),sx:{flex:1,maxWidth:200},autoHighlight:!0});if("leadSource"===e){let e=y.Oe.flatMap(e=>e.classify.map(l=>({label:l,value:l,group:e.group})));return(0,a.jsx)(x.default,{options:e,groupBy:e=>e.group,value:e.find(e=>e.value===l)||null,onChange:(e,l)=>D("leadSource",(null==l?void 0:l.value)||null),getOptionLabel:e=>(null==e?void 0:e.label)||"",isOptionEqualToValue:(e,l)=>e.value===(null==l?void 0:l.value),renderInput:e=>(0,a.jsx)(h.default,{...e,sx:{"& .MuiInputBase-root":{height:40},"& .MuiOutlinedInput-input":{padding:"8px 14px"}}}),sx:{flex:1,maxWidth:200},autoHighlight:!0})}return"buyingIntent"===e?(0,a.jsx)(C.D0.Text,{sx:{"& .MuiInputBase-root":{height:40},"& .MuiOutlinedInput-input":{padding:"8px 14px"}},name:e,type:"number",inputProps:{min:0,max:100},height:40}):["createdBy"].includes(e)?(0,a.jsx)(h.default,{value:l,size:"small",disabled:!0,sx:{flex:1,maxWidth:160}}):["createdDate","updatedDate","closedDate"].includes(e)?(0,a.jsx)(h.default,{value:l,size:"small",disabled:!0,sx:{flex:1,maxWidth:150}}):"lostReasons"===e?(0,a.jsx)(h.default,{value:l||"",onChange:l=>D(e,l.target.value),onBlur:l=>D(e,l.target.value.replace(/\s+/g," ").trim()),size:"small",sx:{flex:1,minWidth:160},placeholder:"Enter reason for lost lead",disabled:"Lost"!==z.leadStatus}):(0,a.jsx)(h.default,{value:l,onChange:l=>D(e,l.target.value),onBlur:l=>D(e,l.target.value.replace(/\s+/g," ").trim()),onKeyDown:t=>{"Enter"===t.key&&D(e,l.replace(/\s+/g," ").trim())},size:"small",sx:{flex:1,minWidth:160},error:!!N,helperText:null==N?void 0:N.message})},[D,E,z.leadStatus]);return(0,a.jsx)(p.A,{sx:{p:3,position:"relative"},children:(0,a.jsxs)(C.lV,{methods:r,children:[(0,a.jsx)(f.A,{container:!0,spacing:1.5,sx:{display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",md:"repeat(3, 1fr)"},rowGap:1.5,mr:5},children:Object.entries(z).map(e=>{let[l,t]=e;return(0,a.jsx)(f.A,{children:(0,a.jsxs)(m.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,a.jsx)(g.default,{variant:"subtitle1",sx:{minWidth:110,fontWeight:500},children:l.replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase())}),(0,a.jsx)(g.default,{children:":"}),B?U(l,t):(0,a.jsx)(g.default,{variant:"body1",sx:{flex:1},children:"prospectType"===l?R(t):T(t)})]})},l)})}),(0,a.jsx)(b.default,{onClick:()=>{B&&t(e=>({...e,LeadName:z.leadName||null,LeadStatus:z.leadStatus||null,LeadSource:z.leadSource||null,BuyingIntent:z.buyingIntent||null,ProspectTypeId:z.prospectType||null,LostReasons:z.lostReasons||null})),H(e=>!e)},loading:F,disabled:F,sx:{position:"absolute",top:22,right:16},children:(0,a.jsx)(j.default,{title:B?"Save":"Edit",arrow:!0,children:(0,a.jsx)(S.W,{icon:B?"fa-solid:check":"solar:pen-bold"})})})]})})}},92447:(e,l,t)=>{t.d(l,{z:()=>u});var a=t(95155),n=t(12115),r=t(96801),i=t(40001),o=t(4007),s=t(66292),d=t(38867);class u extends n.Component{static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,l){this.setState({error:e,errorInfo:l})}render(){return this.state.hasError?(0,a.jsxs)(r.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"400px",p:3},children:[(0,a.jsxs)(i.default,{severity:"error",sx:{width:"100%",maxWidth:600,mb:3},children:[(0,a.jsx)(o.A,{children:"Something went wrong"}),"An error occurred while loading the lead list. Please try refreshing the page or contact support if the problem persists."]}),(0,a.jsxs)(r.A,{sx:{display:"flex",gap:2},children:[(0,a.jsx)(s.default,{variant:"contained",color:"primary",startIcon:(0,a.jsx)(d.W,{icon:"eva:refresh-fill"}),onClick:this.handleReset,children:"Refresh Page"}),(0,a.jsx)(s.default,{variant:"outlined",color:"inherit",onClick:()=>window.history.back(),children:"Go Back"})]}),!1]}):this.props.children}constructor(e){super(e),this.handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null}),window.location.reload()},this.state={hasError:!1,error:null,errorInfo:null}}}},97439:(e,l,t)=>{t.d(l,{n:()=>o});var a=t(19169),n=t(12115),r=t(18835);let i={revalidateIfStale:!1,revalidateOnFocus:!1,revalidateOnReconnect:!1};function o(){let e=r.vZ.prospect.readAll,{data:l,isLoading:t,error:o,isValidating:s}=(0,a.Ay)(e,r.GO,i);return(0,n.useMemo)(()=>({prospectData:null!=l?l:[],prospectLoading:t,prospectError:o?(null==o?void 0:o.message)||"Error fetching data":null,prospectValidating:s,prospectEmpty:!t&&!s&&(!Array.isArray(l)||0===l.length)}),[l,o,t,s])}}}]);